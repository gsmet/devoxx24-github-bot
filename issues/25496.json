{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/25496",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/25496/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/25496/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/25496/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/25496",
  "id": 1232347545,
  "node_id": "I_kwDOCFbutM5JdCGZ",
  "number": 25496,
  "title": "When using reactive restclient in 2.8.2.Final with Response, getEntity() returns null even if there is a body in Response",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1326067509,
      "node_id": "MDU6TGFiZWwxMzI2MDY3NTA5",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/rest-client",
      "name": "area/rest-client",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/345",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/345",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/345/labels",
    "id": 11440331,
    "node_id": "MI_kwDOCFbutM4ArpDL",
    "number": 345,
    "title": "3.16 - main",
    "description": "",
    "creator": {
      "login": "quarkusbot",
      "id": 61254497,
      "node_id": "MDQ6VXNlcjYxMjU0NDk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/61254497?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/quarkusbot",
      "html_url": "https://github.com/quarkusbot",
      "followers_url": "https://api.github.com/users/quarkusbot/followers",
      "following_url": "https://api.github.com/users/quarkusbot/following{/other_user}",
      "gists_url": "https://api.github.com/users/quarkusbot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/quarkusbot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/quarkusbot/subscriptions",
      "organizations_url": "https://api.github.com/users/quarkusbot/orgs",
      "repos_url": "https://api.github.com/users/quarkusbot/repos",
      "events_url": "https://api.github.com/users/quarkusbot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/quarkusbot/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 110,
    "state": "open",
    "created_at": "2024-08-14T07:55:40Z",
    "updated_at": "2024-09-02T12:40:31Z",
    "due_on": null,
    "closed_at": null
  },
  "comments": 7,
  "created_at": "2022-05-11T09:52:12Z",
  "updated_at": "2024-08-27T14:18:21Z",
  "closed_at": "2024-08-27T14:18:16Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nIn 2.7.2 using the old restclient and a call with signature\r\n\r\n```\r\n@Path(\"/response\")\r\n@GET\r\nUni<Response> getResponse();\r\n```\r\nso I could do some work with headers before touching the entity data.\r\nOld code then would ask for an InputStream using response.getEntity() which worked fine.\r\n\r\nReactive restclient will return null in the same situation. I can get the body by doing String data=response.readEntity(String.class) however so there is an entity.\r\n\n\n### Expected behavior\n\nWhen restclient returns Uni<Response> and there is proper data in the Response, response.getEntity() should return an InputStream.\n\n### Actual behavior\n\nIn Quarkus 2.8.2, when calling response.getEntity(), null is returned, indicating that the response does not have an entity.\n\n### How to Reproduce?\n\n\r\nSteps:\r\n1: Compile and start backing web service \"restservice\", runs on localhost port 8080\r\n2: Compile and start service that uses 2.8.2.Final reactive restclient \"restclient\", runs on localhost port 8088\r\n3: Compile and run service that uses 2.7.2.Final nonreactive restclient, runs on localhost port 8098\r\n4: Trigger either rest client by using \r\n`curl http://localhost:8088/hello/response` or `curl http://localhost:8098/hello/response`\r\n\r\nYou'll get a canned response from the call, but in the restclient service logs you'll see the differing behaviour of getEntity()\r\n[restclient_response_reproduced.zip](https://github.com/quarkusio/quarkus/files/8668740/restclient_response_reproduced.zip)\r\n.\n\n### Output of `uname -a` or `ver`\n\nLinux deadpool 5.13.0-40-generic #45~20.04.1-Ubuntu SMP Mon Apr 4 09:38:31 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux\n\n### Output of `java -version`\n\nopenjdk version \"18.0.1\" 2022-04-19 OpenJDK Runtime Environment Zulu18.30+11-CA (build 18.0.1+10) OpenJDK 64-Bit Server VM Zulu18.30+11-CA (build 18.0.1+10, mixed mode, sharing)\n\n### GraalVM version (if different from Java)\n\nN/A\n\n### Quarkus version or git rev\n\n2.8.2\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\nApache Maven 3.8.4 (9b656c72d54e5bacbed989b64718c159fe39b537)\n\n### Additional information\n\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/25496/reactions",
    "total_count": 4,
    "+1": 4,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/25496/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
