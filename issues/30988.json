{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/30988",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/30988/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/30988/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/30988/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/30988",
  "id": 1575760152,
  "node_id": "I_kwDOCFbutM5d7DEY",
  "number": 30988,
  "title": "Race condition in SmallRye Config property expansion for @RolesAllowed value?",
  "labels": [
    {
      "id": 1282139374,
      "node_id": "MDU6TGFiZWwxMjgyMTM5Mzc0",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/security",
      "name": "area/security",
      "color": "0366d6",
      "default": false,
      "description": ""
    },
    {
      "id": 1676631606,
      "node_id": "MDU6TGFiZWwxNjc2NjMxNjA2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/env/windows",
      "name": "env/windows",
      "color": "edea47",
      "default": false,
      "description": "Impacts Windows machines"
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/236",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/236",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/236/labels",
    "id": 9049338,
    "node_id": "MI_kwDOCFbutM4AihT6",
    "number": 236,
    "title": "2.16.3.Final",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 28,
    "state": "closed",
    "created_at": "2023-02-15T16:04:20Z",
    "updated_at": "2023-05-09T09:29:46Z",
    "due_on": null,
    "closed_at": "2023-02-16T13:35:52Z"
  },
  "comments": 7,
  "created_at": "2023-02-08T09:16:56Z",
  "updated_at": "2023-02-15T16:09:50Z",
  "closed_at": "2023-02-14T11:25:05Z",
  "active_lock_reason": null,
  "body": "We sometimes have `LazyAuthRolesAllowedConfigExpTestCase` failing on CI with the error above.\r\nI saw it on Windows which is usually a bit slower than the Linux hosts so it could be a race condition somewhere.\r\n\r\n```\r\n2023-02-07T16:47:39.2239103Z [ERROR] io.quarkus.resteasy.reactive.server.test.security.LazyAuthRolesAllowedConfigExpTestCase  Time elapsed: 1.229 s  <<< ERROR!\r\n2023-02-07T16:47:39.2240204Z java.lang.RuntimeException: java.lang.RuntimeException: Failed to start quarkus\r\n2023-02-07T16:47:39.2241332Z \tat io.quarkus.test.QuarkusUnitTest.beforeAll(QuarkusUnitTest.java:689)\r\n2023-02-07T16:47:39.2242144Z \tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeBeforeAllCallbacks$12(ClassBasedTestDescriptor.java:395)\r\n2023-02-07T16:47:39.2243041Z \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n2023-02-07T16:47:39.2243964Z \tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeBeforeAllCallbacks(ClassBasedTestDescriptor.java:395)\r\n2023-02-07T16:47:39.2244876Z \tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.before(ClassBasedTestDescriptor.java:211)\r\n2023-02-07T16:47:39.2245670Z \tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.before(ClassBasedTestDescriptor.java:84)\r\n2023-02-07T16:47:39.2246476Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:148)\r\n2023-02-07T16:47:39.2247297Z \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n2023-02-07T16:47:39.2248130Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)\r\n2023-02-07T16:47:39.2248832Z \tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\r\n2023-02-07T16:47:39.2249559Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)\r\n2023-02-07T16:47:39.2250371Z \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n2023-02-07T16:47:39.2251227Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)\r\n2023-02-07T16:47:39.2252249Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)\r\n2023-02-07T16:47:39.2252872Z \tat java.base/java.util.ArrayList.forEach(ArrayList.java:1541)\r\n2023-02-07T16:47:39.2253772Z \tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)\r\n2023-02-07T16:47:39.2255230Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)\r\n2023-02-07T16:47:39.2256141Z \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n2023-02-07T16:47:39.2256993Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)\r\n2023-02-07T16:47:39.2257724Z \tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\r\n2023-02-07T16:47:39.2258448Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)\r\n2023-02-07T16:47:39.2259250Z \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n2023-02-07T16:47:39.2260108Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)\r\n2023-02-07T16:47:39.2260920Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)\r\n2023-02-07T16:47:39.2262051Z \tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)\r\n2023-02-07T16:47:39.2263172Z \tat org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)\r\n2023-02-07T16:47:39.2264096Z \tat org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)\r\n2023-02-07T16:47:39.2264979Z \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:147)\r\n2023-02-07T16:47:39.2265807Z \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:127)\r\n2023-02-07T16:47:39.2266657Z \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:90)\r\n2023-02-07T16:47:39.2267520Z \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:55)\r\n2023-02-07T16:47:39.2268531Z \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:102)\r\n2023-02-07T16:47:39.2269456Z \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:54)\r\n2023-02-07T16:47:39.2270180Z \tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)\r\n2023-02-07T16:47:39.2270826Z \tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)\r\n2023-02-07T16:47:39.2271554Z \tat org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)\r\n2023-02-07T16:47:39.2272297Z \tat org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:55)\r\n2023-02-07T16:47:39.2273054Z \tat org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:223)\r\n2023-02-07T16:47:39.2273930Z \tat org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:175)\r\n2023-02-07T16:47:39.2274788Z \tat org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:139)\r\n2023-02-07T16:47:39.2275526Z \tat org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:456)\r\n2023-02-07T16:47:39.2276189Z \tat org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:169)\r\n2023-02-07T16:47:39.2276776Z \tat org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:595)\r\n2023-02-07T16:47:39.2277356Z \tat org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:581)\r\n2023-02-07T16:47:39.2277842Z Caused by: java.lang.RuntimeException: Failed to start quarkus\r\n2023-02-07T16:47:39.2278296Z \tat io.quarkus.runner.ApplicationImpl.doStart(Unknown Source)\r\n2023-02-07T16:47:39.2278774Z \tat io.quarkus.runtime.Application.start(Application.java:101)\r\n2023-02-07T16:47:39.2279307Z \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n2023-02-07T16:47:39.2280073Z \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n2023-02-07T16:47:39.2280831Z \tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n2023-02-07T16:47:39.2281453Z \tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n2023-02-07T16:47:39.2281962Z \tat io.quarkus.runner.bootstrap.StartupActionImpl.run(StartupActionImpl.java:253)\r\n2023-02-07T16:47:39.2282529Z \tat io.quarkus.test.QuarkusUnitTest.beforeAll(QuarkusUnitTest.java:642)\r\n2023-02-07T16:47:39.2282905Z \t... 43 more\r\n2023-02-07T16:47:39.2283938Z Caused by: java.util.NoSuchElementException: SRCFG00014: The config property QuarkusSecurityRolesAllowedConfigSource.property-0 is required but it could not be found in any config source\r\n2023-02-07T16:47:39.2284684Z \tat io.smallrye.config.SmallRyeConfig.convertValue(SmallRyeConfig.java:298)\r\n2023-02-07T16:47:39.2285230Z \tat io.smallrye.config.SmallRyeConfig.getValue(SmallRyeConfig.java:242)\r\n2023-02-07T16:47:39.2285849Z \tat io.smallrye.config.SmallRyeConfig.getValue(SmallRyeConfig.java:168)\r\n2023-02-07T16:47:39.2286414Z \tat io.quarkus.security.runtime.SecurityCheckRecorder$1.get(SecurityCheckRecorder.java:75)\r\n2023-02-07T16:47:39.2287047Z \tat io.quarkus.security.runtime.SecurityCheckRecorder$1.get(SecurityCheckRecorder.java:66)\r\n2023-02-07T16:47:39.2287907Z \tat io.quarkus.security.runtime.interceptor.check.SupplierRolesAllowedCheck.resolveAllowedRoles(SupplierRolesAllowedCheck.java:43)\r\n2023-02-07T16:47:39.2288933Z \tat io.quarkus.security.runtime.SecurityCheckRecorder.resolveRolesAllowedConfigExpRoles(SecurityCheckRecorder.java:105)\r\n2023-02-07T16:47:39.2289775Z \tat io.quarkus.deployment.steps.SecurityProcessor$resolveConfigExpressionRoles1389290116.deploy_0(Unknown Source)\r\n2023-02-07T16:47:39.2290511Z \tat io.quarkus.deployment.steps.SecurityProcessor$resolveConfigExpressionRoles1389290116.deploy(Unknown Source)\r\n2023-02-07T16:47:39.2290982Z \t... 51 more\r\n```",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/30988/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/30988/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
