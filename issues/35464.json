{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/35464",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35464/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35464/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35464/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/35464",
  "id": 1861091170,
  "node_id": "I_kwDOCFbutM5u7f9i",
  "number": 35464,
  "title": "Dev Service Containers are not stopped between test classes",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1676631606,
      "node_id": "MDU6TGFiZWwxNjc2NjMxNjA2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/env/windows",
      "name": "env/windows",
      "color": "edea47",
      "default": false,
      "description": "Impacts Windows machines"
    },
    {
      "id": 2955097667,
      "node_id": "MDU6TGFiZWwyOTU1MDk3NjY3",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/devservices",
      "name": "area/devservices",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/265",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/265",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/265/labels",
    "id": 9762660,
    "node_id": "MI_kwDOCFbutM4AlPdk",
    "number": 265,
    "title": "3.4.0.CR1",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 152,
    "state": "closed",
    "created_at": "2023-08-09T06:34:41Z",
    "updated_at": "2023-10-31T11:58:00Z",
    "due_on": null,
    "closed_at": "2023-09-06T13:01:00Z"
  },
  "comments": 4,
  "created_at": "2023-08-22T09:54:06Z",
  "updated_at": "2023-08-24T10:32:14Z",
  "closed_at": "2023-08-24T10:32:09Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nWhen using `@QuarkusTestResource`s that are restricted to the annotated test class dev services are started for each such class. That is not an issue on its own and is probably desired behaviour. \r\nHowever, even if the test class is finished, containers are not stopped until the `maven-failsafe-plugin` execution finishes. \r\n\r\nIn a project like ours where we have potentially dozens of such test classes this quickly leads to memory issues as the containers can easily take up up to 1GB of memory. \r\n\r\nSince this container duplication also happens with test classes that have the exact same annotations, I file this as a bug, as I cannot see how any of these dev services could be reused by another test class. \r\n\r\nBarring a fix, any advice on how to work around this issue is also greatly appreciated.\r\n\n\n### Expected behavior\n\nWhen a test class finishes, all of the dev services that are only needed for this class are instructed to stop before execution of the next test begins\n\n### Actual behavior\n\nDev services that are only needed for one class persist until execution of all test classes has finished\n\n### How to Reproduce?\n\nReproducer: [reproducer.zip](https://github.com/quarkusio/quarkus/files/12407447/reproducer.zip)\r\n\r\nSteps to reproduce:\r\n1. Run `mvn clean install`\r\n2. Observe when containers are created and stopped during the verify step\r\n\r\n\n\n### Output of `uname -a` or `ver`\n\nMicrosoft Windows [Version 10.0.19045.3324]\n\n### Output of `java -version`\n\nopenjdk 17.0.2 2022-01-18 OpenJDK Runtime Environment Temurin-17.0.2+8 (build 17.0.2+8) OpenJDK 64-Bit Server VM Temurin-17.0.2+8 (build 17.0.2+8, mixed mode, sharing)\n\n### GraalVM version (if different from Java)\n\n_No response_\n\n### Quarkus version or git rev\n\n2.15.1.Final, 3.2.4.Final\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\nMaven home: C:\\Users\\USER\\.m2\\wrapper\\dists\\apache-maven-3.8.5-bin\\5i5jha092a3i37g0paqnfr15e0\\apache-maven-3.8.5 Java version: 11.0.2, vendor: Oracle Corporation, runtime: D:\\Build\\Java\\jdk-11.0.2 Default locale: de_DE, platform encoding: Cp1252 OS name: \"windows 10\", version: \"10.0\", arch: \"amd64\", family: \"windows\"\n\n### Additional information\n\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/35464/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35464/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
