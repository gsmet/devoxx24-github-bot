{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/42040",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/42040/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/42040/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/42040/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/42040",
  "id": 2423004067,
  "node_id": "I_kwDOCFbutM6QbBuj",
  "number": 42040,
  "title": "Quarkus Mutli module project Jacoco.xml only has the latest module results",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1375177076,
      "node_id": "MDU6TGFiZWwxMzc1MTc3MDc2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/testing",
      "name": "area/testing",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "milestone": null,
  "comments": 0,
  "created_at": "2024-07-22T14:19:52Z",
  "updated_at": "2024-07-23T06:00:54Z",
  "closed_at": null,
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nI have a multi module project where I use Quarkus. In all the modules, I have written tests that all are succeeding. I want to see my code coverage in a self-hosted SonarQube instance. When I run `./mvnw verify`, the target folder is being generated and is filled with the code coverage, all in different folders.\r\n\r\n![image](https://github.com/user-attachments/assets/310fe5b6-73a2-4c66-82a7-8a0b2197d691)\r\n\r\nWhen using the jacoco.exec file in IntelliJ, I can see the fact that the code coverage does seem to work. But, since SonarQube doesn't support the binary format of Jacoco anymore, it needs to have the XML format.\r\n![Example of jacoco.exec in IntelliJ](https://github.com/user-attachments/assets/9a7c2db5-9241-45eb-83c8-eeb24366ecce)\r\n\r\nThe XML format of Jacoco seems like it only has the last module in the generated list. This is shown in the CSV file that is generated with Jacoco. During the verify command, the CSV file changes the content to the module it is currently working on and overwrite the old ones. The content of the CSV file and the XML file do match.\r\n\r\n![CSV file generated by Jacoco](https://github.com/user-attachments/assets/0ab966b6-ecd6-4460-b047-79f1315ee5d3)\r\n\r\n\n\n### Expected behavior\n\nWithin in multi-module project, the XML file is overwritten with the module that it is building on that moment. Which means, at the end of the build, the XML file only holds code coverage information about the last in the build line.\n\n### Actual behavior\n\nAn XML file that is filled with all the modules code coverage in one file. This needs to be in one file because SonarQube only accepts one XML file as its code coverage source.\n\n### How to Reproduce?\n\n1. Have a multi module project with tests\r\n2. Use the guide for multi module projects: https://quarkus.io/guides/tests-with-coverage#working-with-multi-module-projects \r\n3. Check the CSV/XML file and there should only be one module result.\n\n### Output of `uname -a` or `ver`\n\n_No response_\n\n### Output of `java -version`\n\nOpenJDK Runtime Environment Temurin-21.0.3+9 (build 21.0.3+9-LTS)\n\n### Quarkus version or git rev\n\n3.12.2\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\nMaven home: /Users/rickverkuijlen/.m2/wrapper/dists/apache-maven-3.9.6-bin/3311e1d4/apache-maven-3.9.6 Java version: 21.0.3, vendor: Eclipse Adoptium, runtime: /Users/rickverkuijlen/.sdkman/candidates/java/21.0.3-tem Default locale: en_NL, platform encoding: UTF-8 OS name: \"mac os x\", version: \"14.5\", arch: \"aarch64\", family: \"mac\"\n\n### Additional information\n\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/42040/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/42040/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
