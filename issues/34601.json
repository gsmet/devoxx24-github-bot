{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/34601",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/34601/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/34601/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/34601/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/34601",
  "id": 1793292583,
  "node_id": "I_kwDOCFbutM5q43kn",
  "number": 34601,
  "title": "zip file closed errors ",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1273027849,
      "node_id": "MDU6TGFiZWwxMjczMDI3ODQ5",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/core",
      "name": "area/core",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/261",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/261",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/261/labels",
    "id": 9620417,
    "node_id": "MI_kwDOCFbutM4AksvB",
    "number": 261,
    "title": "3.2.1.Final",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 137,
    "state": "closed",
    "created_at": "2023-07-05T15:27:44Z",
    "updated_at": "2023-08-07T13:21:27Z",
    "due_on": null,
    "closed_at": "2023-07-19T13:26:50Z"
  },
  "comments": 27,
  "created_at": "2023-07-07T10:42:09Z",
  "updated_at": "2023-07-18T16:23:22Z",
  "closed_at": "2023-07-18T00:27:17Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nHello,\r\nfor a little while now our quarkus apps have been getting frequent zip file closed errors like this one. This happens randomly.\r\n\r\n```\r\n\r\nERROR [com.xxxx.ThrowableMapper] (vert.x-eventloop-thread-17) POST http://xxx failed: zip file closed: java.lang.IllegalStateException: zip file closed\r\nat java.base/java.util.zip.ZipFile.ensureOpen(ZipFile.java:831)\r\nat java.base/java.util.zip.ZipFile.getEntry(ZipFile.java:330)\r\nat java.base/java.util.jar.JarFile.getEntry(JarFile.java:518)\r\nat io.quarkus.bootstrap.runner.JarResource.getResourceData(JarResource.java:74)\r\nat io.quarkus.bootstrap.runner.RunnerClassLoader.loadClass(RunnerClassLoader.java:99)\r\nat io.quarkus.bootstrap.runner.RunnerClassLoader.loadClass(RunnerClassLoader.java:65)\r\nat com.xxx.XXXResource_Bean.proxy(Unknown Source)\r\nat com.xxx.XXXtResource_Bean.get(Unknown Source)\r\nxxxx\r\nat io.quarkus.arc.impl.ArcContainerImpl.beanInstanceHandle(ArcContainerImpl.java:471)\r\nat io.quarkus.arc.impl.ArcContainerImpl.beanInstanceHandle(ArcContainerImpl.java:484)\r\nat io.quarkus.arc.impl.ArcContainerImpl$1.get(ArcContainerImpl.java:288)\r\nat io.quarkus.arc.impl.ArcContainerImpl$1.get(ArcContainerImpl.java:285)\r\nat io.quarkus.arc.runtime.BeanContainerImpl$1.create(BeanContainerImpl.java:36)\r\nat io.quarkus.resteasy.reactive.common.runtime.ArcBeanFactory.createInstance(ArcBeanFactory.java:27)\r\nat org.jboss.resteasy.reactive.server.handlers.InstanceHandler.handle(InstanceHandler.java:26)\r\nat io.quarkus.resteasy.reactive.server.runtime.QuarkusResteasyReactiveRequestContext.invokeHandler(QuarkusResteasyReactiveRequestContext.java:113)\r\nat org.jboss.resteasy.reactive.common.core.AbstractResteasyReactiveContext.run(AbstractResteasyReactiveContext.java:142)\r\nat org.jboss.resteasy.reactive.server.vertx.VertxResteasyReactiveRequestContext$1$1.handle(VertxResteasyReactiveRequestContext.java:79)\r\nat org.jboss.resteasy.reactive.server.vertx.VertxResteasyReactiveRequestContext$1$1.handle(VertxResteasyReactiveRequestContext.java:76)\r\nat io.vertx.core.impl.ContextInternal.dispatch(ContextInternal.java:264)\r\nat io.vertx.core.impl.ContextInternal.dispatch(ContextInternal.java:246)\r\nat io.vertx.core.impl.EventLoopContext.lambda$runOnContext$0(EventLoopContext.java:43)\r\nat io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)\r\nat io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)\r\nat io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)\r\nat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:566)\r\nat io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)\r\nat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\r\nat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\nat java.base/java.lang.Thread.run(Thread.java:833)\r\n```\r\n\r\n\r\nAt different occasions it occurs for different XXXResource_Bean classes, but the upper part of the stacktrace is always the same.\r\n\r\nI Realize this is a very generic error but currently we have no clue how to track that, unfortunately it's not telling me which zip file it is (I assume a jar file).\r\n\r\nHas anyone ever seen a similar behavior? Any hints welcome. We already switched machines a few times since we suspected faulty drives.\r\n\r\nThis happens in production and our staging environment. The endpoints failing are http requests  doing basic CRUD via vertx reactive pg client. Sometimes its a HTTP resource bean, sometimes an intermediate service bean thats part of the stacktrace\r\n\r\n\r\n\r\n### Expected behavior\r\n\r\nWhen calling an endpoint of the app it should reliably answer\r\n\r\n### Actual behavior\r\n\r\nAt times there is multitude of zip file errors. Only a restart fixes that.\r\n\r\n### How to Reproduce?\r\n\r\nNot explicitly reproducible \r\n\r\n### Output of `uname -a` or `ver`\r\n\r\nLinux stage-myad2 5.10.0-21-cloud-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) x86_64 GNU/Linux\r\n\r\n### Output of `java -version`\r\n\r\nopenjdk version \"17.0.7\"\r\n\r\n### GraalVM version (if different from Java)\r\n\r\nopenjdk version \"17.0.7\"\r\n\r\n### Quarkus version or git rev\r\n\r\nQuarkus 2.13.7 (production mode)\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\nGradle 7.5.1\r\n\r\n### Additional information\r\n\r\nThere is a mention of possible race in JarResource.java on line 154 https://github.com/quarkusio/quarkus/blob/88c2a7b5e7638509e887c5bc0a39ed9840a537ce/independent-projects/bootstrap/runner/src/main/java/io/quarkus/bootstrap/runner/JarResource.java#L154\r\nMaybe this is related, but  this is quite old code, I'm wondering why we only 'recently' are having issues with this kind of error. We reported this in quarkusio zulipchat as well  https://quarkusio.zulipchat.com/#narrow/stream/187030-users/topic/zip.20file.20closed",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/34601/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/34601/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
