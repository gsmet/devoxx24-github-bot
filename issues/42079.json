{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/42079",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/42079/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/42079/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/42079/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/42079",
  "id": 2425008248,
  "node_id": "I_kwDOCFbutM6QirB4",
  "number": 42079,
  "title": "Issue with subscribeAsMessages Method in Quarkus Redis Client",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 2184343143,
      "node_id": "MDU6TGFiZWwyMTg0MzQzMTQz",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/redis",
      "name": "area/redis",
      "color": "0366d6",
      "default": false,
      "description": ""
    },
    {
      "id": 2744442223,
      "node_id": "MDU6TGFiZWwyNzQ0NDQyMjIz",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/triage/needs-reproducer",
      "name": "triage/needs-reproducer",
      "color": "FDE078",
      "default": false,
      "description": "We are waiting for a reproducer."
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/342",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/342",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/342/labels",
    "id": 11343287,
    "node_id": "MI_kwDOCFbutM4ArRW3",
    "number": 342,
    "title": "3.13.0",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 49,
    "state": "closed",
    "created_at": "2024-07-22T12:36:53Z",
    "updated_at": "2024-08-14T12:51:18Z",
    "due_on": null,
    "closed_at": "2024-07-24T10:57:11Z"
  },
  "comments": 4,
  "created_at": "2024-07-23T11:49:35Z",
  "updated_at": "2024-07-23T21:53:45Z",
  "closed_at": "2024-07-23T21:38:37Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nI'm experiencing an issue with the subscribeAsMessages method in Quarkus. When attempting to subscribe to Redis channels using subscribeAsMessages, the subscription appears to occur, but the processMessage method is never called when the channel receives events. In contrast, using the subscribe method works correctly.\r\n\r\n### Expected behavior\r\n\r\nThe subscribeAsMessages method should successfully subscribe to the Redis channels and trigger the processMessage method when events are received on the subscribed channels.\r\n\r\n### Actual behavior\r\n\r\nThe subscribeAsMessages method subscribes to the channels, but the processMessage method is never invoked when events are received on those channels. The subscribe method, however, works as expected and correctly invokes processMessage.\r\n\r\n### How to Reproduce?\r\n\r\nBoth methods utilize a \r\n`\r\nprivate final ReactivePubSubCommands<byte[]> redisPubSub.\r\n`\r\n\r\nWorking code:\r\n```\r\nprivate void subscribeToChannels() {\r\n    redisPubSub.subscribe(channelsString)\r\n            .onItem().invoke(message -> processMessage(message))\r\n            .subscribe().with(\r\n                    item -> LOG.infof(\"Subscribed to channel: item %s\", item),\r\n                    failure -> LOG.errorf(\"Failed to subscribe to channel: %s, due to: %s\", failure.getMessage())\r\n            );\r\n}\r\n```\r\nNon-working code:\r\n```\r\nprivate void subscribeToChannels() {\r\n    redisPubSub.subscribeAsMessages(channelsString)\r\n            .onItem().invoke(message -> processMessage(message.getPayload()))\r\n            .subscribe().with(\r\n                    item -> LOG.infof(\"Subscribed to channel: item %s\", item),\r\n                    failure -> LOG.errorf(\"Failed to subscribe to channel: %s, due to: %s\", failure.getMessage())\r\n            );\r\n}\r\n```\r\n\r\n1) Implement the subscribeToChannels method using subscribeAsMessages.\r\n2) Attempt to subscribe to the Redis channels.\r\n3) Send events to the subscribed channels.\r\n4) Observe that the processMessage method is never called for subscribeAsMessages on Non-working code.\r\n\r\n### Output of `uname -a` or `ver`\r\n\r\nLinux latitude 6.5.0-44-generic #44~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Tue Jun 18 14:36:16 UTC 2 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n### Output of `java -version`\r\n\r\nopenjdk version \"21.0.1\" 2023-10-17 LTS\r\n\r\n### Quarkus version or git rev\r\n\r\nQuarkus 3.12.3\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\nApache Maven 3.9.7\r\n\r\n### Additional information\r\n\r\nThe documentation lacks examples for Pub/Sub using subscribeAsMessages, which could be very helpful in understanding and correctly implementing this feature.",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/42079/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/42079/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
