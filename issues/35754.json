{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/35754",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35754/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35754/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35754/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/35754",
  "id": 1882523401,
  "node_id": "I_kwDOCFbutM5wNQcJ",
  "number": 35754,
  "title": "Request reauthentication instead of 401 if OIDC state query param is missing",
  "labels": [
    {
      "id": 985346622,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjI=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/enhancement",
      "name": "kind/enhancement",
      "color": "a2eeef",
      "default": false,
      "description": "New feature or request"
    },
    {
      "id": 1479557456,
      "node_id": "MDU6TGFiZWwxNDc5NTU3NDU2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/oidc",
      "name": "area/oidc",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/274",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/274",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/274/labels",
    "id": 9889574,
    "node_id": "MI_kwDOCFbutM4Alucm",
    "number": 274,
    "title": "3.5.0.CR1",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 229,
    "state": "closed",
    "created_at": "2023-09-06T06:54:19Z",
    "updated_at": "2023-11-01T08:32:25Z",
    "due_on": null,
    "closed_at": "2023-10-11T12:10:19Z"
  },
  "comments": 1,
  "created_at": "2023-09-05T18:29:53Z",
  "updated_at": "2023-09-06T09:36:55Z",
  "closed_at": "2023-09-06T09:36:51Z",
  "active_lock_reason": null,
  "body": "### Description\n\nWhen the OIDC code flow completes a state cookie and the state query parameter have to be matched. If the state query parameter is missing, then 401 may be returned in some cases, where redirect path matches the original request URL.\r\n\r\nThis `401` has been causing many headaches, sometimes the authentication has not been completed, so the state cookie would temp be around and then retrying the application path again would fail with 401 since it is not an OIDC redirect. \r\n\r\nSo recently, a property, `quarkus.oidc.authentication.fail-on-missing-state-param` was introduced, to let users set it to `false` and just get a new authentication challenge in such cases.\r\n\r\nI've been working on a demo recently trying multiple providers, and I have to admit, it is really annoying to keep suddenly getting 401 because some previous authentication attempt was not completed. \r\n\r\nThe plan with `quarkus.oidc.authentication.fail-on-missing-state-param` was that over time it could be disabled by default and IMHO it is worth doing it now on the main branch. The experience after testing my demo with the related PR is totally different, if there is a hanging state cookie, it is now removed and I'm redirected back to the current provider to reauthenticate or re-authorize Quarkus - it just works.\r\n\r\n`quarkus.oidc.authentication.fail-on-missing-state-param=true` should only be set from now on when there is a very concrete requirement for it\r\n\r\n\n\n### Implementation ideas\n\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/35754/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35754/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
