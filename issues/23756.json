{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/23756",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/23756/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/23756/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/23756/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/23756",
  "id": 1139887076,
  "node_id": "I_kwDOCFbutM5D8Uvk",
  "number": 23756,
  "title": "RESTEasy (Reactive) JSON serialization for multipart form data containing emojis is wrong",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 2552031458,
      "node_id": "MDU6TGFiZWwyNTUyMDMxNDU4",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/rest",
      "name": "area/rest",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/175",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/175",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/175/labels",
    "id": 7698730,
    "node_id": "MI_kwDOCFbutM4AdXkq",
    "number": 175,
    "title": "2.7.2.Final",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 159,
    "state": "closed",
    "created_at": "2022-02-21T12:59:08Z",
    "updated_at": "2022-05-12T16:40:04Z",
    "due_on": null,
    "closed_at": "2022-02-22T17:21:05Z"
  },
  "comments": 3,
  "created_at": "2022-02-16T11:25:34Z",
  "updated_at": "2022-02-21T17:01:10Z",
  "closed_at": "2022-02-21T10:06:13Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nSerialization (string) data containing emojis as JSON form parts in multipart responses or payloads differs from serialization in non-multipart contexts:\r\n\r\n```\r\n@Path(\"/test\")\r\npublic class ReactiveMultipartTestResource {\r\n\r\n    public static class TestData {\r\n        public String bar;\r\n\r\n        public TestData(String bar) {\r\n            this.bar = bar;\r\n        }\r\n    }\r\n\r\n    public static class FormData {\r\n        @RestForm\r\n        @PartType(MediaType.APPLICATION_JSON)\r\n        public TestData data;\r\n        @RestForm\r\n        public String dataAsString;\r\n    }\r\n\r\n    @Inject\r\n    ObjectMapper om;\r\n\r\n    @GET\r\n    @Produces(MediaType.MULTIPART_FORM_DATA)\r\n    public FormData hello() throws JsonProcessingException {\r\n        FormData form = new FormData();\r\n        form.data = new TestData(\"Bar Ã¤Ã¶Ã¼ ðŸ˜€\");\r\n        form.dataAsString = om.writeValueAsString(form.data);\r\n        return form;\r\n    }\r\n}\r\n```\r\n\r\nLooking at the raw request's response shows different encodings for the emoji part. It's not a \"simple\" UTF-8 problem as the German umlauts for example are correct. This is taken from IntelliJ's HTTP request tool's response file, not sure how encoding is screwed by pasting and submitting here though...)\r\n\r\n```\r\n--b7ae92fe-eb4e-4a8b-b142-c77b79adbd88\r\nContent-Disposition: form-data; name=\"data\"\r\nContent-Type: application/json\r\n\r\n{\"bar\":\"Bar ÃƒÂ¤ÃƒÂ¶ÃƒÂ¼ \\uD83D\\uDE00\"}\r\n--b7ae92fe-eb4e-4a8b-b142-c77b79adbd88\r\nContent-Disposition: form-data; name=\"dataAsString\"\r\nContent-Type: text/plain\r\n\r\n{\"bar\":\"Bar ÃƒÂ¤ÃƒÂ¶ÃƒÂ¼ Ã°ÂŸÂ˜Â€\"}\r\n--b7ae92fe-eb4e-4a8b-b142-c77b79adbd88--\r\n```\r\n\n\n### Expected behavior\n\nSerialized JSON should be the same for \"standard\" serialization and \"automatic\" serialization in multipart contexts.\n\n### Actual behavior\n\nSee above :)\n\n### How to Reproduce?\n\nSee above :)\n\n### Output of `uname -a` or `ver`\n\n_No response_\n\n### Output of `java -version`\n\n_No response_\n\n### GraalVM version (if different from Java)\n\n_No response_\n\n### Quarkus version or git rev\n\n2.7.1\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\n_No response_\n\n### Additional information\n\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/23756/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/23756/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
