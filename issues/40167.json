{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/40167",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/40167/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/40167/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/40167/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/40167",
  "id": 2254052516,
  "node_id": "I_kwDOCFbutM6GWhyk",
  "number": 40167,
  "title": "Rest Client `@RestForm` does not serialize enums like other parameter types",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1326067509,
      "node_id": "MDU6TGFiZWwxMzI2MDY3NTA5",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/rest-client",
      "name": "area/rest-client",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/327",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/327",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/327/labels",
    "id": 10976485,
    "node_id": "MI_kwDOCFbutM4Ap3zl",
    "number": 327,
    "title": "3.10.1",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 1,
    "closed_issues": 57,
    "state": "closed",
    "created_at": "2024-04-26T07:55:58Z",
    "updated_at": "2024-08-08T07:30:57Z",
    "due_on": null,
    "closed_at": "2024-05-15T12:10:23Z"
  },
  "comments": 2,
  "created_at": "2024-04-19T21:47:33Z",
  "updated_at": "2024-05-10T16:33:34Z",
  "closed_at": "2024-04-26T12:06:54Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nIf you create a custom enum, you can implement `fromString` to deserialize a string to its appropriate enum object. Conversely, you can override `toString` to serialize the enum to a custom string rather than the enum's name.\r\n\r\nWhen implementing resource endpoints in RestEASY, deserialization is respected for `@RestQuery` and `@RestForm` where input strings are converted to appropriate enums. Serialization from enum to string is also respected when outputting an enum as plain text, in json, etc.\r\n\r\nWhen implementing Rest Client endpoints that take an enum parameter, the underlying HTTP requests should contain the enum's `toString` serialization for query params, form params, etc.\r\n\r\nSerialization is respected for Rest Client query params via `@RestQuery`.\r\n\r\nHowever, serialization is not respected for Rest Client form params via `@RestForm` and exhibits behavior inconsistent to the other prior examples. Form params will use the enum's name rather than `toString` output.\r\n\r\nPerhaps the code path that Client form params follow may be calling `Enum#name()` rather than `toString`?\n\n### Expected behavior\n\nIn form bodies, enums should be serialized by `toString`. For example, if you had an enum:\r\n\r\n```java\r\npublic enum MyEnum {\r\n    BLAH(\"blah\");\r\n\r\n    private final String value;\r\n\r\n    MyEnum(final String value) { ... }\r\n\r\n    @Override\r\n    public String toString() { \r\n        return value;\r\n    }\r\n}\r\n```\r\n\r\nA rest client endpoint that takes `@RestForm MyEnum myEnum` should pass the following to the HTTP request's form body:\r\n\r\n```\r\nmyEnum=blah\r\n```\n\n### Actual behavior\n\nForm bodies will end up with the name representation of the enum:\r\n\r\n```\r\nmyEnum=BLAH\r\n```\n\n### How to Reproduce?\n\nDemo repo is here:\r\n\r\nhttps://github.com/krnhotwings/quarkus-rest-client-enum\r\n\r\nReproduction steps are in the README:\r\n\r\n1. Start server with `quarkus dev`\r\n2. Run `curl` commands\r\n\r\n### Expected output\r\n\r\n```sh\r\ncurl -X GET \"http://localhost:8080/resteasy?myEnum=test\"\r\ncurl -X POST \"http://localhost:8080/resteasy\" -d \"myEnum=test\"\r\ncurl -X GET \"http://localhost:8080/restclient?myEnum=test\"\r\n```\r\n\r\nNote in the log output that the 3rd curl will make an HTTP request to httpbin with the lowercase enum serialization:\r\n\r\n```\r\nRequest: GET https://httpbin.org/get?myEnum=test Headers[User-Agent=Quarkus REST Client], Empty body\r\n```\r\n\r\n### Unexpected output\r\n\r\n```sh\r\ncurl -X POST \"http://localhost:8080/restclient\" -d \"myEnum=test\"\r\n```\r\n\r\nHowever, form params will be uppercased:\r\n\r\n```\r\nRequest: POST https://httpbin.org/post Headers[Content-Type=application/x-www-form-urlencoded User-Agent=Quarkus REST Client content-length=11], Body:\r\nmyEnum=TEST\r\n```\r\n\n\n### Output of `uname -a` or `ver`\n\nLinux 6.8.6-200.fc39.x86_64\n\n### Output of `java -version`\n\nopenjdk version \"21.0.2\" 2024-01-16\n\n### Quarkus version or git rev\n\n3.9.4\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\nGradle 8.6\n\n### Additional information\n\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/40167/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/40167/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
