{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/35011",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35011/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35011/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35011/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/35011",
  "id": 1821100819,
  "node_id": "I_kwDOCFbutM5si8sT",
  "number": 35011,
  "title": "`@ConfigProperty` injection semantics change when `quarkus-spring-di` is present and `@Inject` is used (regression in Quarkus 3)",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1282102389,
      "node_id": "MDU6TGFiZWwxMjgyMTAyMzg5",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/arc",
      "name": "area/arc",
      "color": "0366d6",
      "default": false,
      "description": "Issue related to ARC (dependency injection)"
    },
    {
      "id": 1552233747,
      "node_id": "MDU6TGFiZWwxNTUyMjMzNzQ3",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/spring",
      "name": "area/spring",
      "color": "0366d6",
      "default": false,
      "description": "Issues relating to the Spring integration"
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/264",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/264",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/264/labels",
    "id": 9694439,
    "node_id": "MI_kwDOCFbutM4Ak-zn",
    "number": 264,
    "title": "3.2.3.Final",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 62,
    "state": "closed",
    "created_at": "2023-07-25T12:04:44Z",
    "updated_at": "2023-08-09T14:47:41Z",
    "due_on": null,
    "closed_at": "2023-08-02T12:57:21Z"
  },
  "comments": 11,
  "created_at": "2023-07-25T20:31:42Z",
  "updated_at": "2023-07-28T16:01:11Z",
  "closed_at": "2023-07-26T10:05:25Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nMy project is using `quarkus-spring-data-jpa` which brings in `quarkus-spring-di` transitively.\r\nSince we decided to use constructor injection where possible, we have decided to set `quarkus.arc.auto-inject-fields=false` a long time ago and so in QuarkusTests (that do not support constructor injection) we are using e.g.:\r\n```\r\n@Inject\r\n@ConfigProperty(\"foo\")\r\nList<String> foo;\r\n```\r\n(notice the explicit `@Inject`)\r\n\r\nWith Quarkus 2.16.8, the following config is mapped to a two elements list, just as expected:\r\n```\r\nfoo=bar1,bar2\r\n```\r\nBut with Quarkus 3.2.2 I'm getting a single element list (value `bar1,bar2`).\r\n\r\nI suppose `spring-di` gets in the way and injects the property on it's own terms without the splitting logic that normally takes place here.\r\n\r\nThis is especially confusing when you inject the same config property in a test as in the class under test that uses constructor injection -> boom, mismatch!\r\n\r\n### Expected behavior\r\n\r\n`@ConfigProperty` don't change just because `quarkus-spring-di` is one the classpath (which I haven't defined directly)\r\n\r\n### Actual behavior\r\n\r\n`@ConfigProperty` list injection breaks\r\n\r\n### How to Reproduce?\r\n\r\n1. extract [q_config-list-spring-di.zip](https://github.com/quarkusio/quarkus/files/12165372/q_config-list-spring-di.zip)\r\n2. `mvn clean test`\r\n\r\n### Output of `uname -a` or `ver`\r\n\r\n_No response_\r\n\r\n### Output of `java -version`\r\n\r\n_No response_\r\n\r\n### GraalVM version (if different from Java)\r\n\r\n_No response_\r\n\r\n### Quarkus version or git rev\r\n\r\n3.2.2.Final\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\n_No response_\r\n\r\n### Additional information\r\n\r\nSure, we could leave `quarkus.arc.auto-inject-fields` untouched to avoid this problem but just by choosing `quarkus-spring-data-jpa` I haven't really said: \"I want Spring DI\".\r\n\r\nI checked the 3.x migration guides and found nothing on that topic.\r\n\r\nI first thought it has something to do with yaml but the issues also occurs with vanilla properties config (as shown in the reproducer).\r\n\r\n*Workaround*:\r\nInject `String` (and not a list) and split it yourself.",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/35011/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35011/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
