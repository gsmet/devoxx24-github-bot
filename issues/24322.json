{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/24322",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/24322/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/24322/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/24322/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/24322",
  "id": 1169768381,
  "node_id": "I_kwDOCFbutM5FuT-9",
  "number": 24322,
  "title": "Config like `mp.messaging.connector.smallrye-kafka.value.serializer` is ignored",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1283619446,
      "node_id": "MDU6TGFiZWwxMjgzNjE5NDQ2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/smallrye",
      "name": "area/smallrye",
      "color": "0366d6",
      "default": false,
      "description": ""
    },
    {
      "id": 1658790125,
      "node_id": "MDU6TGFiZWwxNjU4NzkwMTI1",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/kafka",
      "name": "area/kafka",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/181",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/181",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/181/labels",
    "id": 7864289,
    "node_id": "MI_kwDOCFbutM4Ad__h",
    "number": 181,
    "title": "2.8.1.Final",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 78,
    "state": "closed",
    "created_at": "2022-04-11T09:08:46Z",
    "updated_at": "2023-01-25T08:58:43Z",
    "due_on": null,
    "closed_at": "2022-04-19T12:20:18Z"
  },
  "comments": 3,
  "created_at": "2022-03-15T14:41:58Z",
  "updated_at": "2022-04-11T09:13:03Z",
  "closed_at": "2022-04-04T10:12:52Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nThe build step `SmallRyeReactiveMessagingKafkaProcessor#defaultChannelConfiguration()` currently ignores checking for connector-level config like `mp.messaging.connector.smallrye-kafka.value.serializer`. As a result this configuration has no effect when added to the `application.properties` file because the generated channel-level `RunTimeConfigurationDefaultBuildItem` defaults take precedence.\r\n\r\nSee also discussion in Zulip: https://quarkusio.zulipchat.com/#narrow/stream/187030-users/topic/.E2.9C.94.20Kafka.3A.20Apicurio.20for.20dev.20and.20Confluent.20for.20prod.20mode.3F\r\n\r\n### Expected behavior\r\n\r\nExplicit connector-level config in `application.properties` should take precedence over generated channel-level defaults.\r\n\r\nThe build step should probably check for the presence of such properties at build time to determine whether to generate a runtime default or not for a given channel's properties.\r\n\r\n#### Use case\r\n\r\nWe are using Kafka with a schema registry and Avro encoded messages. In production the schema registry is the Confluent implementation and for development in dev mode we use Apicurio. This means that the serializer and deserializer implementation classes are different for production and non-production (i.e. test and development) launch modes. Further, since our application uses multiple channels, we would like to declare the Avro serializer and deserializer at the connector level, rather than individually for each channel. Doing it for each channel results in a lot of duplicated config.\r\n\r\n### Actual behavior\r\n\r\nThe explicit connector-level config (like `mp.messaging.connector.smallrye-kafka.value.serializer`) in the `application.properties` file is ignored, because the autodetection generates corresponding channel-level config which takes precedence.\r\n\r\n### How to Reproduce?\r\n\r\n_No response_\r\n\r\n### Output of `uname -a` or `ver`\r\n\r\n_No response_\r\n\r\n### Output of `java -version`\r\n\r\n_No response_\r\n\r\n### GraalVM version (if different from Java)\r\n\r\n_No response_\r\n\r\n### Quarkus version or git rev\r\n\r\n2.7.4.Final\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\n_No response_\r\n\r\n### Additional information\r\n",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/24322/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/24322/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
