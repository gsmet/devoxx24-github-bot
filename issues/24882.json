{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/24882",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/24882/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/24882/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/24882/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/24882",
  "id": 1201071786,
  "node_id": "I_kwDOCFbutM5Hluaq",
  "number": 24882,
  "title": "Passing Custom State Data for OIDC Auth Flows",
  "labels": [
    {
      "id": 985346622,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjI=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/enhancement",
      "name": "kind/enhancement",
      "color": "a2eeef",
      "default": false,
      "description": "New feature or request"
    },
    {
      "id": 1479557456,
      "node_id": "MDU6TGFiZWwxNDc5NTU3NDU2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/oidc",
      "name": "area/oidc",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/183",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/183",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/183/labels",
    "id": 7917759,
    "node_id": "MI_kwDOCFbutM4AeNC_",
    "number": 183,
    "title": "2.10.0.CR1",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 253,
    "state": "closed",
    "created_at": "2022-04-27T08:14:38Z",
    "updated_at": "2023-01-13T10:46:24Z",
    "due_on": null,
    "closed_at": "2022-06-09T16:06:42Z"
  },
  "comments": 5,
  "created_at": "2022-04-12T05:08:17Z",
  "updated_at": "2022-05-25T09:23:03Z",
  "closed_at": "2022-05-25T09:22:58Z",
  "active_lock_reason": null,
  "body": "### Description\r\n\r\nCurrently, the Quarkus OIDC extension doesn't allow developers to set custom state data as part of the `state` query parameter for the initial Authorization Request. Unfortunately, this state data is used quite frequently for passing information such as a \"return to\" URL or \"invite code\" as part of the user login flow. One work-around to this problem is to provide the \"return to\" URL or \"invite code\" as a query parameter to the Redirect Endpoint URI (https://www.rfc-editor.org/rfc/rfc6749#section-3.1.2). Unfortunately, many authorization providers (e.g. Okta and Auth0) prevent developers from using wildcard parameters when configuring Redirect Endpoints thereby forcing developers to use the `state` query parameter to pass this custom data.\r\n\r\n### Implementation ideas\r\n\r\nA few ideas come to mind regarding how we can solve this problem.\r\n\r\n1. Provide a configuration option with a list of query parameters that should be encoded and passed to the authentication server as part of the initial authorization request. For example, use the following Quarkus configuration property to enumerate the query parameters that would then be serialized as part of the `state` query parameter.\r\n\r\n`quarkus.oidc.login.extra-params=invitationCode,cameFromUrl`\r\n\r\n2. Expose functionality of the [CodeAuthenticationMechanism](https://github.com/quarkusio/quarkus/blob/main/extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/CodeAuthenticationMechanism.java) with dependency inject allowing developers build their own state bean. Primarily this functionality resides [here](https://github.com/quarkusio/quarkus/blob/main/extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/CodeAuthenticationMechanism.java#L650). Unfortunately, this would require users to create their own login endpoint within their app so this is less than ideal.",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/24882/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/24882/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
