{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/34546",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/34546/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/34546/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/34546/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/34546",
  "id": 1789410752,
  "node_id": "I_kwDOCFbutM5qqD3A",
  "number": 34546,
  "title": "Hibernate startup validation failure is not logged",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1676631606,
      "node_id": "MDU6TGFiZWwxNjc2NjMxNjA2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/env/windows",
      "name": "env/windows",
      "color": "edea47",
      "default": false,
      "description": "Impacts Windows machines"
    },
    {
      "id": 2388070055,
      "node_id": "MDU6TGFiZWwyMzg4MDcwMDU1",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/quarkiverse",
      "name": "area/quarkiverse",
      "color": "a01441",
      "default": false,
      "description": "This issue/PR is part of the Quarkiverse organization"
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": null,
  "comments": 4,
  "created_at": "2023-07-05T12:03:47Z",
  "updated_at": "2024-08-15T03:07:55Z",
  "closed_at": "2024-08-15T03:07:55Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nWhen the Logback extension is used and the application fails to start due to any sort of DB schema validation issue found by Hibernate, the application silently crashes/fails, no logs are appearing that would describe the cause.\r\n\r\nCould you have a look at this issue?\r\nThanks in advance,\r\nHuba\n\n### Expected behavior\n\nException causing the startup failure is visible in the logs, both in dev mode and built executable (prod) run.\n\n### Actual behavior\n\nIn dev mode no stacktrace visible in logs.\r\n```\r\n[INFO] Scanning for projects...\r\n[INFO]\r\n[INFO] ---------------------< org.acme:code-with-quarkus >---------------------\r\n[INFO] Building code-with-quarkus 1.0.0-SNAPSHOT\r\n[INFO] --------------------------------[ jar ]---------------------------------\r\n[INFO]\r\n[INFO] --- quarkus-maven-plugin:2.16.8.Final:dev (default-cli) @ code-with-quarkus ---\r\n[INFO] Invoking org.apache.maven.plugins:maven-resources-plugin:2.6:resources @ code-with-quarkus\r\n[INFO] Using 'UTF-8' encoding to copy filtered resources.\r\n[INFO] Copying 2 resources\r\n[INFO] Invoking io.quarkus.platform:quarkus-maven-plugin:2.16.8.Final:generate-code @ code-with-quarkus\r\n[INFO] Invoking org.apache.maven.plugins:maven-compiler-plugin:3.10.1:compile @ code-with-quarkus\r\n[INFO] Changes detected - recompiling the module!\r\n[INFO] Compiling 3 source files to C:\\Users\\hpeter\\work\\hibernate-error-log-missing-reproducer\\target\\classes\r\n[INFO] Invoking org.apache.maven.plugins:maven-resources-plugin:2.6:testResources @ code-with-quarkus\r\n[INFO] Using 'UTF-8' encoding to copy filtered resources.\r\n[INFO] skip non existing resourceDirectory C:\\Users\\hpeter\\work\\hibernate-error-log-missing-reproducer\\src\\test\\resources\r\n[INFO] Invoking io.quarkus.platform:quarkus-maven-plugin:2.16.8.Final:generate-code-tests @ code-with-quarkus\r\n[INFO] Invoking org.apache.maven.plugins:maven-compiler-plugin:3.10.1:testCompile @ code-with-quarkus\r\n[INFO] No sources to compile\r\nListening for transport dt_socket at address: 5005\r\n14:29:19,498 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - Naming appender as [JSON_CONSOLE]\r\n14:29:19,505 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.LoggingEventJsonProviders] for [providers] property\r\n14:29:19,509 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.MessageJsonProvider] for [message] property\r\n14:29:19,511 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.LoggingEventFormattedTimestampJsonProvider] for [timestamp] property\r\n14:29:19,512 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.LogLevelJsonProvider] for [logLevel] property\r\n14:29:19,514 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.LoggerNameJsonProvider] for [loggerName] property\r\n14:29:19,515 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.LoggingEventThreadNameJsonProvider] for [threadName] property\r\n14:29:19,516 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.MdcJsonProvider] for [mdc] property\r\n14:29:19,517 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.StackTraceJsonProvider] for [stackTrace] property\r\n14:29:19,520 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - About to instantiate appender of type [ch.qos.logback.core.ConsoleAppender$$delayed]\r\n14:29:19,520 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - Naming appender as [CONSOLE]\r\n14:29:19,521 |-INFO in ch.qos.logback.classic.joran.action.LoggerAction - Setting level of logger [com.nestle.nestpay] to DEBUG\r\n14:29:19,572 |-INFO in ch.qos.logback.classic.joran.action.LoggerAction - Setting level of logger [org.hibernate.SQL] to DEBUG\r\n14:29:19,573 |-INFO in ch.qos.logback.classic.joran.action.RootLoggerAction - Setting level of ROOT logger to INFO\r\n14:29:19,573 |-INFO in ch.qos.logback.core.joran.action.AppenderRefAction - Attaching appender named [CONSOLE] to Logger[ROOT]\r\n14:29:19,574 |-INFO in ch.qos.logback.classic.joran.action.ConfigurationAction - End of configuration.\r\n2023-07-05 14:29:20,666 INFO  [io.qua.dep.dev.IsolatedDevModeMain] (main) Attempting to start live reload endpoint to recover from previous Quarkus startup failure\r\n14:29:47,787 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - About to instantiate appender of type [ch.qos.logback.core.ConsoleAppender$$delayed]\r\n14:29:47,787 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - Naming appender as [JSON_CONSOLE]\r\n14:29:47,788 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.LoggingEventJsonProviders] for [providers] property\r\n14:29:47,788 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.MessageJsonProvider] for [message] property\r\n14:29:47,789 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.LoggingEventFormattedTimestampJsonProvider] for [timestamp] property\r\n14:29:47,789 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.LogLevelJsonProvider] for [logLevel] property\r\n14:29:47,790 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.LoggerNameJsonProvider] for [loggerName] property\r\n14:29:47,790 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.LoggingEventThreadNameJsonProvider] for [threadName] property\r\n14:29:47,791 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.MdcJsonProvider] for [mdc] property\r\n14:29:47,791 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.StackTraceJsonProvider] for [stackTrace] property\r\n14:29:47,792 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - About to instantiate appender of type [ch.qos.logback.core.ConsoleAppender$$delayed]\r\n14:29:47,792 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - Naming appender as [CONSOLE]\r\n14:29:47,792 |-INFO in ch.qos.logback.classic.joran.action.LoggerAction - Setting level of logger [com.nestle.nestpay] to DEBUG\r\n14:29:47,794 |-INFO in ch.qos.logback.classic.joran.action.LoggerAction - Setting level of logger [org.hibernate.SQL] to DEBUG\r\n14:29:47,795 |-INFO in ch.qos.logback.classic.joran.action.RootLoggerAction - Setting level of ROOT logger to INFO\r\n14:29:47,795 |-INFO in ch.qos.logback.core.joran.action.AppenderRefAction - Attaching appender named [CONSOLE] to Logger[ROOT]\r\n14:29:47,795 |-INFO in ch.qos.logback.classic.joran.action.ConfigurationAction - End of configuration.\r\n2023-07-05 14:29:47,944 INFO  [io.qua.dep.dev.RuntimeUpdatesProcessor] (vert.x-worker-thread-1) Live reload total time: 0.485s\r\n\r\n--\r\nTests paused\r\nPress [r] to resume testing, [o] Toggle test output, [:] for the terminal, [h] for more options>\r\n```\r\nThe issue is that no error log or stacktrace is visible. The actual exception can be only seen if the Dev UI is opened.\r\n\r\n\r\n\r\nIn prod mode no stacktrace and no error log line visible in logs:\r\n```\r\nPS C:\\Users\\hpeter\\work\\hibernate-error-log-missing-reproducer>  java -jar target/quarkus-app/quarkus-run.jar\r\n14:31:11,269 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - About to instantiate appender of type [ch.qos.logback.core.ConsoleAppender$$delayed]\r\n14:31:11,299 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - Naming appender as [JSON_CONSOLE]\r\n14:31:11,311 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.LoggingEventJsonProviders] for [providers] property\r\n14:31:11,317 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.MessageJsonProvider] for [message] property\r\n14:31:11,331 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.LoggingEventFormattedTimestampJsonProvider] for [timestamp] property\r\n14:31:11,333 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.LogLevelJsonProvider] for [logLevel] property\r\n14:31:11,334 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.LoggerNameJsonProvider] for [loggerName] property\r\n14:31:11,335 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.LoggingEventThreadNameJsonProvider] for [threadName] property\r\n14:31:11,335 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.MdcJsonProvider] for [mdc] property\r\n14:31:11,337 |-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default type [net.logstash.logback.composite.loggingevent.StackTraceJsonProvider] for [stackTrace] property\r\n14:31:11,339 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - About to instantiate appender of type [ch.qos.logback.core.ConsoleAppender$$delayed]\r\n14:31:11,339 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - Naming appender as [CONSOLE]\r\n14:31:11,340 |-INFO in ch.qos.logback.classic.joran.action.LoggerAction - Setting level of logger [com.nestle.nestpay] to DEBUG\r\n14:31:11,503 |-INFO in ch.qos.logback.classic.joran.action.LoggerAction - Setting level of logger [org.hibernate.SQL] to DEBUG\r\n14:31:11,503 |-INFO in ch.qos.logback.classic.joran.action.RootLoggerAction - Setting level of ROOT logger to INFO\r\n14:31:11,503 |-INFO in ch.qos.logback.core.joran.action.AppenderRefAction - Attaching appender named [CONSOLE] to Logger[ROOT]\r\n14:31:11,503 |-INFO in ch.qos.logback.classic.joran.action.ConfigurationAction - End of configuration.\r\n```\n\n### How to Reproduce?\n\nTo reproduce in dev mode:\r\n1. clone the [reproducer repo](https://github.com/peterhuba/hibernate-error-log-missing-reproducer)\r\n2. start the application with `mvn quarkus:dev`\r\n3. the startup will fail because DB tables are missing, as expected, but the output will show no stacktrace\r\n\r\nTo reproduce in prod mode:\r\n1. clone the [reproducer repo](https://github.com/peterhuba/hibernate-error-log-missing-reproducer)\r\n2. build the application with `mvn clean package -DskipTests`\r\n3. run it with `java -jar target/quarkus-app/quarkus-run.jar`\r\n4. the startup will fail because DB tables are missing, as expected, but the output will show no stacktrace, and not even an error log\r\n\n\n### Output of `uname -a` or `ver`\n\nMicrosoft Windows [Version 10.0.19045.2965]\n\n### Output of `java -version`\n\nopenjdk version \"11.0.14.1\" 2022-02-08 OpenJDK Runtime Environment Temurin-11.0.14.1+1 (build 11.0.14.1+1) OpenJDK 64-Bit Server VM Temurin-11.0.14.1+1 (build 11.0.14.1+1, mixed mode)\n\n### GraalVM version (if different from Java)\n\n_No response_\n\n### Quarkus version or git rev\n\n2.16.8.Final\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\n3.8.8\n\n### Additional information\n\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/34546/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/34546/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
