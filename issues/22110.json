{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/22110",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/22110/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/22110/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/22110/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/22110",
  "id": 1076885905,
  "node_id": "I_kwDOCFbutM5AL_mR",
  "number": 22110,
  "title": "UPX compression used together with jib not working correctly",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1891982257,
      "node_id": "MDU6TGFiZWwxODkxOTgyMjU3",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/container-image",
      "name": "area/container-image",
      "color": "0366d6",
      "default": false,
      "description": ""
    },
    {
      "id": 2497075451,
      "node_id": "MDU6TGFiZWwyNDk3MDc1NDUx",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/native-image",
      "name": "area/native-image",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/163",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/163",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/163/labels",
    "id": 7473278,
    "node_id": "MI_kwDOCFbutM4Acgh-",
    "number": 163,
    "title": "2.6.0.Final",
    "description": null,
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 36,
    "state": "closed",
    "created_at": "2021-12-09T16:51:51Z",
    "updated_at": "2021-12-15T13:20:07Z",
    "due_on": null,
    "closed_at": "2021-12-15T13:20:07Z"
  },
  "comments": 2,
  "created_at": "2021-12-10T14:07:51Z",
  "updated_at": "2021-12-13T20:04:03Z",
  "closed_at": "2021-12-10T18:45:40Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nWhen building an native docker image with jib enabling UPX, the binary is compressed after the image is build and pushed. So the pushed container still uses the uncompressed version of the runner.\n\n### Expected behavior\n\nThe binary is first compressed and then the image is created, so that the binary in the image is the compressed one\n\n### Actual behavior\n\nVisible in the log, the message about the image digest occurs before the log about the compression\r\n```\r\n[mqtt-authorization-server-unspecified-runner:62]     (inline):  15,917.25 ms,  4.76 GB\r\n[mqtt-authorization-server-unspecified-runner:62]    (compile):  53,329.92 ms,  5.11 GB\r\n[mqtt-authorization-server-unspecified-runner:62]      compile:  92,045.23 ms,  4.91 GB\r\n[mqtt-authorization-server-unspecified-runner:62]        image:  11,680.85 ms,  5.02 GB\r\n[mqtt-authorization-server-unspecified-runner:62]        write:   2,805.42 ms,  5.02 GB\r\n[mqtt-authorization-server-unspecified-runner:62]      [total]: 251,420.95 ms,  5.02 GB\r\n# Printing build artifacts to: /project/mqtt-authorization-server-unspecified-runner.build_artifacts.txt\r\nBase image 'quay.io/quarkus/quarkus-micro-image:1.0' does not use a specific image digest - build may not be reproducible\r\n                       Ultimate Packer for eXecutables\r\n                          Copyright (C) 1996 - 2020\r\nUPX 3.96        Markus Oberhumer, Laszlo Molnar & John Reiser   Jan 23rd 2020\r\n\r\n        File size         Ratio      Format      Name\r\n   --------------------   ------   -----------   -----------\r\n 127902824 ->  32507128   25.42%   linux/amd64   mqtt-authorization-server-unspecified-runner\r\n\r\nPacked 1 file.\r\n\r\nBUILD SUCCESSFUL in 8m 39s\r\n5 actionable tasks: 3 executed, 2 up-to-date\r\n```\n\n### How to Reproduce?\n\n_No response_\n\n### Output of `uname -a` or `ver`\n\n_No response_\n\n### Output of `java -version`\n\n17.0.1\n\n### GraalVM version (if different from Java)\n\nquay.io/quarkus/ubi-quarkus-mandrel:21.3-java17\n\n### Quarkus version or git rev\n\n2.6.0.CR1\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\nGradle 7.3.1\n\n### Additional information\n\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/22110/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/22110/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
