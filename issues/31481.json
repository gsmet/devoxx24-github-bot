{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/31481",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/31481/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/31481/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/31481/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/31481",
  "id": 1603481648,
  "node_id": "I_kwDOCFbutM5fkzAw",
  "number": 31481,
  "title": "Multiple bugs related to sequences after switch to Hibernate 6",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1273026509,
      "node_id": "MDU6TGFiZWwxMjczMDI2NTA5",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/persistence",
      "name": "area/persistence",
      "color": "FBCA04",
      "default": false,
      "description": "OBSOLETE, DO NOT USE"
    },
    {
      "id": 1425555736,
      "node_id": "MDU6TGFiZWwxNDI1NTU1NzM2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/hibernate-orm",
      "name": "area/hibernate-orm",
      "color": "0366d6",
      "default": false,
      "description": "Hibernate ORM"
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": null,
  "comments": 5,
  "created_at": "2023-02-28T17:23:19Z",
  "updated_at": "2023-03-03T13:28:38Z",
  "closed_at": "2023-03-02T21:04:49Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nI have an application, which works with Postgress db via Panache (using the pattern based on PanacheEntity ). On the latest Quarkus, I see several problems, when working with autogenerated ids:\r\n1. Sequences(formerly `hibernate_sequence`) have increment of 50 (instead of previous 1)\r\n2. If sequence is altered to use increment of 1, ids of saved entities became negative\r\n\r\nSolution from original PR[1] (`ALTER SEQUENCE Vegetable_SEQ RESTART with 8;`) didn't solve the problem.\r\n\r\n[1] https://github.com/quarkusio/quarkus/pull/31235/files#diff-73007bb246230662d33fbca552c060313b33bf990949ac844988bb571ac003bb\r\n\r\n### Expected behavior\r\n\r\nQuarkus should support creation of entitites with consequential ids\r\n\r\n### Actual behavior\r\n\r\nsee above\r\n\r\n### How to Reproduce?\r\n\r\n1. `git clone \tgit@github.com:fedinskiy/reproducer.git -b reproducer/hibernate-sequence-negative`\r\n2. `mvn clean verify -Dquarkus.platform.version=3.0.0.Alpha4` â€” this works. \r\n3. Change line `quarkus.hibernate-orm.\"vegetables\".sql-load-script` from `import-vegetables_old.sql` to `import-vegetables_new.sql` (NOTE: for some reason, quarkus profiles[1] do not work with this option)\r\n4. Run `mvn clean verify`, which fails, selecting content from `vegetable` table in db shows this:\r\n```\r\n id  |   name   \r\n-----+----------\r\n   1 | Potato\r\n   2 | Carrot\r\n   3 | Parsley\r\n   4 | Kohlrabi\r\n   5 | Leek\r\n   6 | Onion\r\n   7 | Garlic\r\n -41 | Eggplant # this is expected to be 8\r\n -40 | Eggplant\r\n -39 | Eggplant\r\n\r\n```\r\n5. If line `ALTER SEQUENCE Vegetable_SEQ INCREMENT 1;` removed from  `import-vegetables_new.sql`,  tests fails and the table looks like this:\r\n```\r\n id  |   name   \r\n-----+----------\r\n   1 | Potato\r\n  51 | Carrot\r\n 101 | Parsley\r\n 151 | Kohlrabi\r\n 201 | Leek\r\n 251 | Onion\r\n 301 | Garlic\r\n 302 | Eggplant\r\n 303 | Eggplant\r\n 304 | Eggplant\r\n(10 rows)\r\n```\r\n[1] https://quarkus.io/guides/config-reference#custom-profiles\r\n\r\n### Output of `uname -a` or `ver`\r\n\r\n6.0.18-300.fc37.x86_64\r\n\r\n### Output of `java -version`\r\n\r\n17.0.5, vendor: GraalVM Community\r\n\r\n### GraalVM version (if different from Java)\r\n\r\n_No response_\r\n\r\n### Quarkus version or git rev\r\n\r\n1d45952917c72a12eed6b9351f6ecdca813637a8\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\nApache Maven 3.8.6 (84538c9988a25aec085021c365c560670ad80f63)\r\n\r\n### Additional information\r\n\r\nProbably related to https://github.com/quarkusio/quarkus/pull/31235",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/31481/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/31481/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
