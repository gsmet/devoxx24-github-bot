{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/31228",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/31228/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/31228/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/31228/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/31228",
  "id": 1588435250,
  "node_id": "I_kwDOCFbutM5erZky",
  "number": 31228,
  "title": "OpenShift deployment fails while instantiating the build",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1654772125,
      "node_id": "MDU6TGFiZWwxNjU0NzcyMTI1",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/kubernetes",
      "name": "area/kubernetes",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/239",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/239",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/239/labels",
    "id": 9130453,
    "node_id": "MI_kwDOCFbutM4Ai1HV",
    "number": 239,
    "title": "3.0.0.Alpha6",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 112,
    "state": "closed",
    "created_at": "2023-03-07T18:05:13Z",
    "updated_at": "2023-05-11T07:01:41Z",
    "due_on": null,
    "closed_at": "2023-03-15T12:48:12Z"
  },
  "comments": 3,
  "created_at": "2023-02-16T22:06:14Z",
  "updated_at": "2023-03-11T11:30:48Z",
  "closed_at": "2023-03-11T11:30:40Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nWith Quarkus 3.0.0.Alpha4 deploying app using OpenShift extension started to fail. I think it's down to changes in https://github.com/quarkusio/quarkus/pull/30480.\r\n\r\n### Expected behavior\r\n\r\nApp is deployed to OC.\r\n\r\n### Actual behavior\r\n\r\nApp is never deployed. Example from log:\r\n```bash\r\n[INFO] --- quarkus-maven-plugin:3.0.0.Alpha4:build (default) @ code-with-quarkus ---\r\n[INFO] [io.quarkus.kubernetes.deployment.KubernetesDeployer] Selecting target 'openshift' since it has the highest priority among the implicitly enabled deployment targets\r\n[WARNING] [io.netty.resolver.dns.DefaultDnsServerAddressStreamProvider] Default DNS servers: [/[2001:4860:4860:0:0:0:0:8888]:53, /[2001:4860:4860:0:0:0:0:8844]:53] (Google Public DNS as a fallback)\r\n[WARNING] There are multiple httpclient implementation in the classpath, choosing the first non-default implementation. You should exclude dependencies that aren't needed or use an explicit association of the HttpClient.Factory.\r\n[INFO] [io.quarkus.kubernetes.deployment.KubernetesDeploy] Kubernetes API Server at 'https://api.ocp4-12.dynamic.quarkus:6443/' successfully contacted.\r\n[INFO] [io.quarkus.container.image.openshift.deployment.OpenshiftProcessor] Starting (in-cluster) container image build for jar using: BINARY on server: https://api.ocp4-12.dynamic.quarkus:6443/ in namespace:mvavrik-oc-debug.\r\n[INFO] [io.quarkus.kubernetes.deployment.KubernetesDeploy] Kubernetes API Server at 'https://api.ocp4-12.dynamic.quarkus:6443/' successfully contacted.\r\n[INFO] [io.quarkus.kubernetes.deployment.KubernetesDeploy] Kubernetes API Server at 'https://api.ocp4-12.dynamic.quarkus:6443/' successfully contacted.\r\n[INFO] [io.quarkus.kubernetes.deployment.KubernetesDeploy] Kubernetes API Server at 'https://api.ocp4-12.dynamic.quarkus:6443/' successfully contacted.\r\n[INFO] [io.quarkus.container.image.openshift.deployment.OpenshiftProcessor] Applied: ImageStream code-with-quarkus\r\n[INFO] [io.quarkus.container.image.openshift.deployment.OpenshiftProcessor] Applied: ImageStream openjdk-17\r\n[INFO] [io.quarkus.container.image.openshift.deployment.OpenshiftProcessor] Applied: BuildConfig code-with-quarkus\r\n[ERROR] Failed to upload archive file for the build: code-with-quarkus\r\n[ERROR] Please check cluster events via `oc get events` to see what could have possibly gone wrong\r\n[WARNING] [io.quarkus.container.image.openshift.deployment.OpenshiftProcessor] An exception: 'Can't instantiate binary build, due to error reading/writing stream. Can be caused if the output stream was closed by the server.See if something's wrong in recent events in Cluster = Created code-with-quarkus-1-build.17446c87676bc8ce Created container git-clone\r\nStarted code-with-quarkus-1-build.17446c87697c5835 Started container git-clone\r\nBuildStarted code-with-quarkus-1.17446c8777a66cf1 Build mvavrik-oc-debug/code-with-quarkus-1 is now running\r\nAddedInterface code-with-quarkus-1-build.17446c87544c7074 Add eth0 [10.128.2.148/23] from openshift-sdn\r\nPulled code-with-quarkus-1-build.17446c8758613563 Container image \"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:91496407bea46c76443337eb7fb54aa9ddf9f69856940c2d5ec1df4220d0f8fb\" already present on machine\r\nScheduled code-with-quarkus-1-build.17446c86f2deaad7 Successfully assigned mvavrik-oc-debug/code-with-quarkus-1-build to ocp4-12-mbq2m-worker-0-hhl9f\r\n ' occurred while instantiating the build, however the build has been started.\r\n[INFO] [io.quarkus.container.image.openshift.deployment.OpenshiftProcessor] Receiving source from STDIN as archive ...\r\n[INFO] [io.quarkus.container.image.openshift.deployment.OpenshiftProcessor] error: unable to extract binary build input, must be a zip, tar, or gzipped tar, or specified as a file: exit status 1\r\n\r\n```\r\n\r\n### How to Reproduce?\r\n\r\nSteps to reproduce the behavior:\r\n- _prerequisite: OC stuff_\r\n1. Create app with Resteasy and Openshift extensions, f.e. download here https://code.quarkus.io/d?e=resteasy&e=openshift&S=io.quarkus.platform%3A3.0&cn=code.quarkus.io\r\n2. Add following properties to application.properties \r\n```\r\nquarkus.kubernetes.deploy=true\r\nquarkus.openshift.route.expose=true\r\nquarkus.kubernetes-client.trust-certs=true\r\n```\r\n4. `mvn clean verify`\r\n\r\n### Output of `uname -a` or `ver`\r\n\r\nLinux\r\n\r\n### Output of `java -version`\r\n\r\nOpenJDK Runtime Environment Temurin-17.0.5+8 (build 17.0.5+8)\r\n\r\n### GraalVM version (if different from Java)\r\n\r\n22.3\r\n\r\n### Quarkus version or git rev\r\n\r\n3.0.0.Alpha4 & 999-SNAPSHOT\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\nApache Maven 3.8.6\r\n\r\n### Additional information\r\n\r\nOpenShift 4.12 (Kubernetes version v1.25.4+77bec7a)",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/31228/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/31228/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
