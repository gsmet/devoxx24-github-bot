{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/22520",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/22520/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/22520/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/22520/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/22520",
  "id": 1088555450,
  "node_id": "I_kwDOCFbutM5A4gm6",
  "number": 22520,
  "title": "quarkus extensions do not support the yaml configurations and expect in application.properties",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": null,
  "comments": 9,
  "created_at": "2021-12-25T06:27:53Z",
  "updated_at": "2022-01-21T03:04:07Z",
  "closed_at": "2022-01-21T03:04:05Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nquarkus extenstions do not pick up the required configurations from yaml file might be a issue with extensions built without yaml support.\r\n========\r\nI have added the details to provide a simple use case. Refer to the reproduction guidelines.\r\nsrc/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.dbName()\r\nsrc/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.transactionManager()src/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.dbName()\r\n\r\nFull Error Logs:\r\n==\r\n/Library/Java/JavaVirtualMachines/graalvm-ce-java17-21.3.0/Contents/Home/bin/java -Dmaven.multiModuleProjectDirectory=/Volumes/Doogle SSD/projects/quarkus-yaml-extention-error -Dmaven.home=/Users/debabratapatnaik/.m2/wrapper/dists/apache-maven-3.8.4-bin/52ccbt68d252mdldqsfsn03jlf/apache-maven-3.8.4 -Didea.modules.paths.file=/Users/debabratapatnaik/Library/Caches/JetBrains/IntelliJIdea2021.3/Maven/idea-projects-state-be694b37.properties -Dclassworlds.conf=/private/var/folders/rg/l63fx9xn60gbt247cmz31ps80000gn/T/idea-7-mvn.conf -javaagent:/Volumes/Doogle SSD/Applications/IntelliJ IDEA.app/Contents/lib/idea_rt.jar=57145:/Volumes/Doogle SSD/Applications/IntelliJ IDEA.app/Contents/bin -Dfile.encoding=UTF-8 -classpath /Users/debabratapatnaik/.m2/wrapper/dists/apache-maven-3.8.4-bin/52ccbt68d252mdldqsfsn03jlf/apache-maven-3.8.4/boot/plexus-classworlds.license:/Users/debabratapatnaik/.m2/wrapper/dists/apache-maven-3.8.4-bin/52ccbt68d252mdldqsfsn03jlf/apache-maven-3.8.4/boot/plexus-classworlds-2.6.0.jar org.codehaus.classworlds.Launcher -Didea.version=2021.3 quarkus:dev\r\n[INFO] Scanning for projects...\r\n[INFO] \r\n[INFO] --------------< org.doogle:quarkus-yaml-extention-error >---------------\r\n[INFO] Building quarkus-yaml-extention-error 1.0.0-SNAPSHOT\r\n[INFO] --------------------------------[ jar ]---------------------------------\r\n[INFO] \r\n[INFO] --- quarkus-maven-plugin:2.5.4.Final:dev (default-cli) @ quarkus-yaml-extention-error ---\r\n[INFO] Invoking org.apache.maven.plugins:maven-resources-plugin:2.6:resources) @ quarkus-yaml-extention-error\r\n[INFO] Using 'UTF-8' encoding to copy filtered resources.\r\n[INFO] Copying 2 resources\r\n[INFO] Invoking io.quarkus.platform:quarkus-maven-plugin:2.5.4.Final:generate-code) @ quarkus-yaml-extention-error\r\n[INFO] Invoking org.apache.maven.plugins:maven-compiler-plugin:3.8.1:compile) @ quarkus-yaml-extention-error\r\n[INFO] Changes detected - recompiling the module!\r\n[INFO] Compiling 1 source file to /Volumes/Doogle SSD/projects/quarkus-yaml-extention-error/target/classes\r\n[INFO] Invoking org.apache.maven.plugins:maven-resources-plugin:2.6:testResources) @ quarkus-yaml-extention-error\r\n[INFO] Using 'UTF-8' encoding to copy filtered resources.\r\n[INFO] skip non existing resourceDirectory /Volumes/Doogle SSD/projects/quarkus-yaml-extention-error/src/test/resources\r\n[INFO] Invoking io.quarkus.platform:quarkus-maven-plugin:2.5.4.Final:generate-code-tests) @ quarkus-yaml-extention-error\r\n[INFO] Invoking org.apache.maven.plugins:maven-compiler-plugin:3.8.1:testCompile) @ quarkus-yaml-extention-error\r\n[INFO] No sources to compile\r\nListening for transport dt_socket at address: 5005\r\nPress [h] for more options>\r\nTests paused\r\nPress [r] to resume testing, [h] for more options>\r\nPress [r] to resume testing, [o] Toggle test output, [h] for more options>\r\n2021-12-25 11:39:16,208 INFO  [org.kie.kog.cod.api.uti.AddonsConfigDiscovery] (build-22) Performed addonsConfig discovery, found: AddonsConfig{usePersistence=true, useTracing=false, useMonitoring=false, usePrometheusMonitoring=false, useCloudEvents=false, useExplainability=false, useProcessSVG=false, useEventDrivenDecisions=false, useEventDrivenRules=false}\r\n2021-12-25 11:39:16,422 INFO  [org.kie.kog.cod.cor.uti.ApplicationGeneratorDiscovery] (build-22) Generator discovery performed, found [openapispecs, processes, rules, decisions, predictions]\r\n2021-12-25 11:39:16,426 INFO  [org.kie.kog.cod.cor.ApplicationGenerator] (build-22) Skipping generator 'openapispecs' because disabled\r\n2021-12-25 11:39:16,427 INFO  [org.kie.kog.cod.cor.ApplicationGenerator] (build-22) Skipping generator 'processes' because disabled\r\n2021-12-25 11:39:16,429 INFO  [org.kie.kog.cod.cor.ApplicationGenerator] (build-22) Skipping generator 'decisions' because disabled\r\n2021-12-25 11:39:16,429 INFO  [org.kie.kog.cod.cor.ApplicationGenerator] (build-22) Skipping generator 'predictions' because disabled\r\n2021-12-25 11:39:17,530 INFO  [org.kie.kog.cod.api.uti.AddonsConfigDiscovery] (build-45) Performed addonsConfig discovery, found: AddonsConfig{usePersistence=true, useTracing=false, useMonitoring=false, usePrometheusMonitoring=false, useCloudEvents=false, useExplainability=false, useProcessSVG=false, useEventDrivenDecisions=false, useEventDrivenRules=false}\r\n\r\n**2021-12-25 11:39:17,729 ERROR [org.kie.kog.qua.com.dep.InMemoryCompiler] (build-45) src/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.transactionManager()**\r\n**2021-12-25 11:39:17,730 ERROR [org.kie.kog.qua.com.dep.InMemoryCompiler] (build-45) src/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.dbName()**\r\n==\r\n\r\n2021-12-25 11:39:17,751 INFO  [io.qua.dep.dev.IsolatedDevModeMain] (main) Attempting to start live reload endpoint to recover from previous Quarkus startup failure\r\n2021-12-25 11:39:17,922 INFO  [org.jbo.threads] (main) JBoss Threads version 3.4.2.Final\r\n2021-12-25 11:39:18,371 ERROR [io.qua.dep.dev.IsolatedDevModeMain] (main) Failed to start quarkus: java.lang.RuntimeException: io.quarkus.builder.BuildException: Build failure: Build failed due to errors\r\n\t[error]: Build step org.kie.kogito.quarkus.processes.deployment.ProcessesAssetsProcessor#postGenerationProcessing threw an exception: java.lang.IllegalStateException: src/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.transactionManager()\r\nsrc/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.dbName()\r\nsrc/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.transactionManager()src/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.dbName()\r\n\tat org.kie.kogito.quarkus.common.deployment.InMemoryCompiler.compile(InMemoryCompiler.java:104)\r\n\tat org.kie.kogito.quarkus.common.deployment.KogitoQuarkusResourceUtils.compileGeneratedSources(KogitoQuarkusResourceUtils.java:168)\r\n\tat org.kie.kogito.quarkus.processes.deployment.ProcessesAssetsProcessor.generatePersistenceInfo(ProcessesAssetsProcessor.java:203)\r\n\tat org.kie.kogito.quarkus.processes.deployment.ProcessesAssetsProcessor.postGenerationProcessing(ProcessesAssetsProcessor.java:165)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:568)\r\n\tat io.quarkus.deployment.ExtensionLoader$2.execute(ExtensionLoader.java:887)\r\n\tat io.quarkus.builder.BuildContext.run(BuildContext.java:277)\r\n\tat org.jboss.threads.ContextHandler$1.runWith(ContextHandler.java:18)\r\n\tat org.jboss.threads.EnhancedQueueExecutor$Task.run(EnhancedQueueExecutor.java:2449)\r\n\tat org.jboss.threads.EnhancedQueueExecutor$ThreadBody.run(EnhancedQueueExecutor.java:1478)\r\n\tat java.base/java.lang.Thread.run(Thread.java:833)\r\n\tat org.jboss.threads.JBossThread.run(JBossThread.java:501)\r\n\r\n\tat io.quarkus.runner.bootstrap.AugmentActionImpl.runAugment(AugmentActionImpl.java:330)\r\n\tat io.quarkus.runner.bootstrap.AugmentActionImpl.createInitialRuntimeApplication(AugmentActionImpl.java:252)\r\n\tat io.quarkus.runner.bootstrap.AugmentActionImpl.createInitialRuntimeApplication(AugmentActionImpl.java:60)\r\n\tat io.quarkus.deployment.dev.IsolatedDevModeMain.firstStart(IsolatedDevModeMain.java:93)\r\n\tat io.quarkus.deployment.dev.IsolatedDevModeMain.accept(IsolatedDevModeMain.java:456)\r\n\tat io.quarkus.deployment.dev.IsolatedDevModeMain.accept(IsolatedDevModeMain.java:67)\r\n\tat io.quarkus.bootstrap.app.CuratedApplication.runInCl(CuratedApplication.java:149)\r\n\tat io.quarkus.bootstrap.app.CuratedApplication.runInAugmentClassLoader(CuratedApplication.java:105)\r\n\tat io.quarkus.deployment.dev.DevModeMain.start(DevModeMain.java:145)\r\n\tat io.quarkus.deployment.dev.DevModeMain.main(DevModeMain.java:63)\r\nCaused by: io.quarkus.builder.BuildException: Build failure: Build failed due to errors\r\n\t[error]: Build step org.kie.kogito.quarkus.processes.deployment.ProcessesAssetsProcessor#postGenerationProcessing threw an exception: java.lang.IllegalStateException: src/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.transactionManager()\r\nsrc/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.dbName()\r\nsrc/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.transactionManager()src/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.dbName()\r\n\tat org.kie.kogito.quarkus.common.deployment.InMemoryCompiler.compile(InMemoryCompiler.java:104)\r\n\tat org.kie.kogito.quarkus.common.deployment.KogitoQuarkusResourceUtils.compileGeneratedSources(KogitoQuarkusResourceUtils.java:168)\r\n\tat org.kie.kogito.quarkus.processes.deployment.ProcessesAssetsProcessor.generatePersistenceInfo(ProcessesAssetsProcessor.java:203)\r\n\tat org.kie.kogito.quarkus.processes.deployment.ProcessesAssetsProcessor.postGenerationProcessing(ProcessesAssetsProcessor.java:165)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:568)\r\n\tat io.quarkus.deployment.ExtensionLoader$2.execute(ExtensionLoader.java:887)\r\n\tat io.quarkus.builder.BuildContext.run(BuildContext.java:277)\r\n\tat org.jboss.threads.ContextHandler$1.runWith(ContextHandler.java:18)\r\n\tat org.jboss.threads.EnhancedQueueExecutor$Task.run(EnhancedQueueExecutor.java:2449)\r\n\tat org.jboss.threads.EnhancedQueueExecutor$ThreadBody.run(EnhancedQueueExecutor.java:1478)\r\n\tat java.base/java.lang.Thread.run(Thread.java:833)\r\n\tat org.jboss.threads.JBossThread.run(JBossThread.java:501)\r\n\r\n\tat io.quarkus.builder.Execution.run(Execution.java:116)\r\n\tat io.quarkus.builder.BuildExecutionBuilder.execute(BuildExecutionBuilder.java:79)\r\n\tat io.quarkus.deployment.QuarkusAugmentor.run(QuarkusAugmentor.java:161)\r\n\tat io.quarkus.runner.bootstrap.AugmentActionImpl.runAugment(AugmentActionImpl.java:328)\r\n\t... 9 more\r\nCaused by: java.lang.IllegalStateException: src/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.transactionManager()\r\nsrc/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.dbName()\r\nsrc/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.transactionManager()src/main/java/org/kie/kogito/persistence/KogitoProcessInstancesFactoryImpl.java (4:96) : The type KogitoProcessInstancesFactoryImpl must implement the inherited abstract method KogitoProcessInstancesFactory.dbName()\r\n\tat org.kie.kogito.quarkus.common.deployment.InMemoryCompiler.compile(InMemoryCompiler.java:104)\r\n\tat org.kie.kogito.quarkus.common.deployment.KogitoQuarkusResourceUtils.compileGeneratedSources(KogitoQuarkusResourceUtils.java:168)\r\n\tat org.kie.kogito.quarkus.processes.deployment.ProcessesAssetsProcessor.generatePersistenceInfo(ProcessesAssetsProcessor.java:203)\r\n\tat org.kie.kogito.quarkus.processes.deployment.ProcessesAssetsProcessor.postGenerationProcessing(ProcessesAssetsProcessor.java:165)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:568)\r\n\tat io.quarkus.deployment.ExtensionLoader$2.execute(ExtensionLoader.java:887)\r\n\tat io.quarkus.builder.BuildContext.run(BuildContext.java:277)\r\n\tat org.jboss.threads.ContextHandler$1.runWith(ContextHandler.java:18)\r\n\tat org.jboss.threads.EnhancedQueueExecutor$Task.run(EnhancedQueueExecutor.java:2449)\r\n\tat org.jboss.threads.EnhancedQueueExecutor$ThreadBody.run(EnhancedQueueExecutor.java:1478)\r\n\tat java.base/java.lang.Thread.run(Thread.java:833)\r\n\tat org.jboss.threads.JBossThread.run(JBossThread.java:501)\r\n\r\n\r\n\r\n### Expected behavior\r\n\r\nSHOULD WORK WITH YAML CONFIGS\r\n==\r\nWIth Yaml support in main apps all extensions should provide support to yml files and should not be hardwired to properties file only. \r\n\r\n\r\n### Actual behavior\r\n\r\nNOT WORKING IF APPLICATION.PROPERTIES IS MISSING\r\n==\r\nIf missing application.properties file application should scan application.yml internally makes the extensions register properly.\r\n\r\n### How to Reproduce?\r\n\r\nReproducer:\r\n===\r\nSteps to reproduce the error:\r\n\r\n1. **git clone https://github.com/debu999/quarkus-yaml-extention-error.git**\r\n    or **gh repo clone debu999/quarkus-yaml-extention-error**\r\n2. git checkout working/withproperties\r\n3. mvn clean compile quarkus:dev\r\n4. delete the target folder if needed\r\n5. git checkout bug/withoutproperties\r\n6. mvn clean compile quarkus:dev\r\n7. you will see the error must implement the inherited abstract method KogitoProcessInstancesFactory.dbName()...\r\n   \r\n![Screenshot 2021-12-25 at 11 54 23 AM](https://user-images.githubusercontent.com/1910577/147378931-671fc346-dc04-42f7-856b-eacc18e3f439.png)\r\n\r\n\r\n\r\n### Output of `uname -a` or `ver`\r\n\r\nDarwin DEBABRATAs-Mini.bbrouter 20.6.0 Darwin Kernel Version 20.6.0: Wed Jun 23 00:26:27 PDT 2021; root:xnu-7195.141.2~5/RELEASE_ARM64_T8101 arm64\r\n\r\n### Output of `java -version`\r\n\r\nopenjdk version \"17.0.1\" 2021-10-19 OpenJDK Runtime Environment GraalVM CE 21.3.0 (build 17.0.1+12-jvmci-21.3-b05) OpenJDK 64-Bit Server VM GraalVM CE 21.3.0 (build 17.0.1+12-jvmci-21.3-b05, mixed mode, sharing)\r\n\r\n### GraalVM version (if different from Java)\r\n\r\n_No response_\r\n\r\n### Quarkus version or git rev\r\n\r\n2.5.4.Final\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\nApache Maven 3.8.4 (9b656c72d54e5bacbed989b64718c159fe39b537) Maven home: /Users/debabratapatnaik/.m2/wrapper/dists/apache-maven-3.8.4-bin/52ccbt68d252mdldqsfsn03jlf/apache-maven-3.8.4 Java version: 17.0.1, vendor: GraalVM Community, runtime: /Library/Java/JavaVirtualMachines/graalvm-ce-java17-21.3.0/Contents/Home Default locale: en_IN, platform encoding: US-ASCII OS name: \"mac os x\", version: \"11.5.2\", arch: \"x86_64\", family: \"mac\"\r\n\r\n### Additional information\r\n\r\nthis is mostly because of the fact the extensions are built without yaml support and cant get data from application.yml or applicatoin-{PROFILE}.yml and looks only at application.properties file.\r\n\r\nIts worth to look at if quarkus profiles cascade to extensions correctly or they need everything in application.properties file.\r\nMay be a one off for kogito-persistence-mongo but worth a shot to have this made consistent to all addons or extensions\r\n![Screenshot 2021-12-25 at 11 54 23 AM](https://user-images.githubusercontent.com/1910577/147378923-06780c47-5459-4bda-af36-957646472dbd.png)\r\n.",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/22520/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/22520/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
