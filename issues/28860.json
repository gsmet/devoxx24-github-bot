{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/28860",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/28860/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/28860/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/28860/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/28860",
  "id": 1424113656,
  "node_id": "I_kwDOCFbutM5U4j_4",
  "number": 28860,
  "title": "CSRF Security Token HMAC signature",
  "labels": [
    {
      "id": 1282139374,
      "node_id": "MDU6TGFiZWwxMjgyMTM5Mzc0",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/security",
      "name": "area/security",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/214",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/214",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/214/labels",
    "id": 8581813,
    "node_id": "MI_kwDOCFbutM4AgvK1",
    "number": 214,
    "title": "2.15.0.CR1",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 194,
    "state": "closed",
    "created_at": "2022-10-26T07:03:06Z",
    "updated_at": "2023-05-15T13:57:18Z",
    "due_on": null,
    "closed_at": "2022-11-30T12:45:37Z"
  },
  "comments": 0,
  "created_at": "2022-10-26T14:15:31Z",
  "updated_at": "2022-11-15T12:13:21Z",
  "closed_at": "2022-11-15T12:13:18Z",
  "active_lock_reason": null,
  "body": "### Discussed in https://github.com/quarkusio/quarkus/discussions/28859\r\n\r\n<div type='discussions-op-text'>\r\n\r\n<sup>Originally posted by **rafaelszp** October 26, 2022</sup>\r\nAs pointed out in google groups discussion, the point to this request is to suggest that token generation/validation based on SecureRandom/token-size should be replaced by HMAC, according to \"Double submit cookie\" with HMAC technique recommended by OWASP.\r\n\r\nThe motive behind this request is because I could generate a token with repeated letters(regarding the token size) causing the token to be validated, which is an unexpected behaviour. \r\nHere its the request I made using the example provided by  the guide:\r\n```\r\n  > POST /service/csrfTokenForm HTTP/1.1\r\n  > Host: localhost:8080\r\n  > User-Agent: insomnia/2021.1.0\r\n  > Content-Type: application/x-www-form-urlencoded\r\n  > Cookie: csrf-token=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\r\n  > Accept: */*\r\n  > Content-Length: 109\r\n  \r\n  | csrf-token=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&name=rafael\r\n  \r\n  * upload completely sent off: 109 out of 109 bytes\r\n  * Mark bundle as not supporting multiuse\r\n  \r\n  < HTTP/1.1 200 OK\r\n  < content-length: 6\r\n  < Content-Type: text/plain;charset=UTF-8\r\n```\r\nThe repeated letters a's should'nt be valid, that's why I'd like to suggest to optionally creating an HMAC signature of the token and storing it as the cookie. This way the attacker could not generate the token value without the secret stored inside the server.</div>",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/28860/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/28860/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
