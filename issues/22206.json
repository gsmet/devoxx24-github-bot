{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/22206",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/22206/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/22206/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/22206/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/22206",
  "id": 1079950424,
  "node_id": "I_kwDOCFbutM5AXrxY",
  "number": 22206,
  "title": "Make sure `smallrye-jwt` and OIDC `web-app` mechanisms can align",
  "labels": [
    {
      "id": 985346622,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjI=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/enhancement",
      "name": "kind/enhancement",
      "color": "a2eeef",
      "default": false,
      "description": "New feature or request"
    },
    {
      "id": 1282139374,
      "node_id": "MDU6TGFiZWwxMjgyMTM5Mzc0",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/security",
      "name": "area/security",
      "color": "0366d6",
      "default": false,
      "description": ""
    },
    {
      "id": 1283619446,
      "node_id": "MDU6TGFiZWwxMjgzNjE5NDQ2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/smallrye",
      "name": "area/smallrye",
      "color": "0366d6",
      "default": false,
      "description": ""
    },
    {
      "id": 1479557456,
      "node_id": "MDU6TGFiZWwxNDc5NTU3NDU2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/oidc",
      "name": "area/oidc",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/171",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/171",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/171/labels",
    "id": 7587967,
    "node_id": "MI_kwDOCFbutM4Ac8h_",
    "number": 171,
    "title": "2.8.0.CR1",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 371,
    "state": "closed",
    "created_at": "2022-01-19T09:05:12Z",
    "updated_at": "2023-02-21T15:11:02Z",
    "due_on": null,
    "closed_at": "2022-03-23T12:37:30Z"
  },
  "comments": 1,
  "created_at": "2021-12-14T16:15:05Z",
  "updated_at": "2022-02-07T10:47:53Z",
  "closed_at": "2022-02-07T10:47:49Z",
  "active_lock_reason": null,
  "body": "### Description\r\n\r\nRight now `quarkus-oidc` returns `Authorization:Bearer` in its `getCredentialTransport` so if both `smallrye-jwt` and `quarkus-oidc` are added the conflict is reported which makes sense if both need to deal with a bearer token.\r\nBut `quarkus-oidc` also supports a code flow and this where the users having problems when they need to combine OIDC `web-app` and for example the cookie based JWT support provided by `smallrye-jwt`/etc, a few users have reported a problem and Stephane @FroMage has also had this problem.\r\n\r\n### Implementation ideas\r\n\r\n@stuartwdouglas, It can be very dynamic in `OIDC`, one tenant may be `service`, next one `web-app`.\r\n\r\nMy proposal is to replace a no-arg `getCredentialTransport` and add the one accepting `RoutingContext` (for `quarkus-oidc` to return the tenant specific transport, bearer or location header), avoid failing when multiple matching mechanisms exist at the init time, and only fail during the request if more than one equal candidate exists with the same cred type - this will still ensure `quarkus-oidc` and `smallrye-jwt` conflict for bearer tokens but will work OK for `smallrye-jwt` and `oidc web-app`.\r\n\r\n",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/22206/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/22206/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
