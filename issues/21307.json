{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/21307",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/21307/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/21307/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/21307/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/21307",
  "id": 1048496854,
  "node_id": "I_kwDOCFbutM4-fsrW",
  "number": 21307,
  "title": "Form based Authentication and LDAP not working",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1282139374,
      "node_id": "MDU6TGFiZWwxMjgyMTM5Mzc0",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/security",
      "name": "area/security",
      "color": "0366d6",
      "default": false,
      "description": ""
    },
    {
      "id": 1676631606,
      "node_id": "MDU6TGFiZWwxNjc2NjMxNjA2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/env/windows",
      "name": "env/windows",
      "color": "edea47",
      "default": false,
      "description": "Impacts Windows machines"
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/157",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/157",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/157/labels",
    "id": 7320620,
    "node_id": "MI_kwDOCFbutM4Ab7Qs",
    "number": 157,
    "title": "2.4.2.Final",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 40,
    "state": "closed",
    "created_at": "2021-11-03T11:17:28Z",
    "updated_at": "2021-11-25T07:41:47Z",
    "due_on": null,
    "closed_at": "2021-11-12T08:45:43Z"
  },
  "comments": 0,
  "created_at": "2021-11-09T11:30:45Z",
  "updated_at": "2021-11-15T19:55:39Z",
  "closed_at": "2021-11-10T09:19:45Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nI`m trying to authenticate the users using form based and LDAP. \r\n\r\nWhen I configure the app to use Basic authentication everything works as expected\r\n_quarkus.http.auth.form.enabled=false\r\nquarkus.http.auth.basic=true_\r\n\r\nBut when I try to use form authentication _quarkus.http.auth.form.enabled=true_ \r\nafter send the credentials from the login page its possible to see in the logs that the  authentication process is nearly the same but ended up with the following error:\r\n\r\n`java.lang.IllegalArgumentException: Parameter 'credential' may not be null at org.wildfly.common.Assert.checkNotNullParamChecked(Assert.java:71) at org.wildfly.common.Assert.checkNotNullParam(Assert.java:49) at org.wildfly.security.auth.server.ServerAuthenticationContext.addPrivateCredential(ServerAuthenticationContext.java:798) at io.quarkus.elytron.security.runtime.ElytronTrustedIdentityProvider$1.get(ElytronTrustedIdentityProvider.java:55) at io.quarkus.elytron.security.runtime.ElytronTrustedIdentityProvider$1.get(ElytronTrustedIdentityProvider.java:43) at io.quarkus.security.runtime.QuarkusIdentityProviderManagerImpl$1$1$1$1.run(QuarkusIdentityProviderManagerImpl.java:58) at io.quarkus.vertx.core.runtime.VertxCoreRecorder$13.runWith(VertxCoreRecorder.java:543) at org.jboss.threads.EnhancedQueueExecutor$Task.run(EnhancedQueueExecutor.java:2449) at org.jboss.threads.EnhancedQueueExecutor$ThreadBody.run(EnhancedQueueExecutor.java:1478) at org.jboss.threads.DelegatingRunnable.run(DelegatingRunnable.java:29) at org.jboss.threads.ThreadLocalResettingRunnable.run(ThreadLocalResettingRunnable.java:29) at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) at java.base/java.lang.Thread.run(Thread.java:832)`\n\n### Expected behavior\n\nWe expect that the authentication process occours on the same way as basic authentication\n\n### Actual behavior\n\nAfter the credentials are sent and authenticated against LDAP the following error is thrown\r\nand the the page or resource is not reached.\r\n\r\n `java.lang.IllegalArgumentException: Parameter 'credential' may not be null at org.wildfly.common.Assert.checkNotNullParamChecked(Assert.java:71) at org.wildfly.common.Assert.checkNotNullParam(Assert.java:49) at org.wildfly.security.auth.server.ServerAuthenticationContext.addPrivateCredential(ServerAuthenticationContext.java:798) at io.quarkus.elytron.security.runtime.ElytronTrustedIdentityProvider$1.get(ElytronTrustedIdentityProvider.java:55) at io.quarkus.elytron.security.runtime.ElytronTrustedIdentityProvider$1.get(ElytronTrustedIdentityProvider.java:43) at io.quarkus.security.runtime.QuarkusIdentityProviderManagerImpl$1$1$1$1.run(QuarkusIdentityProviderManagerImpl.java:58) at io.quarkus.vertx.core.runtime.VertxCoreRecorder$13.runWith(VertxCoreRecorder.java:543) at org.jboss.threads.EnhancedQueueExecutor$Task.run(EnhancedQueueExecutor.java:2449) at org.jboss.threads.EnhancedQueueExecutor$ThreadBody.run(EnhancedQueueExecutor.java:1478) at org.jboss.threads.DelegatingRunnable.run(DelegatingRunnable.java:29) at org.jboss.threads.ThreadLocalResettingRunnable.run(ThreadLocalResettingRunnable.java:29) at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) at java.base/java.lang.Thread.run(Thread.java:832)`\n\n### How to Reproduce?\n\nReporducer:\r\n\r\n1. enable LDAP authentication\r\n2. enable form authentication\r\n3. create a login.html page \r\n4. login with a valid user on the login page\r\n5. the error will be in the screen\r\n\r\nI`ve created a repository with a example :\r\nhttps://github.com/hikemachado/quarkus-ldap-quickstart\r\n\r\neverything is pre-configured\r\njust need to run mvnw quarkus:dev\r\n\r\n\r\n\n\n### Output of `uname -a` or `ver`\n\nOS:               Microsoft Windows 10 Pro,  version:             10.0.19042 \n\n### Output of `java -version`\n\njava version \"11.0.3\" 2019-04-16 LTS Java(TM) SE Runtime Environment 18.9 (build 11.0.3+12-LTS) Java HotSpot(TM) 64-Bit Server VM 18.9 (build 11.0.3+12-LTS, mixed mode)\n\n### GraalVM version (if different from Java)\n\nnot used\n\n### Quarkus version or git rev\n\n2.4.1.Final\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\nApache Maven 3.6.3 (cecedd343002696d0abb50b32b541b8a6ba2883f)\n\n### Additional information\n\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/21307/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/21307/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
