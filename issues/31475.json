{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/31475",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/31475/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/31475/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/31475/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/31475",
  "id": 1602993564,
  "node_id": "I_kwDOCFbutM5fi72c",
  "number": 31475,
  "title": "Configuration property to work with database schemas generated for Hibernate ORM 5.6",
  "labels": [
    {
      "id": 985346622,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjI=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/enhancement",
      "name": "kind/enhancement",
      "color": "a2eeef",
      "default": false,
      "description": "New feature or request"
    },
    {
      "id": 1273026509,
      "node_id": "MDU6TGFiZWwxMjczMDI2NTA5",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/persistence",
      "name": "area/persistence",
      "color": "FBCA04",
      "default": false,
      "description": "OBSOLETE, DO NOT USE"
    },
    {
      "id": 1425555736,
      "node_id": "MDU6TGFiZWwxNDI1NTU1NzM2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/hibernate-orm",
      "name": "area/hibernate-orm",
      "color": "0366d6",
      "default": false,
      "description": "Hibernate ORM"
    },
    {
      "id": 3941059466,
      "node_id": "LA_kwDOCFbutM7q58uK",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/jakarta",
      "name": "area/jakarta",
      "color": "0366d6",
      "default": false,
      "description": ""
    },
    {
      "id": 5080736243,
      "node_id": "LA_kwDOCFbutM8AAAABLtXh8w",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/triage/quarkus-3",
      "name": "triage/quarkus-3",
      "color": "BA41B2",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/235",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/235",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/235/labels",
    "id": 9025446,
    "node_id": "MI_kwDOCFbutM4Aibem",
    "number": 235,
    "title": "3.0.0.Alpha5",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 253,
    "state": "closed",
    "created_at": "2023-02-09T14:26:03Z",
    "updated_at": "2023-11-12T17:44:08Z",
    "due_on": null,
    "closed_at": "2023-03-08T15:10:59Z"
  },
  "comments": 5,
  "created_at": "2023-02-28T12:37:53Z",
  "updated_at": "2024-01-22T09:25:20Z",
  "closed_at": "2023-03-06T07:12:18Z",
  "active_lock_reason": null,
  "body": "### Description\r\n\r\nHibernate ORM 6 changes a few defaults regarding database schemas, and that could be a problem for pre-existing applications that migrate to Quarkus 3 + ORM 6.\r\n\r\nWe need to add a unique, per-PU property that would switch several configuration properties to their \"legacy\" value so that Hibernate ORM 6 continues to work with those \"legacy\" database schemas.\r\n\r\nIdeally, those configuration properties should be overrideable through `quarkus.hibernate-orm.unsupported-properties`, so that people can iterate when migrating.\r\n\r\nThe exact list of properties set by that will be automatically overridden needs to be documented somewhere; though I believe a link to the source would be enough, if the source is a single class that is focused only on this overriding and isn't overly complex.\r\n\r\n### Implementation ideas\r\n\r\nE.g.:\r\n\r\n```\r\nquarkus.hibernate-orm.schema.compatibility = 5.6\r\n```\r\n\r\n### Limitations\r\n\r\nFor now, we will have a global property for all persistence units but that seems like an acceptable limitation.\r\n\r\nThis compatibility property is specifically about the database schema. It doesn't improve the compatibility for annotations and API changes.\r\n\r\n### List of compatibility issues\r\n\r\n- [x] [Sequences](https://github.com/hibernate/hibernate-orm/blob/6.0/migration-guide.adoc#implicit-identifier-sequence-and-table-name): - we need to set it to `legacy` to use `hibernate_sequence` by default\r\n- [x] [Duration mapping changes](https://github.com/hibernate/hibernate-orm/blob/6.0/migration-guide.adoc#duration-mapping-changes) \r\n- [x] [UUID mapping changes](https://github.com/hibernate/hibernate-orm/blob/6.0/migration-guide.adoc#uuid-mapping-changes):  **AND** [mariadb](https://github.com/hibernate/hibernate-orm/blob/6.2/migration-guide.adoc#uuid-mapping-changes-on-mariadb) **AND** [sql-server](https://github.com/hibernate/hibernate-orm/blob/6.2/migration-guide.adoc#uuid-mapping-changes-on-sql-server)\r\n- [x] [Instant mapping changes](https://github.com/hibernate/hibernate-orm/blob/6.0/migration-guide.adoc#instant-mapping-changes)\r\n- [ ] [Basic array/collection mapping](https://github.com/hibernate/hibernate-orm/blob/6.1/migration-guide.adoc#basic-arraycollection-mapping):  we are still undecided of if we want to do something here. It is not high priority: people can annotate their properties to work around the problem and it should not be very common\r\n- [x] [Enum mapping changes](https://github.com/hibernate/hibernate-orm/blob/6.1/migration-guide.adoc#enum-mapping-changes ) - Christian said it should be backward compatible\r\n- [x] [Datatype for enums](https://github.com/hibernate/hibernate-orm/blob/6.2/migration-guide.adoc#datatype-for-enums ): Christian said it should be backward compatible\r\n- [x] [Timezone and offset storage](https://github.com/hibernate/hibernate-orm/blob/6.2/migration-guide.adoc#timezone-and-offset-storage):  Apparently not much to do here but might require some clarifications\r\n- [x] #31588",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/31475/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/31475/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
