{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/33093",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/33093/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/33093/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/33093/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/33093",
  "id": 1693886826,
  "node_id": "I_kwDOCFbutM5k9qlq",
  "number": 33093,
  "title": "Test failure with podman: Quarkus - Micrometer - Deployment",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 2236031886,
      "node_id": "MDU6TGFiZWwyMjM2MDMxODg2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/metrics",
      "name": "area/metrics",
      "color": "0366d6",
      "default": false,
      "description": ""
    },
    {
      "id": 5456027948,
      "node_id": "LA_kwDOCFbutM8AAAABRTRhLA",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/env/podman",
      "name": "env/podman",
      "color": "edea47",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "milestone": null,
  "comments": 1,
  "created_at": "2023-05-03T11:25:11Z",
  "updated_at": "2023-05-03T11:25:14Z",
  "closed_at": null,
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nI am working on a CI run which uses podman, and it has shown several failing tests. https://github.com/holly-cummins/quarkus/actions/runs/4844611295/jobs/8632987478 is an example run with failures. https://github.com/holly-cummins/quarkus/tree/podman-build has the (messy) workflow code.\r\n\r\nNote that Iâ€™ve disabled this test when the CI is running with Podman, to keep the build clean. As part of the fix for this, the `IS_PODMAN` guard should be removed from the pom.xml\n\n### Expected behavior\n\n_No response_\n\n### Actual behavior\n\n```\r\n2023-04-28T20:11:04.4389796Z [ERROR] Tests run: 1, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 0.629 s <<< FAILURE! - in io.quarkus.micrometer.deployment.MicrometerDisabledTest\r\n2023-04-28T20:11:04.4390506Z [ERROR] io.quarkus.micrometer.deployment.MicrometerDisabledTest  Time elapsed: 0.629 s  <<< FAILURE!\r\n2023-04-28T20:11:04.4391358Z org.opentest4j.AssertionFailedError: expected: <jakarta.enterprise.inject.spi.DeploymentException> but was: <java.lang.RuntimeException>\r\n2023-04-28T20:11:04.4391956Z \tat org.junit.jupiter.api.AssertionFailureBuilder.build(AssertionFailureBuilder.java:151)\r\n2023-04-28T20:11:04.4392502Z \tat org.junit.jupiter.api.AssertionFailureBuilder.buildAndThrow(AssertionFailureBuilder.java:132)\r\n2023-04-28T20:11:04.4393004Z \tat org.junit.jupiter.api.AssertEquals.failNotEqual(AssertEquals.java:197)\r\n2023-04-28T20:11:04.4393447Z \tat org.junit.jupiter.api.AssertEquals.assertEquals(AssertEquals.java:182)\r\n2023-04-28T20:11:04.4393861Z \tat org.junit.jupiter.api.AssertEquals.assertEquals(AssertEquals.java:177)\r\n2023-04-28T20:11:04.4394281Z \tat org.junit.jupiter.api.Assertions.assertEquals(Assertions.java:1142)\r\n2023-04-28T20:11:04.4394805Z \tat io.quarkus.micrometer.deployment.MicrometerDisabledTest.lambda$static$1(MicrometerDisabledTest.java:25)\r\n2023-04-28T20:11:04.4395325Z \tat io.quarkus.test.QuarkusUnitTest.beforeAll(QuarkusUnitTest.java:690)\r\n2023-04-28T20:11:04.4395962Z \tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeBeforeAllCallbacks$12(ClassBasedTestDescriptor.java:395)\r\n2023-04-28T20:11:04.4396643Z \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n2023-04-28T20:11:04.4397339Z \tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeBeforeAllCallbacks(ClassBasedTestDescriptor.java:395)\r\n2023-04-28T20:11:04.4398018Z \tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.before(ClassBasedTestDescriptor.java:211)\r\n2023-04-28T20:11:04.4398635Z \tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.before(ClassBasedTestDescriptor.java:84)\r\n2023-04-28T20:11:04.4399317Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:148)\r\n2023-04-28T20:11:04.4400077Z \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n2023-04-28T20:11:04.4400773Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)\r\n2023-04-28T20:11:04.4401326Z \tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\r\n2023-04-28T20:11:04.4401864Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)\r\n2023-04-28T20:11:04.4402471Z \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n2023-04-28T20:11:04.4403105Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)\r\n2023-04-28T20:11:04.4403713Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)\r\n2023-04-28T20:11:04.4404173Z \tat java.base/java.util.ArrayList.forEach(ArrayList.java:1511)\r\n2023-04-28T20:11:04.4404923Z \tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)\r\n2023-04-28T20:11:04.4405715Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)\r\n2023-04-28T20:11:04.4406324Z \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n2023-04-28T20:11:04.4406937Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)\r\n2023-04-28T20:11:04.4407466Z \tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\r\n2023-04-28T20:11:04.4407997Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)\r\n2023-04-28T20:11:04.4408608Z \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n2023-04-28T20:11:04.4409381Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)\r\n2023-04-28T20:11:04.4410152Z \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)\r\n2023-04-28T20:11:04.4410908Z \tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)\r\n2023-04-28T20:11:04.4411733Z \tat org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)\r\n2023-04-28T20:11:04.4412419Z \tat org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)\r\n2023-04-28T20:11:04.4413074Z \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:147)\r\n2023-04-28T20:11:04.4413706Z \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:127)\r\n2023-04-28T20:11:04.4414330Z \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:90)\r\n2023-04-28T20:11:04.4414963Z \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:55)\r\n2023-04-28T20:11:04.4415717Z \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:102)\r\n2023-04-28T20:11:04.4416417Z \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:54)\r\n2023-04-28T20:11:04.4416974Z \tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)\r\n2023-04-28T20:11:04.4417471Z \tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)\r\n2023-04-28T20:11:04.4418028Z \tat org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)\r\n2023-04-28T20:11:04.4418642Z \tat org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:50)\r\n2023-04-28T20:11:04.4419215Z \tat org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184)\r\n2023-04-28T20:11:04.4419875Z \tat org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148)\r\n2023-04-28T20:11:04.4420519Z \tat org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122)\r\n2023-04-28T20:11:04.4421098Z \tat org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)\r\n2023-04-28T20:11:04.4421603Z \tat org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)\r\n2023-04-28T20:11:04.4422065Z \tat org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)\r\n2023-04-28T20:11:04.4422514Z \tat org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)\r\n2023-04-28T20:11:04.4422764Z \r\n```\n\n### How to Reproduce?\n\nReproduction note: I haven't been able to reproduce this locally on mac with podman 4.03.\r\nWith the latest mac version of podman 4.4.4, I get a permission failure running rootless, and it passes rootful.\r\n\r\nPicking up my branch to reproduce on CI should work, or running locally on linux with a podman engine of 4.5.\r\n\n\n### Output of `uname -a` or `ver`\n\n_No response_\n\n### Output of `java -version`\n\n_No response_\n\n### GraalVM version (if different from Java)\n\n_No response_\n\n### Quarkus version or git rev\n\n_No response_\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\n_No response_\n\n### Additional information\n\n## Environment Info\r\n\r\n```\r\n2023-05-02T10:44:48.4887010Z ##[group]Run docker version\r\n2023-05-02T10:44:48.4887318Z ï¿½[36;1mdocker versionï¿½[0m\r\n2023-05-02T10:44:48.4949771Z shell: /usr/bin/bash -e {0}\r\n2023-05-02T10:44:48.4950031Z env:\r\n2023-05-02T10:44:48.4950252Z   LANG: en_US.UTF-8\r\n2023-05-02T10:44:48.4950613Z   COMMON_MAVEN_ARGS: -e -B --settings .github/mvn-settings.xml --fail-at-end\r\n2023-05-02T10:44:48.4951271Z   NATIVE_TEST_MAVEN_ARGS: -Dtest-containers -Dstart-containers -Dquarkus.native.native-image-xmx=5g -Dnative -Dnative.surefire.skip -Dformat.skip -Dno-descriptor-tests install -DskipDocs\r\n2023-05-02T10:44:48.4952041Z   JVM_TEST_MAVEN_ARGS: -Dtest-containers -Dstart-containers -Dformat.skip -DskipDocs -Dquarkus.test.hang-detection-timeout=60\r\n2023-05-02T10:44:48.4952507Z   DB_USER: hibernate_orm_test\r\n2023-05-02T10:44:48.4952790Z   DB_PASSWORD: hibernate_orm_test\r\n2023-05-02T10:44:48.4953053Z   DB_NAME: hibernate_orm_test\r\n2023-05-02T10:44:48.4953388Z   IS_PODMAN: true\r\n2023-05-02T10:44:48.4953637Z   MAVEN_OPTS: -Xmx2g -XX:MaxMetaspaceSize=1g\r\n2023-05-02T10:44:48.4954244Z   JAVA_HOME: /opt/hostedtoolcache/Java_Temurin-Hotspot_jdk/17.0.6-10/x64\r\n2023-05-02T10:44:48.4954619Z   JAVA_HOME_17_X64: /opt/hostedtoolcache/Java_Temurin-Hotspot_jdk/17.0.6-10/x64\r\n2023-05-02T10:44:48.4954970Z   DOCKER_HOST: unix:///run/user/1001/podman/podman.sock\r\n2023-05-02T10:44:48.4955210Z ##[endgroup]\r\n2023-05-02T10:44:49.5351123Z Client:\r\n2023-05-02T10:44:49.5351708Z  Version:           20.10.24+azure-1\r\n2023-05-02T10:44:49.5351963Z  API version:       1.41\r\n2023-05-02T10:44:49.5352176Z  Go version:        go1.19.6\r\n2023-05-02T10:44:49.5352453Z  Git commit:        297e1284d3bd092e9bc96076c3ddc4bb33f8c7ab\r\n2023-05-02T10:44:49.5352738Z  Built:             Fri Mar 31 18:34:38 UTC 2023\r\n2023-05-02T10:44:49.5352965Z  OS/Arch:           linux/amd64\r\n2023-05-02T10:44:49.5353186Z  Context:           default\r\n2023-05-02T10:44:49.5353414Z  Experimental:      true\r\n2023-05-02T10:44:49.5353560Z \r\n2023-05-02T10:44:49.5353709Z Server: linux/amd64/ubuntu-22.04\r\n2023-05-02T10:44:49.5353969Z  Podman Engine:\r\n2023-05-02T10:44:49.5354202Z   Version:          4.5.0\r\n2023-05-02T10:44:49.5354439Z   APIVersion:       4.5.0\r\n2023-05-02T10:44:49.5354636Z   Arch:             amd64\r\n2023-05-02T10:44:49.5355016Z   BuildTime:        1970-01-01T00:00:00Z\r\n2023-05-02T10:44:49.5355260Z   Experimental:     false\r\n2023-05-02T10:44:49.5355459Z   GitCommit:        \r\n2023-05-02T10:44:49.5355677Z   GoVersion:        go1.18.1\r\n2023-05-02T10:44:49.5355968Z   KernelVersion:    5.15.0-1036-azure\r\n2023-05-02T10:44:49.5356195Z   MinAPIVersion:    4.0.0\r\n2023-05-02T10:44:49.5356410Z   Os:               linux\r\n2023-05-02T10:44:49.5356604Z  Conmon:\r\n2023-05-02T10:44:49.5356824Z   Version:          conmon version 2.1.7, commit: \r\n2023-05-02T10:44:49.5357197Z   Package:          conmon_2:2.1.7-0ubuntu22.04+obs15.24_amd64\r\n2023-05-02T10:44:49.5357457Z  OCI Runtime (crun):\r\n2023-05-02T10:44:49.5357678Z   Version:          crun version 1.8.4\r\n2023-05-02T10:44:49.5357962Z commit: 5a8fa99a5e41facba2eda4af12fa26313918805b\r\n2023-05-02T10:44:49.5358237Z rundir: /run/user/1001/crun\r\n2023-05-02T10:44:49.5358444Z spec: 1.0.0\r\n2023-05-02T10:44:49.5358706Z +SYSTEMD +SELINUX +APPARMOR +CAP +SECCOMP +EBPF +YAJL\r\n2023-05-02T10:44:49.5359097Z   Package:          crun_101:1.8.4-0ubuntu22.04+obs55.10_amd64\r\n2023-05-02T10:44:49.5359334Z  Engine:\r\n2023-05-02T10:44:49.5359516Z   Version:          4.5.0\r\n2023-05-02T10:44:49.5359765Z   API version:      1.41 (minimum version 1.24)\r\n2023-05-02T10:44:49.5360012Z   Go version:       go1.18.1\r\n2023-05-02T10:44:49.5360212Z   Git commit:       \r\n2023-05-02T10:44:49.5360442Z   Built:            Thu Jan  1 00:00:00 1970\r\n2023-05-02T10:44:49.5360673Z   OS/Arch:          linux/amd64\r\n2023-05-02T10:44:49.5360884Z   Experimental:     false\r\n```",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/33093/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/33093/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
