{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/21236",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/21236/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/21236/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/21236/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/21236",
  "id": 1046097776,
  "node_id": "I_kwDOCFbutM4-Wi9w",
  "number": 21236,
  "title": "Native code with hivemq runs into segfault",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1676631606,
      "node_id": "MDU6TGFiZWwxNjc2NjMxNjA2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/env/windows",
      "name": "env/windows",
      "color": "edea47",
      "default": false,
      "description": "Impacts Windows machines"
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": null,
  "comments": 4,
  "created_at": "2021-11-05T17:51:16Z",
  "updated_at": "2021-11-08T08:55:59Z",
  "closed_at": "2021-11-08T08:55:57Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nWhen using the hivemq client and compiling to native, we get a \"segfault\" when we publish multiple messages at the same time. \n\n### Expected behavior\n\nContainer doesn't crash with a segfault\n\n### Actual behavior\n\nFollowing segfault is thrown:\r\n\r\n```\r\n __  ____  __  _____   ___  __ ____  ______ \r\n  --/ __ \\/ / / / _ | / _ \\/ //_/ / / / __/ \r\n  -/ /_/ / /_/ / __ |/ , _/ ,< / /_/ /\\ \\   \r\n --\\___\\_\\____/_/ |_/_/|_/_/|_|\\____/___/   \r\n 2021-11-05 17:29:19,051 INFO  [io.quarkus] (main) mqtt-native 1.0-SNAPSHOT native (powered by Quarkus 2.4.1.Final) started in 0.019s. Listening on: http://0.0.0.0:8080\r\n 2021-11-05 17:29:19,052 INFO  [io.quarkus] (main) Profile prod activated. \r\n 2021-11-05 17:29:19,052 INFO  [io.quarkus] (main) Installed features: [cdi, smallrye-context-propagation, vertx]\r\n 2021-11-05 17:29:21,327 INFO  [com.exa.Main] (ForkJoinPool.commonPool-worker-1) Successfully connected to broker\r\n 2021-11-05 17:29:21,328 INFO  [com.exa.Main] (RxComputationThreadPool-2) Successfully published message\r\n \r\n [ [ SubstrateSegfaultHandler caught a segfault in thread 0x00007fca54000b80 ] ]\r\n siginfo: si_signo: 11, si_code: 128, si_addr: 0x0000000000000000\r\n \r\n General purpose register values:\r\n   RAX 0xaa5689ab5ea60610 is an unknown value\r\n   RBX 0x00007fca5ea2ca08 points into an aligned TLAB chunk of thread 0x00000000048aa340\r\n     hub=[Ljava.lang.Object;\r\n   RCX 0x0000000000000002 is an unknown value\r\n   RDX 0x0000000000000001 is an unknown value\r\n   RBP 0x000000000107d238 is an unknown value\r\n   RSI 0xaa5689ab5ea60610 is an unknown value\r\n   RDI 0xfffffffffffffff8 is an unknown value\r\n   RSP 0x00007fca5e9fec60 points into the stack for thread 0x00007fca54000b80\r\n   R8  0x00007ffe2dd9c080 is an unknown value\r\n   R9  0x00007ffe2dd9c090 is an unknown value\r\n   R10 0x0000000000076302 is an unknown value\r\n   R11 0x0000000000000293 is an unknown value\r\n   R12 0x000000000130148f is an unknown value\r\n   R13 0x00007fca5e9feb58 points into the stack for thread 0x00007fca54000b80\r\n   R14 0x00007fcab4500000 is the heap base\r\n   R15 0x00007fca54000b80 is a thread\r\n   EFL 0x0000000000010282 is an unknown value\r\n   RIP 0x000000000052fe4a is an unknown value\r\n   \r\n Printing Instructions (ip=0x000000000052fe4a):\r\n   0x000000000052fe2a: 0x4c 0x24 0x40 0x49 0x8d 0x2c 0x2e 0x48 0x8b 0xfd 0xe8 0x07 0x3e 0xd4 0x00 0x90\r\n   0x000000000052fe3a: 0x49 0x3b 0xc6 0x0f 0x84 0x78 0x00 0x00 0x00 0x48 0xc7 0xc7 0xf8 0xff 0xff 0xff\r\n   0x000000000052fe4a: 0x48 0x23 0x38 0x48 0xbe 0xe0 0x49 0x8e 0x00 0x00 0x00 0x00 0x00 0x48 0x3b 0xf7\r\n   0x000000000052fe5a: 0x40 0x0f 0x94 0xc7 0x40 0x0f 0xb6 0xff 0x85 0xff 0x0f 0x84 0x6b 0x02 0x00 0x00\r\n \r\n Top of stack (sp=0x00007fca5e9fec60):\r\n   0x00007fca5e9fec60: 0x00007fca5ea2c930 0x000000000104e21e\r\n   0x00007fca5e9fec70: 0x0000000000000a4f 0xffffffffaa52fe88\r\n   0x00007fca5e9fec80: 0x00007fca5ea2fe88 0x00007fca5e033148\r\n   0x00007fca5e9fec90: 0x00007fca5ea2c930 0x000000000104e193\r\n   0x00007fca5e9feca0: 0x0000000a00000000 0x00000000009d1ae3\r\n   0x00007fca5e9fecb0: 0x00007fcab4500000 0x00007fcab21faa38\r\n   0x00007fca5e9fecc0: 0x00007fca5ea2c930 0x00000000009e5da5\r\n   0x00007fca5e9fecd0: 0x00007fcab21fab40 0x00007fca5ea2c930\r\n   0x00007fca5e9fece0: 0x00007fcab51953e0 0x00007fcab21fa950\r\n   0x00007fca5e9fecf0: 0x000000000000e193 0x000000000088b411\r\n   0x00007fca5e9fed00: 0x0000000000000a4f 0x0000000000000000\r\n   0x00007fca5e9fed10: 0x0000000000000000 0x0000000000889352\r\n   0x00007fca5e9fed20: 0x00000000005fb1f6 0x000000000107a898\r\n   0x00007fca5e9fed30: 0x00007fcab557a898 0x00007fcab5234cd0\r\n   0x00007fca5e9fed40: 0x000000000107a898 0x00007fcab21fad98\r\n   0x00007fca5e9fed50: 0x00007fcab50b4d20 0x00007fcab21fa950\r\n   0x00007fca5e9fed60: 0x0000000000000a4d 0x0000000000000032\r\n   0x00007fca5e9fed70: 0x0000000000000032 0x0000000dfa1a1e24\r\n   0x00007fca5e9fed80: 0x0000000000000032 0x0000000100000032\r\n   0x00007fca5e9fed90: 0x8000000000000000 0xffffffff00000000\r\n   0x00007fca5e9feda0: 0x0000000000000001 0x00000000009e16e2\r\n   0x00007fca5e9fedb0: 0x0000000000800000 0x0000000000cd354f\r\n   0x00007fca5e9fedc0: 0x00007fca5e001250 0x00007fca5e001200\r\n   0x00007fca5e9fedd0: 0x00007fcab557ae68 0x00000000009d9ced\r\n   0x00007fca5e9fede0: 0x00007fca5ea31508 0x00007fcab4dda5d0\r\n   0x00007fca5e9fedf0: 0x00007fcab4c8cd28 0x00007fcab50b51f0\r\n   0x00007fca5e9fee00: 0x00007fcab526ca10 0x00007fca5ea313d0\r\n   0x00007fca5e9fee10: 0x00007fcab557ae68 0x00000000009f9242\r\n   0x00007fca5e9fee20: 0x00000000005fb1f6 0x00007fcab557ae68\r\n   0x00007fca5e9fee30: 0x00007fca5ea313f0 0x00000000009d9d44\r\n   0x00007fca5e9fee40: 0x00007fca5e9ff700 0x00000000005fac19\r\n   0x00007fca5e9fee50: 0x00007fca54000b80 0x0000000000ce4754\r\n \r\n Top frame info:\r\n   TotalFrameSize in CodeInfoTable 80\r\n   \r\n Threads:\r\n   0x00007fca40000b80 STATUS_IN_NATIVE \"RxComputationThreadPool-2\" - io.reactivex.internal.schedulers.RxThreadFactory$RxCustomThread@0x00007fca5e033c88, daemon, stack(0x00007fca5c401000,0x00007fca5cc00000)\r\n   0x00007fca4c000b80 STATUS_IN_NATIVE \"ForkJoinPool.commonPool-worker-1\" - java.util.concurrent.ForkJoinWorkerThread@0x00007fca5d601968, daemon, stack(0x00007fca5ce01000,0x00007fca5d600000)\r\n   0x00007fca48000b80 STATUS_IN_NATIVE \"RxComputationThreadPool-1\" - io.reactivex.internal.schedulers.RxThreadFactory$RxCustomThread@0x00007fca5e033700, daemon, stack(0x00007fca5d801000,0x00007fca5e000000)\r\n   0x00007fca54000b80 STATUS_IN_JAVA (safepoints disabled) \"com.hivemq.client.mqtt-2-1\" - io.netty.util.concurrent.FastThreadLocalThread@0x00007fca5ea31508, stack(0x00007fca5e201000,0x00007fca5ea00000)\r\n   0x00007fca50000b80 STATUS_IN_NATIVE \"vert.x-acceptor-thread-0\" - io.vertx.core.impl.VertxThread@0x00007fcab05a0eb8, stack(0x00007fca5ee01000,0x00007fca5f600000)\r\n   0x00007fca58000b80 STATUS_IN_NATIVE \"vert.x-eventloop-thread-15\" - io.vertx.core.impl.VertxThread@0x00007fcab2197018, stack(0x00007fca5f801000,0x00007fca60000000)\r\n   0x00007fca64000b80 STATUS_IN_NATIVE \"vert.x-eventloop-thread-14\" - io.vertx.core.impl.VertxThread@0x00007fcab2196978, stack(0x00007fca7c600000,0x00007fca7cdff000)\r\n   0x00007fca60000b80 STATUS_IN_NATIVE \"vert.x-eventloop-thread-13\" - io.vertx.core.impl.VertxThread@0x00007fcab21962e0, stack(0x00007fca7ce01000,0x00007fca7d600000)\r\n   0x00007fca6c000b80 STATUS_IN_NATIVE \"vert.x-eventloop-thread-12\" - io.vertx.core.impl.VertxThread@0x00007fcab2195b40, stack(0x00007fca7d7fd000,0x00007fca7dffc000)\r\n   0x00007fca68000b80 STATUS_IN_NATIVE \"vert.x-eventloop-thread-11\" - io.vertx.core.impl.VertxThread@0x00007fcab21953a8, stack(0x00007fca7dffe000,0x00007fca7e7fd000)\r\n   0x00007fca74000b80 STATUS_IN_NATIVE \"vert.x-eventloop-thread-10\" - io.vertx.core.impl.VertxThread@0x00007fcab2194d28, stack(0x00007fca7e7ff000,0x00007fca7effe000)\r\n   0x00007fca70000b80 STATUS_IN_NATIVE \"vert.x-eventloop-thread-9\" - io.vertx.core.impl.VertxThread@0x00007fcab21946b0, stack(0x00007fca7f000000,0x00007fca7f7ff000)\r\n   0x00007fca78000b80 STATUS_IN_NATIVE \"vert.x-eventloop-thread-8\" - io.vertx.core.impl.VertxThread@0x00007fcab2194040, stack(0x00007fca7f801000,0x00007fca80000000)\r\n   0x00007fca80000b80 STATUS_IN_NATIVE \"vert.x-eventloop-thread-6\" - io.vertx.core.impl.VertxThread@0x00007fcab2193378, stack(0x00007fcaa1600000,0x00007fcaa1dff000)\r\n   0x00007fca88000b80 STATUS_IN_NATIVE \"vert.x-eventloop-thread-7\" - io.vertx.core.impl.VertxThread@0x00007fcab21939d8, stack(0x00007fcaa0c01000,0x00007fcaa1400000)\r\n   0x00007fca90000b80 STATUS_IN_NATIVE \"vert.x-eventloop-thread-4\" - io.vertx.core.impl.VertxThread@0x00007fcab2192640, stack(0x00007fcaa27ff000,0x00007fcaa2ffe000)\r\n   0x00007fca84000b80 STATUS_IN_NATIVE \"vert.x-eventloop-thread-5\" - io.vertx.core.impl.VertxThread@0x00007fcab2192d20, stack(0x00007fcaa1e01000,0x00007fcaa2600000)\r\n   0x00007fca8c000b80 STATUS_IN_NATIVE \"vert.x-eventloop-thread-3\" - io.vertx.core.impl.VertxThread@0x00007fcab2191ff8, stack(0x00007fcaa3000000,0x00007fcaa37ff000)\r\n   0x00007fca94000b80 STATUS_IN_NATIVE \"vert.x-eventloop-thread-1\" - io.vertx.core.impl.VertxThread@0x00007fcab2191380, stack(0x00007fcab0700000,0x00007fcab0eff000)\r\n   0x00007fca98000b80 STATUS_IN_NATIVE \"vert.x-eventloop-thread-2\" - io.vertx.core.impl.VertxThread@0x00007fcab21919b8, stack(0x00007fcaa3801000,0x00007fcaa4000000)\r\n   0x00007fca9c000b80 STATUS_IN_NATIVE \"vert.x-eventloop-thread-0\" - io.vertx.core.impl.VertxThread@0x00007fcab2190ca0, stack(0x00007fcab0f01000,0x00007fcab1700000)\r\n   0x00007fcaa8000b80 STATUS_IN_NATIVE \"vertx-blocked-thread-checker\" - java.util.TimerThread@0x00007fcab2124e70, daemon, stack(0x00007fcab1901000,0x00007fcab2100000)\r\n   0x00007fcaa4000b80 STATUS_IN_NATIVE \"executor-thread-0\" - io.vertx.core.impl.VertxThread@0x00007fcab2d73940, daemon, stack(0x00007fcab2501000,0x00007fcab2d00000)\r\n   0x00007fcaac000b80 STATUS_IN_NATIVE \"Signal Dispatcher\" - java.lang.Thread@0x00007fcab43041d8, daemon, stack(0x00007fcab3b01000,0x00007fcab4300000)\r\n   0x00000000048aa340 STATUS_IN_NATIVE \"main\" - java.lang.Thread@0x00007fcab5034648, stack(0x00007ffe2d512000,0x00007ffe2dd12000)\r\n   \r\n VM thread locals for the failing thread 0x00007fca54000b80:\r\n   0 (8 bytes): com.oracle.svm.jni.JNIThreadLocalEnvironment.jniFunctions = (bytes) \r\n     0x00007fca54000b80: 0x00007fcab4c49010\r\n   8 (8 bytes): com.oracle.svm.core.graal.snippets.StackOverflowCheckImpl.stackBoundaryTL = (Word) 1 (0x0000000000000001)\r\n   16 (4 bytes): com.oracle.svm.core.thread.Safepoint.safepointRequested = (int) 2147449402 (0x7fff7a3a)\r\n   20 (4 bytes): com.oracle.svm.core.thread.VMThreads$StatusSupport.statusTL = (int) 1 (0x00000001)\r\n   24 (32 bytes): com.oracle.svm.core.genscavenge.ThreadLocalAllocation.regularTLAB = (bytes) \r\n     0x00007fca54000b98: 0x00007fca5e000000 0x00007fca5e100000\r\n     0x00007fca54000ba8: 0x00007fca5e033ec0 0x0000000000000000\r\n   56 (8 bytes): com.oracle.svm.core.thread.JavaThreads.currentThread = (Object) io.netty.util.concurrent.FastThreadLocalThread (0x00007fca5ea31508)\r\n   64 (8 bytes): com.oracle.svm.core.stack.JavaFrameAnchors.lastAnchor = (Word) 0 (0x0000000000000000)\r\n   72 (8 bytes): com.oracle.svm.core.heap.NoAllocationVerifier.openVerifiers = (Object) null\r\n   80 (8 bytes): com.oracle.svm.core.identityhashcode.IdentityHashCodeSupport.hashCodeGeneratorTL = (Object) java.util.SplittableRandom (0x00007fca5e001910)\r\n   88 (8 bytes): com.oracle.svm.core.snippets.ExceptionUnwind.currentException = (Object) null\r\n   96 (8 bytes): com.oracle.svm.core.thread.ThreadingSupportImpl.activeTimer = (Object) null\r\n   104 (8 bytes): com.oracle.svm.graal.isolated.IsolatedCompileClient.currentClient = (Object) null\r\n   112 (8 bytes): com.oracle.svm.graal.isolated.IsolatedCompileContext.currentContext = (Object) null\r\n   120 (8 bytes): com.oracle.svm.jni.JNIObjectHandles.handles = (Object) com.oracle.svm.core.handles.ThreadLocalHandles (0x00007fca5e001668)\r\n   128 (8 bytes): com.oracle.svm.jni.JNIThreadLocalPendingException.pendingException = (Object) null\r\n   136 (8 bytes): com.oracle.svm.jni.JNIThreadLocalPinnedObjects.pinnedObjectsListHead = (Object) null\r\n   144 (8 bytes): com.oracle.svm.jni.JNIThreadOwnedMonitors.ownedMonitors = (Object) null\r\n   152 (8 bytes): com.oracle.svm.core.SubstrateDiagnostics.threadOnlyAttachedForCrashHandler = (bytes) \r\n     0x00007fca54000c18: 0x0000000000000000\r\n   160 (8 bytes): com.oracle.svm.core.thread.VMThreads.IsolateTL = (Word) 140508585263104 (0x00007fcab4500000)\r\n   168 (8 bytes): com.oracle.svm.core.thread.VMThreads.OSThreadHandleTL = (Word) 140507147663104 (0x00007fca5e9ff700)\r\n   176 (8 bytes): com.oracle.svm.core.thread.VMThreads.OSThreadIdTL = (Word) 140507147663104 (0x00007fca5e9ff700)\r\n   184 (8 bytes): com.oracle.svm.core.thread.VMThreads.StackBase = (Word) 140507147665408 (0x00007fca5ea00000)\r\n   192 (8 bytes): com.oracle.svm.core.thread.VMThreads.StackEnd = (Word) 140507139280896 (0x00007fca5e201000)\r\n   200 (8 bytes): com.oracle.svm.core.thread.VMThreads.nextTL = (Word) 140506902301568 (0x00007fca50000b80)\r\n   208 (8 bytes): com.oracle.svm.core.thread.VMThreads.unalignedIsolateThreadMemoryTL = (Word) 140506969410400 (0x00007fca54000b60)\r\n   216 (4 bytes): com.oracle.svm.core.graal.snippets.StackOverflowCheckImpl.yellowZoneStateTL = (int) 2130640638 (0x7efefefe)\r\n   220 (4 bytes): com.oracle.svm.core.snippets.ImplicitExceptions.implicitExceptionsAreFatal = (int) 0 (0x00000000)\r\n   224 (4 bytes): com.oracle.svm.core.thread.ThreadingSupportImpl.currentPauseDepth = (int) 0 (0x00000000)\r\n   228 (4 bytes): com.oracle.svm.core.thread.VMThreads$ActionOnExitSafepointSupport.actionTL = (int) 0 (0x00000000)\r\n   232 (4 bytes): com.oracle.svm.core.thread.VMThreads$ActionOnTransitionToJavaSupport.actionTL = (int) 0 (0x00000000)\r\n   236 (4 bytes): com.oracle.svm.core.thread.VMThreads$StatusSupport.safepointsDisabledTL = (int) 1 (0x00000001)\r\n   240 (4 bytes): io.quarkus.runtime.configuration.Substitutions.notExpanding = (int) 0 (0x00000000)\r\n   \r\n No VMOperation in progress\r\n \r\n The 10 most recent VM operation status changes (oldest first):\r\n   \r\n Counters:\r\n   \r\n Java frame anchors for the failing thread 0x00007fca54000b80:\r\n   No anchors\r\n   \r\n Stacktrace for the failing thread 0x00007fca54000b80:\r\n   SP 0x00007fca5e9fec60 IP 0x000000000052fe4a  com.oracle.svm.core.code.CodeInfo@0x7fcab4f58de8 name = image code\r\n   SP 0x00007fca5e9fecb0 IP 0x00000000009d1ae3  [image code] io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)\r\n   SP 0x00007fca5e9fecd0 IP 0x00000000009e5da5  [image code] io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)\r\n   SP 0x00007fca5e9fed20 IP 0x0000000000889352  [image code] io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)\r\n   SP 0x00007fca5e9fedb0 IP 0x00000000009e16e2  [image code] io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\r\n   SP 0x00007fca5e9fee20 IP 0x00000000009f9242  [image code] io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\r\n   SP 0x00007fca5e9fee40 IP 0x00000000009d9d44  [image code] io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n   SP 0x00007fca5e9fee60 IP 0x0000000000ce4754  [image code] java.lang.Thread.run(Thread.java:833)\r\n   SP 0x00007fca5e9fee70 IP 0x00000000006767de  [image code] com.oracle.svm.core.thread.JavaThreads.threadStartRoutine(JavaThreads.java:596)\r\n   SP 0x00007fca5e9feea0 IP 0x0000000000599ad5  [image code] com.oracle.svm.core.posix.thread.PosixJavaThreads.pthreadStartRoutine(PosixJavaThreads.java:192)\r\n   SP 0x00007fca5e9feea0 IP 0x0000000000599ad5  [image code] com.oracle.svm.core.code.IsolateEnterStub.PosixJavaThreads_pthreadStartRoutine_e1f4a8c0039f8337338252cd8734f63a79b5e3df(IsolateEnterStub.java:0)\r\n   \r\n VM mutexes:\r\n   mutex \"thread\" is unlocked.\r\n   mutex \"referencePendingList\" is unlocked.\r\n   mutex \"mainVMOperationControlWorkQueue\" is unlocked.\r\n   \r\n Heap settings and statistics:\r\n   Supports isolates: true\r\n   Heap base: 0x00007fcab4500000\r\n   Object reference size: 8\r\n   Aligned chunk size: 1048576\r\n   Incremental collections: 0\r\n   Complete collections: 0\r\n   \r\n Native image heap boundaries:\r\n   ReadOnly Primitives: 0x00007fcab4601028 - 0x00007fcab4934538\r\n   ReadOnly References: 0x00007fcab4934538 - 0x00007fcab4c480c8\r\n   ReadOnly Relocatables: 0x00007fcab4c49000 - 0x00007fcab4e68888\r\n   Writable Primitives: 0x00007fcab4e69000 - 0x00007fcab4f92e90\r\n   Writable References: 0x00007fcab4f92e90 - 0x00007fcab55e8210\r\n   Writable Huge: 0x00007fcab5600030 - 0x00007fcab56701f8\r\n   ReadOnly Huge: 0x00007fcab5671030 - 0x00007fcab5d37958\r\n \r\n Heap:\r\n   Young generation: \r\n     Eden: \r\n       edenSpace:\r\n         aligned: 1048576/1 unaligned: 0/0\r\n         aligned chunks:\r\n           0x00007fcab2f00000 (0x00007fcab2f01028-0x00007fcab2f01188)\r\n     Survivors: \r\n       \r\n   Old generation: \r\n     oldFromSpace:\r\n       aligned: 0/0 unaligned: 0/0\r\n     oldToSpace:\r\n       aligned: 0/0 unaligned: 0/0\r\n     \r\n   Unused:\r\n     aligned: 0/0\r\n \r\nSegfault detected, aborting process. Use runtime option -R:-InstallSegfaultHandler if you don't want to use SubstrateSegfaultHandler.\r\n\r\n```\r\n\r\nI tested it with:\r\n* quay.io/quarkus/ubi-quarkus-native-image:21.3-java17\r\n* quay.io/quarkus/ubi-quarkus-native-image:21.3-java11\r\n* quay.io/quarkus/ubi-quarkus-native-image:21.2-java11\r\n\r\nAll with the same result.\r\n\n\n### How to Reproduce?\n\n\r\n[mqtt-native.zip](https://github.com/quarkusio/quarkus/files/7487949/mqtt-native.zip)\r\n\r\n\r\n1. Build the reproducer project with\r\n\r\n```console\r\ngradle quarkusBuild -Dquarkus.package.type=native -Dquarkus.container-image.build=true\r\n```\r\n\r\n2. Run the newly created image\n\n### Output of `uname -a` or `ver`\n\nWindows 10\n\n### Output of `java -version`\n\nopenjdk version \"17\" 2021-09-14\n\n### GraalVM version (if different from Java)\n\n21.3-java17, 21.3-java11, 21.2-java17\n\n### Quarkus version or git rev\n\n2.4.1\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\nGradle 7.2\n\n### Additional information\n\nFollowing settings are used so that the hivemq build works:\r\n\r\napplication.properties:\r\n```properties\r\nquarkus.native.additional-build-args=--initialize-at-run-time=com.hivemq\r\nquarkus.arc.exclude-dependency.hivemq.group-id=com.hivemq\r\nquarkus.arc.exclude-dependency.hivemq.artifact-id=hivemq-mqtt-client\r\n``` ",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/21236/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/21236/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
