{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/20976",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/20976/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/20976/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/20976/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/20976",
  "id": 1034966976,
  "node_id": "I_kwDOCFbutM49sFfA",
  "number": 20976,
  "title": "Error message doesn't mention the causing line: Panache-Hibernate ",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1273026134,
      "node_id": "MDU6TGFiZWwxMjczMDI2MTM0",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/panache",
      "name": "area/panache",
      "color": "0366d6",
      "default": false,
      "description": ""
    },
    {
      "id": 1273026509,
      "node_id": "MDU6TGFiZWwxMjczMDI2NTA5",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/persistence",
      "name": "area/persistence",
      "color": "FBCA04",
      "default": false,
      "description": "OBSOLETE, DO NOT USE"
    },
    {
      "id": 1425555736,
      "node_id": "MDU6TGFiZWwxNDI1NTU1NzM2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/hibernate-orm",
      "name": "area/hibernate-orm",
      "color": "0366d6",
      "default": false,
      "description": "Hibernate ORM"
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": null,
  "comments": 5,
  "created_at": "2021-10-25T10:38:11Z",
  "updated_at": "2022-01-07T10:35:52Z",
  "closed_at": "2022-01-06T17:01:45Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nI called `jobRepository.listAll(Sort.by(\"dueWeek\").and(\"readyWeek\").and(\"name\").and(\"id\")))` but Job doesn't have `dueWeek` property any more.\r\n\r\nI should get an error message that told me I made a mistake in that line.\r\n\r\nInstead, I got an error message \"could not prepare statement\" and \"Column \"DUEWEEK\" not found\", which made me think I had to restart quarkus:dev because the database somehow didn't create-drop properly.\n\n### Expected behavior\n\nAn error message that includes \"MaintenanceScheduleResource\" line 98  which is the line that has `jobRepository.listAll(Sort.by(\"dueWeek\").and(\"readyWeek\").and(\"name\").and(\"id\")))`\r\n\r\n\n\n### Actual behavior\n\n```\r\n2021-10-25 12:31:33,363 INFO  [io.quarkus] (Quarkus Main Thread) Installed features: [agroal, cdi, hibernate-orm, hibernate-orm-panache, hibernate-orm-rest-data-panache, jdbc-h2, narayana-jta, optaplanner, optaplanner-jackson, resteasy, resteasy-jackson, smallrye-context-propagation, vertx, webjars-locator]\r\n2021-10-25 12:31:34,223 WARN  [org.hib.eng.jdb.spi.SqlExceptionHelper] (executor-thread-0) SQL Error: 42122, SQLState: 42S22\r\n2021-10-25 12:31:34,225 ERROR [org.hib.eng.jdb.spi.SqlExceptionHelper] (executor-thread-0) Column \"DUEWEEK\" not found; SQL statement:\r\nselect job0_.id as id1_2_, job0_.crew_id as crew_id8_2_, job0_.dueDate as duedate2_2_, job0_.durationInDays as duration3_2_, job0_.endDate as enddate4_2_, job0_.name as name5_2_, job0_.readyDate as readydat6_2_, job0_.startDate as startdat7_2_ from Job job0_ order by dueWeek, readyWeek, job0_.name, job0_.id [42122-197]\r\n2021-10-25 12:31:34,240 ERROR [io.qua.ver.htt.run.QuarkusErrorHandler] (executor-thread-0) HTTP Request to /schedule failed, error id: 425347e4-9b73-4226-b3eb-14cf8f7c6bde-1: org.jboss.resteasy.spi.UnhandledException: javax.persistence.PersistenceException: org.hibernate.exception.SQLGrammarException: could not prepare statement\r\n        at org.jboss.resteasy.core.ExceptionHandler.handleApplicationException(ExceptionHandler.java:106)\r\n        at org.jboss.resteasy.core.ExceptionHandler.handleException(ExceptionHandler.java:372)\r\n        at org.jboss.resteasy.core.SynchronousDispatcher.writeException(SynchronousDispatcher.java:218)\r\n        at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:519)\r\n        at org.jboss.resteasy.core.SynchronousDispatcher.lambda$invoke$4(SynchronousDispatcher.java:261)\r\n        at org.jboss.resteasy.core.SynchronousDispatcher.lambda$preprocess$0(SynchronousDispatcher.java:161)\r\n        at org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:364)\r\n        at org.jboss.resteasy.core.SynchronousDispatcher.preprocess(SynchronousDispatcher.java:164)\r\n        at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:247)\r\n        at io.quarkus.resteasy.runtime.standalone.RequestDispatcher.service(RequestDispatcher.java:73)\r\n        at io.quarkus.resteasy.runtime.standalone.VertxRequestHandler.dispatch(VertxRequestHandler.java:135)\r\n        at io.quarkus.resteasy.runtime.standalone.VertxRequestHandler$1.run(VertxRequestHandler.java:90)\r\n        at io.quarkus.vertx.core.runtime.VertxCoreRecorder$13.runWith(VertxCoreRecorder.java:543)\r\n        at org.jboss.threads.EnhancedQueueExecutor$Task.run(EnhancedQueueExecutor.java:2449)\r\n        at org.jboss.threads.EnhancedQueueExecutor$ThreadBody.run(EnhancedQueueExecutor.java:1478)\r\n        at org.jboss.threads.DelegatingRunnable.run(DelegatingRunnable.java:29)\r\n        at org.jboss.threads.ThreadLocalResettingRunnable.run(ThreadLocalResettingRunnable.java:29)\r\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n        at java.base/java.lang.Thread.run(Thread.java:829)\r\nCaused by: javax.persistence.PersistenceException: org.hibernate.exception.SQLGrammarException: could not prepare statement\r\n        at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:154)\r\n        at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1626)\r\n        at org.hibernate.query.Query.getResultList(Query.java:165)\r\n        at io.quarkus.hibernate.orm.panache.common.runtime.CommonPanacheQueryImpl.list(CommonPanacheQueryImpl.java:247)\r\n        at io.quarkus.hibernate.orm.panache.runtime.PanacheQueryImpl.list(PanacheQueryImpl.java:149)\r\n        at io.quarkus.hibernate.orm.panache.runtime.JpaOperations.list(JpaOperations.java:24)\r\n        at io.quarkus.hibernate.orm.panache.runtime.JpaOperations.list(JpaOperations.java:10)\r\n        at io.quarkus.hibernate.orm.panache.common.runtime.AbstractJpaOperations.listAll(AbstractJpaOperations.java:297)\r\n        at org.acme.maintenancescheduling.persistence.JobRepository.listAll(JobRepository.java)\r\n        at org.acme.maintenancescheduling.persistence.JobRepository_Subclass.listAll$$superforward1(JobRepository_Subclass.zig:1966)\r\n        at org.acme.maintenancescheduling.persistence.JobRepository_Subclass$$function$$23.apply(JobRepository_Subclass$$function$$23.zig:33)\r\n        at io.quarkus.arc.impl.AroundInvokeInvocationContext.proceed(AroundInvokeInvocationContext.java:54)\r\n        at io.quarkus.arc.runtime.devconsole.InvocationInterceptor.proceed(InvocationInterceptor.java:62)\r\n        at io.quarkus.arc.runtime.devconsole.InvocationInterceptor.monitor(InvocationInterceptor.java:49)\r\n        at io.quarkus.arc.runtime.devconsole.InvocationInterceptor_Bean.intercept(InvocationInterceptor_Bean.zig:521)\r\n        at io.quarkus.arc.impl.InterceptorInvocation.invoke(InterceptorInvocation.java:41)\r\n        at io.quarkus.arc.impl.AroundInvokeInvocationContext.perform(AroundInvokeInvocationContext.java:41)\r\n        at io.quarkus.arc.impl.InvocationContexts.performAroundInvoke(InvocationContexts.java:32)\r\n        at org.acme.maintenancescheduling.persistence.JobRepository_Subclass.listAll(JobRepository_Subclass.zig:4612)\r\n        at org.acme.maintenancescheduling.persistence.JobRepository_ClientProxy.listAll(JobRepository_ClientProxy.zig:262)\r\n        at org.acme.maintenancescheduling.rest.MaintenanceScheduleResource.findById(MaintenanceScheduleResource.java:98)\r\n        at org.acme.maintenancescheduling.rest.MaintenanceScheduleResource_Subclass.findById$$superforward1(MaintenanceScheduleResource_Subclass.zig:297)\r\n        at org.acme.maintenancescheduling.rest.MaintenanceScheduleResource_Subclass$$function$$1.apply(MaintenanceScheduleResource_Subclass$$function$$1.zig:33)\r\n        at io.quarkus.arc.impl.AroundInvokeInvocationContext.proceed(AroundInvokeInvocationContext.java:54)\r\n        at io.quarkus.arc.runtime.devconsole.InvocationInterceptor.proceed(InvocationInterceptor.java:62)\r\n        at io.quarkus.arc.runtime.devconsole.InvocationInterceptor.monitor(InvocationInterceptor.java:49)\r\n        at io.quarkus.arc.runtime.devconsole.InvocationInterceptor_Bean.intercept(InvocationInterceptor_Bean.zig:521)\r\n        at io.quarkus.arc.impl.InterceptorInvocation.invoke(InterceptorInvocation.java:41)\r\n        at io.quarkus.arc.impl.AroundInvokeInvocationContext.proceed(AroundInvokeInvocationContext.java:50)\r\n        at io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorBase.invokeInOurTx(TransactionalInterceptorBase.java:132)\r\n        at io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorBase.invokeInOurTx(TransactionalInterceptorBase.java:103)\r\n        at io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorRequired.doIntercept(TransactionalInterceptorRequired.java:38)\r\n        at io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorBase.intercept(TransactionalInterceptorBase.java:57)\r\n        at io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorRequired.intercept(TransactionalInterceptorRequired.java:32)\r\n        at io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorRequired_Bean.intercept(TransactionalInterceptorRequired_Bean.zig:340)\r\n        at io.quarkus.arc.impl.InterceptorInvocation.invoke(InterceptorInvocation.java:41)\r\n        at io.quarkus.arc.impl.AroundInvokeInvocationContext.perform(AroundInvokeInvocationContext.java:41)\r\n        at io.quarkus.arc.impl.InvocationContexts.performAroundInvoke(InvocationContexts.java:32)\r\n        at org.acme.maintenancescheduling.rest.MaintenanceScheduleResource_Subclass.findById(MaintenanceScheduleResource_Subclass.zig:432)\r\n        at org.acme.maintenancescheduling.rest.MaintenanceScheduleResource.getSchedule(MaintenanceScheduleResource.java:63)\r\n        at org.acme.maintenancescheduling.rest.MaintenanceScheduleResource_Subclass.getSchedule$$superforward1(MaintenanceScheduleResource_Subclass.zig:311)\r\n        at org.acme.maintenancescheduling.rest.MaintenanceScheduleResource_Subclass$$function$$2.apply(MaintenanceScheduleResource_Subclass$$function$$2.zig:24)\r\n        at io.quarkus.arc.impl.AroundInvokeInvocationContext.proceed(AroundInvokeInvocationContext.java:54)\r\n        at io.quarkus.arc.runtime.devconsole.InvocationInterceptor.proceed(InvocationInterceptor.java:62)\r\n        at io.quarkus.arc.runtime.devconsole.InvocationInterceptor.monitor(InvocationInterceptor.java:49)\r\n        at io.quarkus.arc.runtime.devconsole.InvocationInterceptor_Bean.intercept(InvocationInterceptor_Bean.zig:521)\r\n        at io.quarkus.arc.impl.InterceptorInvocation.invoke(InterceptorInvocation.java:41)\r\n        at io.quarkus.arc.impl.AroundInvokeInvocationContext.perform(AroundInvokeInvocationContext.java:41)\r\n        at io.quarkus.arc.impl.InvocationContexts.performAroundInvoke(InvocationContexts.java:32)\r\n        at org.acme.maintenancescheduling.rest.MaintenanceScheduleResource_Subclass.getSchedule(MaintenanceScheduleResource_Subclass.zig:516)\r\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodImpl.java:43)\r\n        at java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n        at org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:170)\r\n        at org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:130)\r\n        at org.jboss.resteasy.core.ResourceMethodInvoker.internalInvokeOnTarget(ResourceMethodInvoker.java:660)\r\n        at org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTargetAfterFilter(ResourceMethodInvoker.java:524)\r\n        at org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invokeOnTarget$2(ResourceMethodInvoker.java:474)\r\n        at org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:364)\r\n        at org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:476)\r\n        at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:434)\r\n        at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:408)\r\n        at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:69)\r\n        at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:492)\r\n        ... 15 more\r\nCaused by: org.hibernate.exception.SQLGrammarException: could not prepare statement\r\n        at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)\r\n        at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)\r\n        at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)\r\n        at org.hibernate.engine.jdbc.internal.StatementPreparerImpl$StatementPreparationTemplate.prepareStatement(StatementPreparerImpl.java:186)\r\n        at org.hibernate.engine.jdbc.internal.StatementPreparerImpl.prepareQueryStatement(StatementPreparerImpl.java:151)\r\n        at org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:2122)\r\n        at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2059)\r\n        at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)\r\n        at org.hibernate.loader.Loader.doQuery(Loader.java:956)\r\n        at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)\r\n        at org.hibernate.loader.Loader.doList(Loader.java:2868)\r\n        at org.hibernate.loader.Loader.doList(Loader.java:2850)\r\n        at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)\r\n        at org.hibernate.loader.Loader.list(Loader.java:2677)\r\n        at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)\r\n        at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)\r\n        at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:219)\r\n        at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1443)\r\n        at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)\r\n        at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)\r\n        ... 78 more\r\nCaused by: org.h2.jdbc.JdbcSQLException: Column \"DUEWEEK\" not found; SQL statement:\r\nselect job0_.id as id1_2_, job0_.crew_id as crew_id8_2_, job0_.dueDate as duedate2_2_, job0_.durationInDays as duration3_2_, job0_.endDate as enddate4_2_, job0_.name as name5_2_, job0_.readyDate as readydat6_2_, job0_.startDate as startdat7_2_ from Job job0_ order by dueWeek, readyWeek, job0_.name, job0_.id [42122-197]\r\n        at org.h2.message.DbException.getJdbcSQLException(DbException.java:357)\r\n        at org.h2.message.DbException.get(DbException.java:179)\r\n        at org.h2.message.DbException.get(DbException.java:155)\r\n        at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:150)\r\n        at org.h2.command.dml.Select.prepare(Select.java:858)\r\n        at org.h2.command.Parser.prepareCommand(Parser.java:283)\r\n        at org.h2.engine.Session.prepareLocal(Session.java:611)\r\n        at org.h2.engine.Session.prepareCommand(Session.java:549)\r\n        at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1247)\r\n        at org.h2.jdbc.JdbcPreparedStatement.<init>(JdbcPreparedStatement.java:76)\r\n        at org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:304)\r\n        at io.agroal.pool.wrapper.ConnectionWrapper.prepareStatement(ConnectionWrapper.java:659)\r\n        at org.hibernate.engine.jdbc.internal.StatementPreparerImpl$5.doPrepare(StatementPreparerImpl.java:149)\r\n        at org.hibernate.engine.jdbc.internal.StatementPreparerImpl$StatementPreparationTemplate.prepareStatement(StatementPreparerImpl.java:176)\r\n        ... 94 more\r\n\r\n```\n\n### How to Reproduce?\n\nUse Panache.listAll() on a property that doesn't exist.\r\nNotice the error message doesn't point to where you made the mistake.\n\n### Output of `uname -a` or `ver`\n\n_No response_\n\n### Output of `java -version`\n\n_No response_\n\n### GraalVM version (if different from Java)\n\n_No response_\n\n### Quarkus version or git rev\n\n2.3.0.Final\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\n_No response_\n\n### Additional information\n\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/20976/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/20976/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
