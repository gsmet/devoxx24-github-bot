{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/27318",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/27318/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/27318/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/27318/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/27318",
  "id": 1340456349,
  "node_id": "I_kwDOCFbutM5P5b2d",
  "number": 27318,
  "title": "Infinispan client extension does not work with gradle as build tool",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1273026591,
      "node_id": "MDU6TGFiZWwxMjczMDI2NTkx",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/gradle",
      "name": "area/gradle",
      "color": "0366d6",
      "default": false,
      "description": "Gradle"
    },
    {
      "id": 1282122953,
      "node_id": "MDU6TGFiZWwxMjgyMTIyOTUz",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/infinispan",
      "name": "area/infinispan",
      "color": "0366d6",
      "default": false,
      "description": "Infinispan"
    },
    {
      "id": 1287515315,
      "node_id": "MDU6TGFiZWwxMjg3NTE1MzE1",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/kotlin",
      "name": "area/kotlin",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/212",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/212",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/212/labels",
    "id": 8574708,
    "node_id": "MI_kwDOCFbutM4Agtb0",
    "number": 212,
    "title": "2.13.4.Final",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 87,
    "state": "closed",
    "created_at": "2022-10-24T14:12:19Z",
    "updated_at": "2023-01-25T09:02:55Z",
    "due_on": null,
    "closed_at": "2022-11-07T12:39:34Z"
  },
  "comments": 10,
  "created_at": "2022-08-16T14:36:46Z",
  "updated_at": "2022-11-05T16:10:16Z",
  "closed_at": "2022-11-04T15:29:17Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nFollowing the steps in the guide for quarkus-infinispan extension (https://quarkus.io/guides/infinispan-client#dependency-injection) if application is using gradle as build system, while puting an object to the cache the following error will occur:\r\njava.lang.IllegalArgumentException: No marshaller registered for object of Java type org.acme.domain.Book : Book [authors=[Author [name=Sean, surname=Scott]], description=b, price=100, publicationYear=5, title=a]\n\n### Expected behavior\n\nFor error not to occur\n\n### Actual behavior\n\nWhen an item is put into, or retrieved from a cache, you receive an IllegalArgument exception that the proto marshaller isn't registered for the class.\r\nThis happens because no protobuf marshaller classes are generated.\n\n### How to Reproduce?\n\nSteps to reproduce the behavior:\r\n\r\n1. Create a new quarkus gradle project with the following extensions: quarkus-resteasy, quarkus-resteasy-jsonb, quarkus-infinispan-client)\r\n2. Follow the infinispan client quick start guide... use the annotations approach described (Author, Book, BookStoreSchema )\r\n3. Start an infinispan server and \r\n4. Configure the connection properties in the application.properties file, as follows:\r\n```\r\napplication.name=quarkusInfinispanDemo\r\nquarkus.infinispan-client.server-list=localhost:11222\r\n# Authentication\r\nquarkus.infinispan-client.auth-username=admin\r\nquarkus.infinispan-client.auth-password=secret\r\nquarkus.infinispan-client.sasl-mechanism=DIGEST-MD5\r\n\r\ncache=<infinispan><cache-container><replicated-cache name=\"<name-override>\"><encoding><key media-type=\"text/plain\"/><value media-type=\"application/x-protostream\"/></encoding></replicated-cache></cache-container></infinispan>\r\n```\r\n6. Modify GreetingResource so that cache is used when /hello path is invoked\r\n```java\r\n@Path(\"/hello\")\r\npublic class GreetingResource {\r\n\r\n    @Inject\r\n    RemoteCacheManager remoteCacheManager;\r\n\r\n    @ConfigProperty(name = \"cache\")\r\n    String cacheConfiguration;\r\n\r\n    @GET\r\n    @Produces(MediaType.TEXT_PLAIN)\r\n    public String hello() {\r\n        Book b = new Book(\"a\",\"b\",5, Set.of(new Author(\"Sean\",\"Scott\")), new BigDecimal(100d));\r\n        getCache().put(\"hi\",b);\r\n        getCache().get(\"hi\");\r\n        return \"hello\";\r\n    }\r\n\r\n    public RemoteCache<String,Book> getCache(){\r\n        return remoteCacheManager.administration().getOrCreateCache(\r\n            \"books\", \r\n            new XMLStringConfiguration(cacheConfiguration.replace(\"<name-override>\", \"books\"))    \r\n        );\r\n    }\r\n}\r\n```\r\n7. Invoke the endpoint: `http://localhost:8080/hello` and you should see the internal server error screen with the following exception:\r\njava.lang.IllegalArgumentException: No marshaller registered for object of Java type org.acme.domain.Book : Book [authors=[Author [name=Sean, surname=Scott]], description=b, price=100, publicationYear=5, title=a]\r\n\tat org.infinispan.protostream.impl.SerializationContextImpl.getMarshallerDelegate(SerializationContextImpl.java:503)\r\n\tat org.infinispan.protostream.WrappedMessage.writeMessage(WrappedMessage.java:281)\r\n\tat org.infinispan.protostream.WrappedMessage.write(WrappedMessage.java:242)\r\n...\r\n\r\n\n\n### Output of `uname -a` or `ver`\n\nLinux domagoj-TUXEDO-Book-XP14-Gen12 5.15.0-46-generic #49-Ubuntu SMP Thu Aug 4 18:03:25 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux\n\n### Output of `java -version`\n\nopenjdk version \"11.0.12\" 2021-07-20 OpenJDK Runtime Environment 18.9 (build 11.0.12+7) OpenJDK 64-Bit Server VM 18.9 (build 11.0.12+7, mixed mode)\n\n### GraalVM version (if different from Java)\n\n_No response_\n\n### Quarkus version or git rev\n\n2.11.2.Final\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\n------------------------------------------------------------ Gradle 7.4.2 ------------------------------------------------------------  Build time:   2022-03-31 15:25:29 UTC Revision:     540473b8118064efcc264694cbcaa4b677f61041  Kotlin:       1.5.31 Groovy:       3.0.9 Ant:          Apache Ant(TM) version 1.10.11 compiled on July 10 2021 JVM:          11.0.12 (Oracle Corporation 11.0.12+7) OS:           Linux 5.15.0-46-generic amd64\n\n### Additional information\n\nNo Marshaller classes are generated inside build/ folder. On the other hand when the same steps are repeated but with the application using maven as the build tool, all works fine.",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/27318/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/27318/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
