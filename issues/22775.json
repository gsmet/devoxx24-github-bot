{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/22775",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/22775/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/22775/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/22775/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/22775",
  "id": 1098118991,
  "node_id": "I_kwDOCFbutM5Bc_dP",
  "number": 22775,
  "title": "Connection to Kafka DevServices not possible",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1658790125,
      "node_id": "MDU6TGFiZWwxNjU4NzkwMTI1",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/kafka",
      "name": "area/kafka",
      "color": "0366d6",
      "default": false,
      "description": ""
    },
    {
      "id": 1676631606,
      "node_id": "MDU6TGFiZWwxNjc2NjMxNjA2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/env/windows",
      "name": "env/windows",
      "color": "edea47",
      "default": false,
      "description": "Impacts Windows machines"
    },
    {
      "id": 2955097667,
      "node_id": "MDU6TGFiZWwyOTU1MDk3NjY3",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/devservices",
      "name": "area/devservices",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": null,
  "comments": 5,
  "created_at": "2022-01-10T16:43:00Z",
  "updated_at": "2022-01-11T06:40:05Z",
  "closed_at": "2022-01-11T06:40:05Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nQuarkus cant connect to the auto-configured DevServices Kafka Broker.\r\n\r\n### Expected behavior\r\n\r\nQuarkus should connect seamless\r\n\r\n### Actual behavior\r\n\r\nQuarkus tries to connect, but cant establish connection.\r\n```\r\n2022-01-10 17:34:27,191 WARN  [org.apa.kaf.cli.NetworkClient] (kafka-producer-network-thread | kafka-producer-source-out) [Producer clientId=kafka-producer-source-out] Connection to node -1 (localhost/127.0.0.1:49156) could not be established. Broker may not be available.\r\n2022-01-10 17:34:27,191 WARN  [org.apa.kaf.cli.NetworkClient] (kafka-producer-network-thread | kafka-producer-source-out) [Producer clientId=kafka-producer-source-out] Bootstrap broker localhost:49156 (id: -1 rack: null) disconnected\r\n2022-01-10 17:34:27,362 WARN  [org.apa.kaf.cli.NetworkClient] (smallrye-kafka-consumer-thread-1) [Consumer clientId=kafka-consumer-source-in, groupId=code-with-quarkus] Connection to node -1 (localhost/127.0.0.1:49156) could not be established. Broker may not be available.\r\n2022-01-10 17:34:27,362 WARN  [org.apa.kaf.cli.NetworkClient] (smallrye-kafka-consumer-thread-1) [Consumer clientId=kafka-consumer-source-in, groupId=code-with-quarkus] Bootstrap broker localhost:49156 (id: -1 rack: null) disconnected\r\n2022-01-10 17:34:28,780 WARN  [org.apa.kaf.cli.NetworkClient] (kafka-producer-network-thread | kafka-producer-uppercase-out) [Producer clientId=kafka-producer-uppercase-out] Connection to node -1 (localhost/127.0.0.1:49156) could not be established. Broker may not be available.\r\n2022-01-10 17:34:28,780 WARN  [org.apa.kaf.cli.NetworkClient] (kafka-producer-network-thread | kafka-producer-uppercase-out) [Producer clientId=kafka-producer-uppercase-out] Bootstrap broker localhost:49156 (id: -1 rack: null) disconnected\r\n2022-01-10 17:34:28,826 WARN  [org.apa.kaf.cli.NetworkClient] (smallrye-kafka-consumer-thread-1) [Consumer clientId=kafka-consumer-source-in, groupId=code-with-quarkus] Connection to node -1 (localhost/127.0.0.1:49156) could not be established. Broker may not be available.\r\n2022-01-10 17:34:28,826 WARN  [org.apa.kaf.cli.NetworkClient] (smallrye-kafka-consumer-thread-1) [Consumer clientId=kafka-consumer-source-in, groupId=code-with-quarkus] Bootstrap broker localhost:49156 (id: -1 rack: null) disconnected\r\n2022-01-10 17:34:28,889 WARN  [org.apa.kaf.cli.NetworkClient] (smallrye-kafka-consumer-thread-0) [Consumer clientId=kafka-consumer-uppercase-in, groupId=code-with-quarkus] Connection to node -1 (localhost/127.0.0.1:49156) could not be established. Broker may not be available.\r\n2022-01-10 17:34:28,889 WARN  [org.apa.kaf.cli.NetworkClient] (smallrye-kafka-consumer-thread-0) [Consumer clientId=kafka-consumer-uppercase-in, groupId=code-with-quarkus] Bootstrap broker localhost:49156 (id: -1 rack: null) disconnected\r\n2022-01-10 17:34:28,919 WARN  [org.apa.kaf.cli.NetworkClient] (kafka-producer-network-thread | kafka-producer-source-out) [Producer clientId=kafka-producer-source-out] Connection to node -1 (localhost/127.0.0.1:49156) could not be established. Broker may not be available.\r\n2022-01-10 17:34:28,920 WARN  [org.apa.kaf.cli.NetworkClient] (kafka-producer-network-thread | kafka-producer-source-out) [Producer clientId=kafka-producer-source-out] Bootstrap broker localhost:49156 (id: -1 rack: null) disconnected\r\n```\r\n\r\n### How to Reproduce?\r\n\r\nSteps to Reproduce:\r\n\r\n1. Go to https://code.quarkus.io/?e=smallrye-reactive-messaging-kafka&extension-search=origin:platform%20kafka\r\n2. Download generated project, extract it\r\n3. Run `mvn quarkus:dev`\r\n\r\n### Output of `uname -a` or `ver`\r\n\r\nMicrosoft Windows [Version 10.0.22000.376]\r\n\r\n### Output of `java -version`\r\n\r\nopenjdk version \"17.0.1\" 2021-10-19 OpenJDK Runtime Environment Temurin-17.0.1+12 (build 17.0.1+12) OpenJDK 64-Bit Server VM Temurin-17.0.1+12 (build 17.0.1+12, mixed mode, sharing)\r\n\r\n### GraalVM version (if different from Java)\r\n\r\n_No response_\r\n\r\n### Quarkus version or git rev\r\n\r\n2.6.1.Final\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\nApache Maven 3.8.4 (9b656c72d54e5bacbed989b64718c159fe39b537) Maven home: C:\\ProgramData\\chocolatey\\lib\\maven\\apache-maven-3.8.4 Java version: 17.0.1, vendor: Eclipse Adoptium, runtime: C:\\Program Files\\Eclipse Adoptium\\jdk-17.0.1.12-hotspot Default locale: de_DE, platform encoding: Cp1252 OS name: \"windows 10\", version: \"10.0\", arch: \"amd64\", family: \"windows\"\r\n\r\n### Additional information\r\n\r\n```sh\r\n$ docker --version\r\nDocker version 20.10.11, build dea9396\r\n```\r\n```sh\r\n$ docker ps -a\r\nCONTAINER ID   IMAGE                         COMMAND                  CREATED         STATUS         PORTS                               NAMES\r\n43bb689b4b88   vectorized/redpanda:v21.5.5   \"sh -c 'while [ ! -fâ€¦\"   4 seconds ago   Up 5 seconds   9644/tcp, 0.0.0.0:49157->9092/tcp   distracted_sinoussi\r\n```\r\n<details>\r\n<summary>Docker Inspect</summary>\r\n\r\n```sh\r\n$ docker inspect 43bb689b4b88\r\n[\r\n    {\r\n        \"Id\": \"43bb689b4b88f9a4b5ad56212683b6c9a3a291d73d7c71a14230b1b8bce924e7\",\r\n        \"Created\": \"2022-01-10T16:41:03.347847731Z\",\r\n        \"Path\": \"sh\",\r\n        \"Args\": [\r\n            \"-c\",\r\n            \"while [ ! -f /var/lib/redpanda/redpanda.sh ]; do sleep 0.1; done; /var/lib/redpanda/redpanda.sh\"\r\n        ],\r\n        \"State\": {\r\n            \"Status\": \"running\",\r\n            \"Running\": true,\r\n            \"Paused\": false,\r\n            \"Restarting\": false,\r\n            \"OOMKilled\": false,\r\n            \"Dead\": false,\r\n            \"Pid\": 7817,\r\n            \"ExitCode\": 0,\r\n            \"Error\": \"\",\r\n            \"StartedAt\": \"2022-01-10T16:41:04.849808178Z\",\r\n            \"FinishedAt\": \"0001-01-01T00:00:00Z\"\r\n        },\r\n        \"Image\": \"sha256:98ca2a6da0045c0fb3ffde6a98b354a303216e79cbd82c0341a994383aa73fcb\",\r\n        \"ResolvConfPath\": \"/var/lib/docker/containers/43bb689b4b88f9a4b5ad56212683b6c9a3a291d73d7c71a14230b1b8bce924e7/resolv.conf\",\r\n        \"HostnamePath\": \"/var/lib/docker/containers/43bb689b4b88f9a4b5ad56212683b6c9a3a291d73d7c71a14230b1b8bce924e7/hostname\",\r\n        \"HostsPath\": \"/var/lib/docker/containers/43bb689b4b88f9a4b5ad56212683b6c9a3a291d73d7c71a14230b1b8bce924e7/hosts\",\r\n        \"LogPath\": \"/var/lib/docker/containers/43bb689b4b88f9a4b5ad56212683b6c9a3a291d73d7c71a14230b1b8bce924e7/43bb689b4b88f9a4b5ad56212683b6c9a3a291d73d7c71a14230b1b8bce924e7-json.log\",\r\n        \"Name\": \"/distracted_sinoussi\",\r\n        \"RestartCount\": 0,\r\n        \"Driver\": \"overlay2\",\r\n        \"Platform\": \"linux\",\r\n        \"MountLabel\": \"\",\r\n        \"ProcessLabel\": \"\",\r\n        \"AppArmorProfile\": \"\",\r\n        \"ExecIDs\": null,\r\n        \"HostConfig\": {\r\n            \"Binds\": [],\r\n            \"ContainerIDFile\": \"\",\r\n            \"LogConfig\": {\r\n                \"Type\": \"json-file\",\r\n                \"Config\": {}\r\n            },\r\n            \"NetworkMode\": \"571288e853ccf2cdab20ad617c290be140a587deb6a8fa2224316a6748cc09f7\",\r\n            \"PortBindings\": {\r\n                \"9092/tcp\": [\r\n                    {\r\n                        \"HostIp\": \"\",\r\n                        \"HostPort\": \"0\"\r\n                    }\r\n                ]\r\n            },\r\n            \"RestartPolicy\": {\r\n                \"Name\": \"\",\r\n                \"MaximumRetryCount\": 0\r\n            },\r\n            \"AutoRemove\": false,\r\n            \"VolumeDriver\": \"\",\r\n            \"VolumesFrom\": [],\r\n            \"CapAdd\": null,\r\n            \"CapDrop\": null,\r\n            \"CgroupnsMode\": \"host\",\r\n            \"Dns\": null,\r\n            \"DnsOptions\": null,\r\n            \"DnsSearch\": null,\r\n            \"ExtraHosts\": [],\r\n            \"GroupAdd\": null,\r\n            \"IpcMode\": \"shareable\",\r\n            \"Cgroup\": \"\",\r\n            \"Links\": null,\r\n            \"OomScoreAdj\": 0,\r\n            \"PidMode\": \"\",\r\n            \"Privileged\": false,\r\n            \"PublishAllPorts\": false,\r\n            \"ReadonlyRootfs\": false,\r\n            \"SecurityOpt\": null,\r\n            \"UTSMode\": \"\",\r\n            \"UsernsMode\": \"\",\r\n            \"ShmSize\": 67108864,\r\n            \"Runtime\": \"runc\",\r\n            \"ConsoleSize\": [\r\n                0,\r\n                0\r\n            ],\r\n            \"Isolation\": \"\",\r\n            \"CpuShares\": 0,\r\n            \"Memory\": 0,\r\n            \"NanoCpus\": 0,\r\n            \"CgroupParent\": \"\",\r\n            \"BlkioWeight\": 0,\r\n            \"BlkioWeightDevice\": null,\r\n            \"BlkioDeviceReadBps\": null,\r\n            \"BlkioDeviceWriteBps\": null,\r\n            \"BlkioDeviceReadIOps\": null,\r\n            \"BlkioDeviceWriteIOps\": null,\r\n            \"CpuPeriod\": 0,\r\n            \"CpuQuota\": 0,\r\n            \"CpuRealtimePeriod\": 0,\r\n            \"CpuRealtimeRuntime\": 0,\r\n            \"CpusetCpus\": \"\",\r\n            \"CpusetMems\": \"\",\r\n            \"Devices\": null,\r\n            \"DeviceCgroupRules\": null,\r\n            \"DeviceRequests\": null,\r\n            \"KernelMemory\": 0,\r\n            \"KernelMemoryTCP\": 0,\r\n            \"MemoryReservation\": 0,\r\n            \"MemorySwap\": 0,\r\n            \"MemorySwappiness\": null,\r\n            \"OomKillDisable\": false,\r\n            \"PidsLimit\": null,\r\n            \"Ulimits\": null,\r\n            \"CpuCount\": 0,\r\n            \"CpuPercent\": 0,\r\n            \"IOMaximumIOps\": 0,\r\n            \"IOMaximumBandwidth\": 0,\r\n            \"MaskedPaths\": [\r\n                \"/proc/asound\",\r\n                \"/proc/acpi\",\r\n                \"/proc/kcore\",\r\n                \"/proc/keys\",\r\n                \"/proc/latency_stats\",\r\n                \"/proc/timer_list\",\r\n                \"/proc/timer_stats\",\r\n                \"/proc/sched_debug\",\r\n                \"/proc/scsi\",\r\n                \"/sys/firmware\"\r\n            ],\r\n            \"ReadonlyPaths\": [\r\n                \"/proc/bus\",\r\n                \"/proc/fs\",\r\n                \"/proc/irq\",\r\n                \"/proc/sys\",\r\n                \"/proc/sysrq-trigger\"\r\n            ]\r\n        },\r\n        \"GraphDriver\": {\r\n            \"Data\": {\r\n                \"LowerDir\": \"/var/lib/docker/overlay2/7f42a7a2577b2c9cc2904a42af8506e745c0e5ce488938947413183d06a2fab5-init/diff:/var/lib/docker/overlay2/cb46326572a52dfdb21a8e8222d68c5f9b41b9242485e4d07ceb90d2e4553bfe/diff:/var/lib/docker/overlay2/2c551f41c6000a014134f217fdd60d6eb3119e2aa139f6be396108fad2246ce9/diff:/var/lib/docker/overlay2/f088d0ab6d0188c1e08bcb4f31d7928a707ffabfe73ce2326a67e8aad18157ef/diff:/var/lib/docker/overlay2/45d012e80025c8d2a215d56f16f62d8d6f2c4071f3e369308df98f4adcdc15a0/diff:/var/lib/docker/overlay2/7710b423cdb4c71f4c25753d8759cc141726058b1427979f292295890b59f7e5/diff:/var/lib/docker/overlay2/da3ca8da892bc123e231d2c3896a33a090f875d904b6ae74da24d38a8232bc4f/diff:/var/lib/docker/overlay2/81995f9f90ef2919e51ee0269b93e3ec875b3026c6989b86f3f96cc9a7e22709/diff\",\r\n                \"MergedDir\": \"/var/lib/docker/overlay2/7f42a7a2577b2c9cc2904a42af8506e745c0e5ce488938947413183d06a2fab5/merged\",\r\n                \"UpperDir\": \"/var/lib/docker/overlay2/7f42a7a2577b2c9cc2904a42af8506e745c0e5ce488938947413183d06a2fab5/diff\",\r\n                \"WorkDir\": \"/var/lib/docker/overlay2/7f42a7a2577b2c9cc2904a42af8506e745c0e5ce488938947413183d06a2fab5/work\"\r\n            },\r\n            \"Name\": \"overlay2\"\r\n        },\r\n        \"Mounts\": [\r\n            {\r\n                \"Type\": \"volume\",\r\n                \"Name\": \"6905004583ec1013b84061d51386a843da6a25278a1acb9176200521327439cc\",\r\n                \"Source\": \"/var/lib/docker/volumes/6905004583ec1013b84061d51386a843da6a25278a1acb9176200521327439cc/_data\",\r\n                \"Destination\": \"/var/lib/redpanda/data\",\r\n                \"Driver\": \"local\",\r\n                \"Mode\": \"\",\r\n                \"RW\": true,\r\n                \"Propagation\": \"\"\r\n            }\r\n        ],\r\n        \"Config\": {\r\n            \"Hostname\": \"43bb689b4b88\",\r\n            \"Domainname\": \"\",\r\n            \"User\": \"redpanda\",\r\n            \"AttachStdin\": false,\r\n            \"AttachStdout\": false,\r\n            \"AttachStderr\": false,\r\n            \"ExposedPorts\": {\r\n                \"9092/tcp\": {},\r\n                \"9644/tcp\": {}\r\n            },\r\n            \"Tty\": false,\r\n            \"OpenStdin\": false,\r\n            \"StdinOnce\": false,\r\n            \"Env\": [\r\n                \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\r\n                \"DEBIAN_FRONTEND=noninteractive\"\r\n            ],\r\n            \"Cmd\": [\r\n                \"-c\",\r\n                \"while [ ! -f /var/lib/redpanda/redpanda.sh ]; do sleep 0.1; done; /var/lib/redpanda/redpanda.sh\"\r\n            ],\r\n            \"Image\": \"docker.io/vectorized/redpanda:v21.5.5\",\r\n            \"Volumes\": {\r\n                \"/var/lib/redpanda/data\": {}\r\n            },\r\n            \"WorkingDir\": \"\",\r\n            \"Entrypoint\": [\r\n                \"sh\"\r\n            ],\r\n            \"OnBuild\": null,\r\n            \"Labels\": {\r\n                \"maintainer\": \"Vectorized.io\",\r\n                \"org.testcontainers\": \"true\",\r\n                \"org.testcontainers.sessionId\": \"8c989546-c621-4462-b5f7-89ffdc8c6cb6\",\r\n                \"quarkus-dev-service-kafka\": \"kafka\"\r\n            }\r\n        },\r\n        \"NetworkSettings\": {\r\n            \"Bridge\": \"\",\r\n            \"SandboxID\": \"1a90e1562dd85d895f0050baa8ef82bf6692151bdced5e3bcf7b247d8138e156\",\r\n            \"HairpinMode\": false,\r\n            \"LinkLocalIPv6Address\": \"\",\r\n            \"LinkLocalIPv6PrefixLen\": 0,\r\n            \"Ports\": {\r\n                \"9092/tcp\": [\r\n                    {\r\n                        \"HostIp\": \"0.0.0.0\",\r\n                        \"HostPort\": \"49157\"\r\n                    }\r\n                ],\r\n                \"9644/tcp\": null\r\n            },\r\n            \"SandboxKey\": \"/var/run/docker/netns/1a90e1562dd8\",\r\n            \"SecondaryIPAddresses\": null,\r\n            \"SecondaryIPv6Addresses\": null,\r\n            \"EndpointID\": \"\",\r\n            \"Gateway\": \"\",\r\n            \"GlobalIPv6Address\": \"\",\r\n            \"GlobalIPv6PrefixLen\": 0,\r\n            \"IPAddress\": \"\",\r\n            \"IPPrefixLen\": 0,\r\n            \"IPv6Gateway\": \"\",\r\n            \"MacAddress\": \"\",\r\n            \"Networks\": {\r\n                \"19faf7ba-b3ba-4ad9-bc89-077c3ab06722\": {\r\n                    \"IPAMConfig\": null,\r\n                    \"Links\": null,\r\n                    \"Aliases\": [\r\n                        \"kafka-DfS94\",\r\n                        \"43bb689b4b88\"\r\n                    ],\r\n                    \"NetworkID\": \"571288e853ccf2cdab20ad617c290be140a587deb6a8fa2224316a6748cc09f7\",\r\n                    \"EndpointID\": \"2dac3c297eca6a824fff3af380968a0130458c6e29cf392342f6a0e0e60211f0\",\r\n                    \"Gateway\": \"172.22.0.1\",\r\n                    \"IPAddress\": \"172.22.0.2\",\r\n                    \"IPPrefixLen\": 16,\r\n                    \"IPv6Gateway\": \"\",\r\n                    \"GlobalIPv6Address\": \"\",\r\n                    \"GlobalIPv6PrefixLen\": 0,\r\n                    \"MacAddress\": \"02:42:ac:16:00:02\",\r\n                    \"DriverOpts\": null\r\n                }\r\n            }\r\n        }\r\n    }\r\n]\r\n````\r\n</details>\r\n\r\n----\r\nStarting a Redpanda Container with the following config myself and setting `kafka.bootstrap.servers=localhost:9092` works.\r\n```yml\r\nversion: '3.7'\r\nservices:\r\n  redpanda:\r\n    command:\r\n      - redpanda\r\n      - start\r\n      - --smp\r\n      - '1'\r\n      - --reserve-memory\r\n      - 0M\r\n      - --overprovisioned\r\n      - --node-id\r\n      - '0'\r\n      - --kafka-addr\r\n      - PLAINTEXT://0.0.0.0:29092,OUTSIDE://0.0.0.0:9092\r\n      - --advertise-kafka-addr\r\n      - PLAINTEXT://redpanda:29092,OUTSIDE://localhost:9092\r\n    image: docker.vectorized.io/vectorized/redpanda:v21.11.2\r\n    container_name: redpanda\r\n    ports:\r\n      - \"9092:9092\"\r\n      - \"29092:29092\"\r\n```",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/22775/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/22775/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
