{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/29354",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/29354/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/29354/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/29354/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/29354",
  "id": 1455258514,
  "node_id": "I_kwDOCFbutM5WvXuS",
  "number": 29354,
  "title": "UserError$UserException Feature io.quarkus.runtime.graal.ResourcesFeature class not found on the classpath",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 985346625,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjU=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/triage/invalid",
      "name": "triage/invalid",
      "color": "e4e669",
      "default": false,
      "description": "This doesn't seem right"
    },
    {
      "id": 1676631606,
      "node_id": "MDU6TGFiZWwxNjc2NjMxNjA2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/env/windows",
      "name": "env/windows",
      "color": "edea47",
      "default": false,
      "description": "Impacts Windows machines"
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": null,
  "comments": 5,
  "created_at": "2022-11-18T14:46:17Z",
  "updated_at": "2022-11-21T11:41:54Z",
  "closed_at": "2022-11-21T11:41:47Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nHi,\r\n\r\nI get the following error when I try to build a native image with docker:\r\n```\r\n.\\mvnw.cmd clean install -DskipTests=true -Dnative --define quarkus.native.container-build=true --define quarkus.native.container-runtime=docker --define quarkus.native.builder-image=quay.io/quarkus/ubi-quarkus-mandrel:22.2.0.0-Final-java11 -X\r\n```\r\nI cannot install graalvm locally because of company policy.\r\n\r\n**Error exception:**\r\n```\r\n[ERROR] Failed to execute goal io.quarkus:quarkus-maven-plugin:2.14.1.Final:build (default) on project upd-pdf-properties: Failed to build quarkus appli\r\ncation: io.quarkus.builder.BuildException: Build failure: Build failed due to errors\r\n[ERROR]         [error]: Build step io.quarkus.deployment.pkg.steps.NativeImageBuildStep#build threw an exception: io.quarkus.deployment.pkg.steps.Nativ\r\neImageBuildStep$ImageGenerationFailureException: Image generation failed. Exit code: 127\r\n[ERROR]         at io.quarkus.deployment.pkg.steps.NativeImageBuildStep.imageGenerationFailed(NativeImageBuildStep.java:421)\r\n[ERROR]         at io.quarkus.deployment.pkg.steps.NativeImageBuildStep.build(NativeImageBuildStep.java:262)\r\n[ERROR]         at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n[ERROR]         at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n[ERROR]         at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n[ERROR]         at java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n[ERROR]         at io.quarkus.deployment.ExtensionLoader$3.execute(ExtensionLoader.java:909)\r\n[ERROR]         at io.quarkus.builder.BuildContext.run(BuildContext.java:281)\r\n[ERROR]         at org.jboss.threads.ContextHandler$1.runWith(ContextHandler.java:18)\r\n[ERROR]         at org.jboss.threads.EnhancedQueueExecutor$Task.run(EnhancedQueueExecutor.java:2449)\r\n[ERROR]         at org.jboss.threads.EnhancedQueueExecutor$ThreadBody.run(EnhancedQueueExecutor.java:1478)\r\n[ERROR]         at java.base/java.lang.Thread.run(Thread.java:829)\r\n[ERROR]         at org.jboss.threads.JBossThread.run(JBossThread.java:501)\r\n[ERROR] -> [Help 1]\r\n```\r\n\r\nWhen I run in debug mode, we can see that it failed because of the following error:\r\n```\r\n[1/7] Initializing...                                                                                    (0.0s @ 0.23GB)\r\nError: Feature io.quarkus.runtime.graal.ResourcesFeature class not found on the classpath. Ensure that the name is correct and that the class is on the \r\nclasspath.\r\ncom.oracle.svm.core.util.UserError$UserException: Feature io.quarkus.runtime.graal.ResourcesFeature class not found on the classpath. Ensure that the na\r\nme is correct and that the class is on the classpath.\r\n        at org.graalvm.nativeimage.builder/com.oracle.svm.core.util.UserError.abort(UserError.java:73)\r\n        at org.graalvm.nativeimage.builder/com.oracle.svm.hosted.FeatureHandler.registerFeatures(FeatureHandler.java:175)\r\n        at org.graalvm.nativeimage.builder/com.oracle.svm.hosted.NativeImageGenerator.setupNativeImage(NativeImageGenerator.java:852)\r\n        at org.graalvm.nativeimage.builder/com.oracle.svm.hosted.NativeImageGenerator.doRun(NativeImageGenerator.java:575)\r\n        at org.graalvm.nativeimage.builder/com.oracle.svm.hosted.NativeImageGenerator.run(NativeImageGenerator.java:535)\r\n        at org.graalvm.nativeimage.builder/com.oracle.svm.hosted.NativeImageGeneratorRunner.buildImage(NativeImageGeneratorRunner.java:403)\r\n        at org.graalvm.nativeimage.builder/com.oracle.svm.hosted.NativeImageGeneratorRunner.build(NativeImageGeneratorRunner.java:580)\r\n        at org.graalvm.nativeimage.builder/com.oracle.svm.hosted.NativeImageGeneratorRunner.main(NativeImageGeneratorRunner.java:128)\r\n------------------------------------------------------------------------------------------------------------------------\r\n                         0.6s (4.9% of total time) in 8 GCs | Peak RSS: 0.53GB | CPU load: 1.44\r\n========================================================================================================================\r\nFailed generating 'upd-pdf-properties-1.2-SNAPSHOT-runner' after 10.7s.\r\nError: Image build request failed with exit status 1\r\n```\r\n\r\n**Maven config:**\r\n```\r\n    <dependencyManagement>\r\n        <dependencies>\r\n            <dependency>\r\n                <groupId>io.quarkus</groupId>\r\n                <artifactId>quarkus-bom</artifactId>\r\n                <version>2.14.1.Final</version>\r\n                <type>pom</type>\r\n                <scope>import</scope>\r\n            </dependency>\r\n        </dependencies>\r\n    </dependencyManagement>\r\n\r\n    <dependencies>\r\n        <dependency>\r\n            <groupId>io.quarkus</groupId>\r\n            <artifactId>quarkus-junit5</artifactId>\r\n            <scope>test</scope>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.assertj</groupId>\r\n            <artifactId>assertj-core</artifactId>\r\n            <version>3.23.1</version>\r\n            <scope>test</scope>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.poi</groupId>\r\n            <artifactId>poi</artifactId>\r\n            <version>5.2.2</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.poi</groupId>\r\n            <artifactId>poi-ooxml</artifactId>\r\n            <version>5.2.2</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.slf4j</groupId>\r\n            <artifactId>slf4j-simple</artifactId>\r\n            <version>2.0.3</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.logging.log4j</groupId>\r\n            <artifactId>log4j-core</artifactId>\r\n            <version>2.19.0</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.logging.log4j</groupId>\r\n            <artifactId>log4j-api</artifactId>\r\n            <version>2.19.0</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.pdfbox</groupId>\r\n            <artifactId>pdfbox</artifactId>\r\n            <version>2.0.27</version>\r\n        </dependency>\r\n    </dependencies>\r\n\r\n\r\n    <build>\r\n        <finalName>${project.artifactId}-${project.version}</finalName>\r\n        <plugins>\r\n            <plugin>\r\n                <artifactId>maven-surefire-plugin</artifactId>\r\n                <version>2.22.2</version>\r\n            </plugin>\r\n            <plugin>\r\n                <artifactId>maven-failsafe-plugin</artifactId>\r\n                <version>2.22.2</version>\r\n            </plugin>\r\n            <plugin>\r\n                <groupId>org.codehaus.mojo</groupId>\r\n                <artifactId>exec-maven-plugin</artifactId>\r\n                <version>3.1.0</version>\r\n                <configuration>\r\n                    <executable>java</executable>\r\n                    <arguments>\r\n                        <argument>-Djava.library.path=${project.build.directory}/lib</argument>\r\n                        <argument>-classpath</argument>\r\n                        <classpath/>\r\n                        <argument>test.MainApp</argument>\r\n       \r\n                    </arguments>\r\n                </configuration>\r\n            </plugin>\r\n            <plugin>\r\n                <groupId>org.apache.maven.plugins</groupId>\r\n                <artifactId>maven-compiler-plugin</artifactId>\r\n                <configuration>\r\n                    <source>11</source>\r\n                    <target>11</target>\r\n                </configuration>\r\n                <version>3.8.1</version>\r\n            </plugin>\r\n            <plugin>\r\n                <groupId>org.apache.maven.plugins</groupId>\r\n                <artifactId>maven-shade-plugin</artifactId>\r\n                <version>3.4.1</version>\r\n                <executions>\r\n                    <!-- Run shade goal on package phase -->\r\n                    <execution>\r\n                        <phase>package</phase>\r\n                        <goals>\r\n                            <goal>shade</goal>\r\n                        </goals>\r\n                        <configuration>\r\n                            <transformers>\r\n                                <!-- add Main-Class to manifest file -->\r\n                                <transformer implementation=\"org.apache.maven.plugins.shade.resource.ManifestResourceTransformer\">\r\n                                    <mainClass>test.MainApp</mainClass>\r\n                                </transformer>\r\n                            </transformers>\r\n                        </configuration>\r\n                    </execution>\r\n                </executions>\r\n            </plugin>\r\n            <plugin>\r\n                <groupId>io.quarkus</groupId>\r\n                <artifactId>quarkus-maven-plugin</artifactId>\r\n                <version>2.14.1.Final</version>\r\n                <executions>\r\n                    <execution>\r\n                        <goals>\r\n                            <goal>build</goal>\r\n                        </goals>\r\n                    </execution>\r\n                </executions>\r\n            </plugin>\r\n        </plugins>\r\n    </build>\r\n    <profiles>\r\n        <profile>\r\n            <id>native</id>\r\n            <activation>\r\n                <property>\r\n                    <name>native</name>\r\n                </property>\r\n            </activation>\r\n            <properties>\r\n                <quarkus.package.type>native</quarkus.package.type>\r\n            </properties>\r\n        </profile>\r\n    </profiles>\r\n</project>\r\n```\r\n\r\n### Expected behavior\r\n\r\nBuilding an executable\r\n\r\n### Actual behavior\r\n\r\nFails in the building process\r\n\r\n### How to Reproduce?\r\n\r\nWith maven 3.8.6, on windows 10, openjdk 11.0.7:\r\n```\r\nmvn clean install -Dnative --define quarkus.native.container-build=true --define quarkus.native.container-r\r\nuntime=docker -X\r\n```\r\n\r\n### Output of `uname -a` or `ver`\r\n\r\nMINGW64_NT-10.0-19044 LAP9999 3.3.4-341.x86_64 2022-05-13 22:10 UTC x86_64 Msys\r\n\r\n### Output of `java -version`\r\n\r\nopenjdk version \"11.0.7\" 2020-04-14 LTS OpenJDK Runtime Environment 18.9 (build 11.0.7+10-LTS) OpenJDK 64-Bit Server VM 18.9 (build 11.0.7+10-LTS, mixed mode)\r\n\r\n### GraalVM version (if different from Java)\r\n\r\nnot installed, using the image: quay.io/quarkus/ubi-quarkus-mandrel:22.2.0.0-Final-java11\r\n\r\n### Quarkus version or git rev\r\n\r\n2.14.1.Final\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\nApache Maven 3.8.6\r\n\r\n### Additional information\r\n\r\nWindows 10\r\nDocker engine: v20.10.21 ",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/29354/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/29354/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
