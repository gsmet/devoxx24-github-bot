{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/35402",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35402/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35402/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35402/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/35402",
  "id": 1855056907,
  "node_id": "I_kwDOCFbutM5ukewL",
  "number": 35402,
  "title": "Override Oracle JDBC native-image metadata only when native image is used",
  "labels": [
    {
      "id": 985346622,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjI=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/enhancement",
      "name": "kind/enhancement",
      "color": "a2eeef",
      "default": false,
      "description": "New feature or request"
    },
    {
      "id": 1273026509,
      "node_id": "MDU6TGFiZWwxMjczMDI2NTA5",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/persistence",
      "name": "area/persistence",
      "color": "FBCA04",
      "default": false,
      "description": "OBSOLETE, DO NOT USE"
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/268",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/268",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/268/labels",
    "id": 9776989,
    "node_id": "MI_kwDOCFbutM4AlS9d",
    "number": 268,
    "title": "3.2.5.Final",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 44,
    "state": "closed",
    "created_at": "2023-08-11T19:39:33Z",
    "updated_at": "2023-08-27T18:36:46Z",
    "due_on": null,
    "closed_at": "2023-08-27T18:36:46Z"
  },
  "comments": 1,
  "created_at": "2023-08-17T13:53:37Z",
  "updated_at": "2023-08-24T08:45:16Z",
  "closed_at": "2023-08-23T12:37:52Z",
  "active_lock_reason": null,
  "body": "### Description\r\nThe `OracleMetadataOverrides` class contains build steps, which manage the `native-image` properties of the Oracle JDBC driver and particular resources. However, these build steps are also executed when the native image is not used. Is it intentional? \r\n\r\n### Context\r\nIn Keycloak, we need to exclude the Oracle JDBC driver artifacts(`com.oracle.database.jdbc:ojdbc11`,`com.oracle.database.nls:orai18n`) from distribution due to particular productization issues. It means customers need to manually put the mentioned JARs into the distribution in order to run an instance with the Oracle database. The `quarkus-jdbc-oracle` extension is still present.\r\n\r\nI downloaded the latest Oracle JDBC Driver (23.2.0.0) JAR and included it in the distribution. However, during augmentation, this warning is shown:\r\n```\r\nWARN [io.quarkus.deployment.steps.ClassTransformingBuildStep] (build-19) Could not remove configured resources from the following artifacts as they were not found in the model: {com.oracle.database.jdbc:ojdbc11::jar=[oracle/nativeimage/CharacterSetFeature.class, oracle/nativeimage/Target_java_io_ObjectStreamClass.class]}\r\n```\r\n\r\nRegarding the code, it's clear what's happening with the relationship of the custom JDBC driver. I understand the approach with the custom JDBC driver, and the Oracle JDBC extension is not supported by Quarkus, but we do not have any other option :)\r\n\r\nhttps://github.com/quarkusio/quarkus/blob/8d60118b8572d5861ee1e6091584ef91f9ecb748/extensions/jdbc/jdbc-oracle/deployment/src/main/java/io/quarkus/jdbc/oracle/deployment/OracleMetadataOverrides.java#L150-L160\r\n\r\nBtw. the `oracle/nativeimage/Target_java_io_ObjectStreamClass.class` is not even part of the newest provided Oracle JDBC Driver 23.2.0.0.\r\n\r\n### Summary\r\n\r\nIs it possible to make particular build steps in the `OracleMetadataOverrides` class conditionally enabled only for the native images? Or is there any deeper logic/idea behind it?",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/35402/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35402/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
