{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/35528",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35528/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35528/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35528/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/35528",
  "id": 1865011137,
  "node_id": "I_kwDOCFbutM5vKc_B",
  "number": 35528,
  "title": "flyway with one supported and one unsupported Db throws exception at startup",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1897325810,
      "node_id": "MDU6TGFiZWwxODk3MzI1ODEw",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/flyway",
      "name": "area/flyway",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/277",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/277",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/277/labels",
    "id": 9938825,
    "node_id": "MI_kwDOCFbutM4Al6eJ",
    "number": 277,
    "title": "3.4.1",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 21,
    "state": "closed",
    "created_at": "2023-09-19T15:38:46Z",
    "updated_at": "2023-10-31T17:03:57Z",
    "due_on": null,
    "closed_at": "2023-09-20T14:13:10Z"
  },
  "comments": 17,
  "created_at": "2023-08-24T12:03:17Z",
  "updated_at": "2024-02-29T10:50:16Z",
  "closed_at": "2023-09-19T11:10:01Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nThere is an application wich uses two databases. One postgresql and one database wich is not supported by flyway. \r\n\r\nUntil release 3.3.0 this was no problem. Since migration to 3.3.0 there will be an exception at startup: org.flywaydb.core.api.FlywayException: Unsupported Database\r\n\r\nFor the unsupported db the migration is switched off: quarkus.flyway.olap.migrate-at-start=false\r\n\r\nNo I tried to disable flyway for the specific db. quarkus.flyway.olap.enabled=false\r\n\r\nBut it seems, this parameter is only global, for all connections, available.\r\n\r\n### Expected behavior\r\n\r\npossibility to use flyway with mixed datasources wich are supported and not supported by flyway. This was no problem until Quarkus 3.3.0.\r\n\r\nPerhaps it is a solution to make the property quarkus.flyway.enabled separate for every datasource\r\n\r\n### Actual behavior\r\n\r\nThere is an exception at startup:\r\n```posh\r\n2023-08-24 13:38:48,070 ERROR [io.qua.run.Application] (Quarkus Main Thread) Failed to start application (with profile [devprod, dev]): java.lang.RuntimeException: Failed to start quarkus\r\n\tat io.quarkus.runner.ApplicationImpl.doStart(Unknown Source)\r\n\tat io.quarkus.runtime.Application.start(Application.java:101)\r\n\tat io.quarkus.runtime.ApplicationLifecycleManager.run(ApplicationLifecycleManager.java:111)\r\n\tat io.quarkus.runtime.Quarkus.run(Quarkus.java:71)\r\n\tat io.quarkus.runtime.Quarkus.run(Quarkus.java:44)\r\n\tat io.quarkus.runtime.Quarkus.run(Quarkus.java:124)\r\n\tat io.quarkus.runner.GeneratedMain.main(Unknown Source)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:568)\r\n\tat io.quarkus.runner.bootstrap.StartupActionImpl$1.run(StartupActionImpl.java:104)\r\n\tat java.base/java.lang.Thread.run(Thread.java:833)\r\nCaused by: jakarta.enterprise.inject.CreationException: Error creating synthetic bean [0f016e26a2915694b42fad485772394a44058251]: org.flywaydb.core.api.FlywayException: Unsupported Database: ClickHouse 23.7\r\n\tat io.quarkus.flyway.runtime.FlywayContainer_0f016e26a2915694b42fad485772394a44058251_Synthetic_Bean.doCreate(Unknown Source)\r\n\tat io.quarkus.flyway.runtime.FlywayContainer_0f016e26a2915694b42fad485772394a44058251_Synthetic_Bean.create(Unknown Source)\r\n\tat io.quarkus.flyway.runtime.FlywayContainer_0f016e26a2915694b42fad485772394a44058251_Synthetic_Bean.create(Unknown Source)\r\n\tat io.quarkus.arc.impl.AbstractSharedContext.createInstanceHandle(AbstractSharedContext.java:113)\r\n\tat io.quarkus.arc.impl.AbstractSharedContext$1.get(AbstractSharedContext.java:37)\r\n\tat io.quarkus.arc.impl.AbstractSharedContext$1.get(AbstractSharedContext.java:34)\r\n\tat io.quarkus.arc.impl.LazyValue.get(LazyValue.java:32)\r\n\tat io.quarkus.arc.impl.ComputingCache.computeIfAbsent(ComputingCache.java:69)\r\n\tat io.quarkus.arc.impl.AbstractSharedContext.get(AbstractSharedContext.java:34)\r\n\tat io.quarkus.flyway.runtime.FlywayContainer_0f016e26a2915694b42fad485772394a44058251_Synthetic_Bean.get(Unknown Source)\r\n\tat io.quarkus.flyway.runtime.FlywayContainer_0f016e26a2915694b42fad485772394a44058251_Synthetic_Bean.get(Unknown Source)\r\n\tat io.quarkus.arc.impl.Instances$3.get(Instances.java:132)\r\n\tat io.quarkus.arc.impl.LazyValue.get(LazyValue.java:32)\r\n\tat io.quarkus.arc.impl.LazyInstanceHandle.instanceInternal(LazyInstanceHandle.java:32)\r\n\tat io.quarkus.arc.impl.AbstractInstanceHandle.get(AbstractInstanceHandle.java:46)\r\n\tat io.quarkus.flyway.runtime.FlywayRecorder.doStartActions(FlywayRecorder.java:96)\r\n\tat io.quarkus.deployment.steps.FlywayProcessor$startActions2035800939.deploy_0(Unknown Source)\r\n\tat io.quarkus.deployment.steps.FlywayProcessor$startActions2035800939.deploy(Unknown Source)\r\n\t... 13 more\r\nCaused by: org.flywaydb.core.api.FlywayException: Unsupported Database: ClickHouse 23.7\r\n\tat org.flywaydb.core.internal.database.DatabaseTypeRegister.getDatabaseTypeForConnection(DatabaseTypeRegister.java:105)\r\n\tat org.flywaydb.core.api.configuration.ClassicConfiguration.setDataSource(ClassicConfiguration.java:1091)\r\n\tat org.flywaydb.core.api.configuration.FluentConfiguration.dataSource(FluentConfiguration.java:624)\r\n\tat io.quarkus.flyway.runtime.FlywayCreator.createFlyway(FlywayCreator.java:71)\r\n\tat io.quarkus.flyway.runtime.FlywayContainerProducer.createFlyway(FlywayContainerProducer.java:53)\r\n\tat io.quarkus.flyway.runtime.FlywayRecorder$1.apply(FlywayRecorder.java:66)\r\n\tat io.quarkus.flyway.runtime.FlywayRecorder$1.apply(FlywayRecorder.java:57)\r\n\tat io.quarkus.flyway.runtime.FlywayContainer_0f016e26a2915694b42fad485772394a44058251_Synthetic_Bean.createSynthetic(Unknown Source)\r\n\t... 31 more\r\n```\r\n\r\n### How to Reproduce?\r\n\r\n_No response_\r\n\r\n### Output of `uname -a` or `ver`\r\n\r\n_No response_\r\n\r\n### Output of `java -version`\r\n\r\n_No response_\r\n\r\n### GraalVM version (if different from Java)\r\n\r\n_No response_\r\n\r\n### Quarkus version or git rev\r\n\r\n_No response_\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\n_No response_\r\n\r\n### Additional information\r\n\r\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/35528/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35528/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
