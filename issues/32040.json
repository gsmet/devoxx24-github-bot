{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/32040",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/32040/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/32040/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/32040/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/32040",
  "id": 1635878008,
  "node_id": "I_kwDOCFbutM5hgYR4",
  "number": 32040,
  "title": "Hibernate Reactive - trouble using identity generation strategy",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1273026509,
      "node_id": "MDU6TGFiZWwxMjczMDI2NTA5",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/persistence",
      "name": "area/persistence",
      "color": "FBCA04",
      "default": false,
      "description": "OBSOLETE, DO NOT USE"
    },
    {
      "id": 2122256208,
      "node_id": "MDU6TGFiZWwyMTIyMjU2MjA4",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/hibernate-reactive",
      "name": "area/hibernate-reactive",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/241",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/241",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/241/labels",
    "id": 9190762,
    "node_id": "MI_kwDOCFbutM4AjD1q",
    "number": 241,
    "title": "3.0.0.CR1",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 127,
    "state": "closed",
    "created_at": "2023-03-22T09:42:22Z",
    "updated_at": "2023-04-02T16:24:01Z",
    "due_on": null,
    "closed_at": "2023-03-30T13:52:01Z"
  },
  "comments": 5,
  "created_at": "2023-03-22T14:28:46Z",
  "updated_at": "2023-03-24T07:58:01Z",
  "closed_at": "2023-03-24T07:57:56Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nOur app has 2 tables - one is using `ReactiveIdentifierGenerator`, the other is using `IDENTITY`, with Hibernate Reactive 2.0.0.Alpha2 I get casting exception when creating new instance.\r\n\r\n### Expected behavior\r\n\r\nI realize there is https://github.com/quarkusio/quarkus/issues/31974 so that documentation can't be perfect yet, but I'd appreciate hit if the problem is on my side or Quarks side.\r\n\r\n### Actual behavior\r\n\r\nException message\r\n```\r\n15:16:07,950 INFO  [app] org.hibernate.HibernateException: java.lang.ClassCastException: class org.hibernate.id.insert.GetGeneratedKeysDelegate cannot be cast to class org.hibernate.reactive.id.insert.ReactiveInsertGeneratedIdentifierDelegate (org.hibernate.id.insert.GetGeneratedKeysDelegate and org.hibernate.reactive.id.insert.ReactiveInsertGeneratedIdentifierDelegate are in unnamed module of loader io.quarkus.bootstrap.runner.RunnerClassLoader @799f7e29)\r\n15:16:07,950 INFO  [app] \tat org.hibernate.reactive.session.impl.ReactiveExceptionConverter.convert(ReactiveExceptionConverter.java:28)\r\n15:16:07,950 INFO  [app] \tat org.hibernate.reactive.session.impl.ReactiveSessionImpl.lambda$doFlush$29(ReactiveSessionImpl.java:1110)\r\n15:16:07,951 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:934)\r\n15:16:07,951 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.uniHandleStage(CompletableFuture.java:950)\r\n15:16:07,951 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.handle(CompletableFuture.java:2340)\r\n15:16:07,951 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.handle(CompletableFuture.java:144)\r\n15:16:07,951 INFO  [app] \tat org.hibernate.reactive.session.impl.ReactiveSessionImpl.doFlush(ReactiveSessionImpl.java:1105)\r\n15:16:07,952 INFO  [app] \tat org.hibernate.reactive.session.impl.ReactiveSessionImpl.reactiveFlush(ReactiveSessionImpl.java:1052)\r\n15:16:07,952 INFO  [app] \tat io.smallrye.context.impl.wrappers.SlowContextualSupplier.get(SlowContextualSupplier.java:21)\r\n15:16:07,952 INFO  [app] \tat io.smallrye.mutiny.operators.uni.builders.UniCreateFromCompletionStage.subscribe(UniCreateFromCompletionStage.java:24)\r\n15:16:07,952 INFO  [app] \tat io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:36)\r\n15:16:07,952 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniRunSubscribeOn.lambda$subscribe$0(UniRunSubscribeOn.java:27)\r\n15:16:07,952 INFO  [app] \tat org.hibernate.reactive.context.impl.VertxContext.execute(VertxContext.java:90)\r\n15:16:07,953 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniRunSubscribeOn.subscribe(UniRunSubscribeOn.java:25)\r\n15:16:07,953 INFO  [app] \tat io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:36)\r\n15:16:07,953 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransformToUni$UniOnItemTransformToUniProcessor.performInnerSubscription(UniOnItemTransformToUni.java:81)\r\n15:16:07,953 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransformToUni$UniOnItemTransformToUniProcessor.onItem(UniOnItemTransformToUni.java:57)\r\n15:16:07,953 INFO  [app] \tat io.smallrye.mutiny.operators.uni.builders.UniCreateFromKnownItem$KnownItemSubscription.forward(UniCreateFromKnownItem.java:38)\r\n15:16:07,953 INFO  [app] \tat io.smallrye.mutiny.operators.uni.builders.UniCreateFromKnownItem.subscribe(UniCreateFromKnownItem.java:23)\r\n15:16:07,953 INFO  [app] \tat io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:36)\r\n15:16:07,953 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransformToUni.subscribe(UniOnItemTransformToUni.java:25)\r\n15:16:07,953 INFO  [app] \tat io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:36)\r\n15:16:07,954 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransformToUni$UniOnItemTransformToUniProcessor.performInnerSubscription(UniOnItemTransformToUni.java:81)\r\n15:16:07,954 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransformToUni$UniOnItemTransformToUniProcessor.onItem(UniOnItemTransformToUni.java:57)\r\n15:16:07,954 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransformToUni$UniOnItemTransformToUniProcessor.onItem(UniOnItemTransformToUni.java:60)\r\n15:16:07,954 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOperatorProcessor.onItem(UniOperatorProcessor.java:47)\r\n15:16:07,954 INFO  [app] \tat io.smallrye.mutiny.operators.uni.builders.UniCreateFromCompletionStage$CompletionStageUniSubscription.forwardResult(UniCreateFromCompletionStage.java:63)\r\n15:16:07,954 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863)\r\n15:16:07,954 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.uniWhenCompleteStage(CompletableFuture.java:887)\r\n15:16:07,955 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.whenComplete(CompletableFuture.java:2325)\r\n15:16:07,955 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.whenComplete(CompletableFuture.java:144)\r\n15:16:07,955 INFO  [app] \tat io.smallrye.mutiny.operators.uni.builders.UniCreateFromCompletionStage$CompletionStageUniSubscription.forward(UniCreateFromCompletionStage.java:51)\r\n15:16:07,955 INFO  [app] \tat io.smallrye.mutiny.operators.uni.builders.UniCreateFromCompletionStage.subscribe(UniCreateFromCompletionStage.java:35)\r\n15:16:07,955 INFO  [app] \tat io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:36)\r\n15:16:07,955 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniRunSubscribeOn.lambda$subscribe$0(UniRunSubscribeOn.java:27)\r\n15:16:07,955 INFO  [app] \tat org.hibernate.reactive.context.impl.VertxContext.execute(VertxContext.java:90)\r\n15:16:07,955 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniRunSubscribeOn.subscribe(UniRunSubscribeOn.java:25)\r\n15:16:07,956 INFO  [app] \tat io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:36)\r\n15:16:07,956 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransformToUni$UniOnItemTransformToUniProcessor.performInnerSubscription(UniOnItemTransformToUni.java:81)\r\n15:16:07,956 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransformToUni$UniOnItemTransformToUniProcessor.onItem(UniOnItemTransformToUni.java:57)\r\n15:16:07,956 INFO  [app] \tat io.smallrye.mutiny.operators.uni.builders.UniCreateFromKnownItem$KnownItemSubscription.forward(UniCreateFromKnownItem.java:38)\r\n15:16:07,956 INFO  [app] \tat io.smallrye.mutiny.operators.uni.builders.UniCreateFromKnownItem.subscribe(UniCreateFromKnownItem.java:23)\r\n15:16:07,956 INFO  [app] \tat io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:36)\r\n15:16:07,956 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransformToUni.subscribe(UniOnItemTransformToUni.java:25)\r\n15:16:07,956 INFO  [app] \tat io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:36)\r\n15:16:07,956 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransformToUni.subscribe(UniOnItemTransformToUni.java:25)\r\n15:16:07,957 INFO  [app] \tat io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:36)\r\n15:16:07,957 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransform.subscribe(UniOnItemTransform.java:22)\r\n15:16:07,957 INFO  [app] \tat io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:36)\r\n15:16:07,957 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransformToUni.subscribe(UniOnItemTransformToUni.java:25)\r\n15:16:07,957 INFO  [app] \tat io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:36)\r\n15:16:07,957 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransformToUni.subscribe(UniOnItemTransformToUni.java:25)\r\n15:16:07,957 INFO  [app] \tat io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:36)\r\n15:16:07,957 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnFailureFlatMap.subscribe(UniOnFailureFlatMap.java:31)\r\n15:16:07,957 INFO  [app] \tat io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:36)\r\n15:16:07,958 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnCancellationCall.subscribe(UniOnCancellationCall.java:27)\r\n15:16:07,958 INFO  [app] \tat io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:36)\r\n15:16:07,958 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransformToUni.subscribe(UniOnItemTransformToUni.java:25)\r\n15:16:07,958 INFO  [app] \tat io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:36)\r\n15:16:07,958 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransformToUni.subscribe(UniOnItemTransformToUni.java:25)\r\n15:16:07,958 INFO  [app] \tat io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:36)\r\n15:16:07,958 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransformToUni$UniOnItemTransformToUniProcessor.performInnerSubscription(UniOnItemTransformToUni.java:81)\r\n15:16:07,959 INFO  [app] \tat io.smallrye.mutiny.operators.uni.UniOnItemTransformToUni$UniOnItemTransformToUniProcessor.onItem(UniOnItemTransformToUni.java:57)\r\n15:16:07,959 INFO  [app] \tat io.smallrye.mutiny.operators.uni.builders.UniCreateFromCompletionStage$CompletionStageUniSubscription.forwardResult(UniCreateFromCompletionStage.java:63)\r\n15:16:07,959 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863)\r\n15:16:07,959 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841)\r\n15:16:07,959 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)\r\n15:16:07,959 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147)\r\n15:16:07,960 INFO  [app] \tat io.vertx.core.Future.lambda$toCompletionStage$3(Future.java:384)\r\n15:16:07,960 INFO  [app] \tat io.vertx.core.impl.future.FutureImpl$3.onSuccess(FutureImpl.java:141)\r\n15:16:07,960 INFO  [app] \tat io.vertx.core.impl.future.FutureImpl$ListenerArray.onSuccess(FutureImpl.java:262)\r\n15:16:07,960 INFO  [app] \tat io.vertx.core.impl.future.FutureBase.emitSuccess(FutureBase.java:60)\r\n15:16:07,960 INFO  [app] \tat io.vertx.core.impl.future.FutureImpl.tryComplete(FutureImpl.java:211)\r\n15:16:07,960 INFO  [app] \tat io.vertx.core.impl.future.PromiseImpl.tryComplete(PromiseImpl.java:23)\r\n15:16:07,960 INFO  [app] \tat io.vertx.core.impl.future.PromiseImpl.onSuccess(PromiseImpl.java:49)\r\n15:16:07,961 INFO  [app] \tat io.vertx.core.impl.future.PromiseImpl.handle(PromiseImpl.java:41)\r\n15:16:07,961 INFO  [app] \tat io.vertx.sqlclient.impl.TransactionImpl.lambda$wrap$0(TransactionImpl.java:72)\r\n15:16:07,961 INFO  [app] \tat io.vertx.core.impl.future.FutureImpl$3.onSuccess(FutureImpl.java:141)\r\n15:16:07,961 INFO  [app] \tat io.vertx.core.impl.future.FutureBase.lambda$emitSuccess$0(FutureBase.java:54)\r\n15:16:07,961 INFO  [app] \tat io.vertx.core.impl.EventLoopContext.execute(EventLoopContext.java:86)\r\n15:16:07,961 INFO  [app] \tat io.vertx.core.impl.DuplicatedContext.execute(DuplicatedContext.java:163)\r\n15:16:07,961 INFO  [app] \tat io.vertx.core.impl.future.FutureBase.emitSuccess(FutureBase.java:51)\r\n15:16:07,962 INFO  [app] \tat io.vertx.core.impl.future.FutureImpl.tryComplete(FutureImpl.java:211)\r\n15:16:07,962 INFO  [app] \tat io.vertx.core.impl.future.PromiseImpl.tryComplete(PromiseImpl.java:23)\r\n15:16:07,962 INFO  [app] \tat io.vertx.core.impl.future.PromiseImpl.onSuccess(PromiseImpl.java:49)\r\n15:16:07,962 INFO  [app] \tat io.vertx.core.impl.future.PromiseImpl.handle(PromiseImpl.java:41)\r\n15:16:07,962 INFO  [app] \tat io.vertx.core.impl.future.PromiseImpl.handle(PromiseImpl.java:23)\r\n15:16:07,962 INFO  [app] \tat io.vertx.pgclient.impl.PgSocketConnection.lambda$doSchedule$2(PgSocketConnection.java:155)\r\n15:16:07,962 INFO  [app] \tat io.vertx.sqlclient.impl.command.CommandResponse.fire(CommandResponse.java:46)\r\n15:16:07,962 INFO  [app] \tat io.vertx.sqlclient.impl.SocketConnectionBase.handleMessage(SocketConnectionBase.java:292)\r\n15:16:07,962 INFO  [app] \tat io.vertx.pgclient.impl.PgSocketConnection.handleMessage(PgSocketConnection.java:97)\r\n15:16:07,963 INFO  [app] \tat io.vertx.sqlclient.impl.SocketConnectionBase.lambda$init$0(SocketConnectionBase.java:105)\r\n15:16:07,963 INFO  [app] \tat io.vertx.core.impl.EventLoopContext.emit(EventLoopContext.java:55)\r\n15:16:07,963 INFO  [app] \tat io.vertx.core.impl.ContextBase.emit(ContextBase.java:239)\r\n15:16:07,963 INFO  [app] \tat io.vertx.core.net.impl.NetSocketImpl.handleMessage(NetSocketImpl.java:390)\r\n15:16:07,963 INFO  [app] \tat io.vertx.core.net.impl.ConnectionBase.read(ConnectionBase.java:157)\r\n15:16:07,963 INFO  [app] \tat io.vertx.core.net.impl.VertxHandler.channelRead(VertxHandler.java:153)\r\n15:16:07,963 INFO  [app] \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\r\n15:16:07,963 INFO  [app] \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\r\n15:16:07,964 INFO  [app] \tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\r\n15:16:07,964 INFO  [app] \tat io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\r\n15:16:07,964 INFO  [app] \tat io.vertx.pgclient.impl.codec.PgEncoder.lambda$write$0(PgEncoder.java:98)\r\n15:16:07,964 INFO  [app] \tat io.vertx.pgclient.impl.codec.PgCommandCodec.handleReadyForQuery(PgCommandCodec.java:139)\r\n15:16:07,964 INFO  [app] \tat io.vertx.pgclient.impl.codec.PgDecoder.decodeReadyForQuery(PgDecoder.java:237)\r\n15:16:07,964 INFO  [app] \tat io.vertx.pgclient.impl.codec.PgDecoder.channelRead(PgDecoder.java:96)\r\n15:16:07,964 INFO  [app] \tat io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\r\n15:16:07,964 INFO  [app] \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\r\n15:16:07,964 INFO  [app] \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\r\n15:16:07,964 INFO  [app] \tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\r\n15:16:07,964 INFO  [app] \tat io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\r\n15:16:07,964 INFO  [app] \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\r\n15:16:07,965 INFO  [app] \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\r\n15:16:07,965 INFO  [app] \tat io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\r\n15:16:07,965 INFO  [app] \tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\r\n15:16:07,965 INFO  [app] \tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)\r\n15:16:07,965 INFO  [app] \tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)\r\n15:16:07,965 INFO  [app] \tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)\r\n15:16:07,965 INFO  [app] \tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\r\n15:16:07,965 INFO  [app] \tat io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)\r\n15:16:07,966 INFO  [app] \tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\r\n15:16:07,966 INFO  [app] \tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n15:16:07,966 INFO  [app] \tat java.base/java.lang.Thread.run(Thread.java:833)\r\n15:16:07,966 INFO  [app] Caused by: java.lang.ClassCastException: class org.hibernate.id.insert.GetGeneratedKeysDelegate cannot be cast to class org.hibernate.reactive.id.insert.ReactiveInsertGeneratedIdentifierDelegate (org.hibernate.id.insert.GetGeneratedKeysDelegate and org.hibernate.reactive.id.insert.ReactiveInsertGeneratedIdentifierDelegate are in unnamed module of loader io.quarkus.bootstrap.runner.RunnerClassLoader @799f7e29)\r\n15:16:07,966 INFO  [app] \tat org.hibernate.reactive.engine.jdbc.mutation.internal.ReactiveMutationExecutorPostInsertSingleTable.executeReactive(ReactiveMutationExecutorPostInsertSingleTable.java:66)\r\n15:16:07,966 INFO  [app] \tat org.hibernate.reactive.persister.entity.mutation.ReactiveInsertCoordinator.lambda$doStaticInserts$9(ReactiveInsertCoordinator.java:166)\r\n15:16:07,966 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187)\r\n15:16:07,967 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309)\r\n15:16:07,967 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:144)\r\n15:16:07,967 INFO  [app] \tat org.hibernate.reactive.persister.entity.mutation.ReactiveInsertCoordinator.doStaticInserts(ReactiveInsertCoordinator.java:166)\r\n15:16:07,967 INFO  [app] \tat org.hibernate.reactive.persister.entity.mutation.ReactiveInsertCoordinator.lambda$coordinateReactiveInsert$0(ReactiveInsertCoordinator.java:54)\r\n15:16:07,967 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187)\r\n15:16:07,967 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309)\r\n15:16:07,967 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:144)\r\n15:16:07,967 INFO  [app] \tat org.hibernate.reactive.persister.entity.mutation.ReactiveInsertCoordinator.coordinateReactiveInsert(ReactiveInsertCoordinator.java:51)\r\n15:16:07,967 INFO  [app] \tat org.hibernate.reactive.persister.entity.impl.ReactiveSingleTableEntityPersister.insertReactive(ReactiveSingleTableEntityPersister.java:242)\r\n15:16:07,968 INFO  [app] \tat org.hibernate.reactive.engine.impl.ReactiveEntityIdentityInsertAction.lambda$reactiveExecute$0(ReactiveEntityIdentityInsertAction.java:65)\r\n15:16:07,968 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187)\r\n15:16:07,968 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309)\r\n15:16:07,968 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:144)\r\n15:16:07,968 INFO  [app] \tat org.hibernate.reactive.engine.impl.ReactiveEntityIdentityInsertAction.reactiveExecute(ReactiveEntityIdentityInsertAction.java:65)\r\n15:16:07,968 INFO  [app] \tat org.hibernate.reactive.engine.ReactiveActionQueue.lambda$executeActions$9(ReactiveActionQueue.java:646)\r\n15:16:07,968 INFO  [app] \tat org.hibernate.reactive.util.impl.CompletionStages.lambda$loop$7(CompletionStages.java:373)\r\n15:16:07,968 INFO  [app] \tat org.hibernate.reactive.util.impl.CompletionStages$ArrayLoop.next(CompletionStages.java:447)\r\n15:16:07,969 INFO  [app] \tat org.hibernate.reactive.util.async.impl.AsyncTrampoline.lambda$asyncWhile$1(AsyncTrampoline.java:215)\r\n15:16:07,969 INFO  [app] \tat org.hibernate.reactive.util.async.impl.AsyncTrampoline$TrampolineInternal.unroll(AsyncTrampoline.java:121)\r\n15:16:07,969 INFO  [app] \tat org.hibernate.reactive.util.async.impl.AsyncTrampoline$TrampolineInternal.trampoline(AsyncTrampoline.java:102)\r\n15:16:07,969 INFO  [app] \tat org.hibernate.reactive.util.async.impl.AsyncTrampoline.asyncWhile(AsyncTrampoline.java:197)\r\n15:16:07,969 INFO  [app] \tat org.hibernate.reactive.util.async.impl.AsyncTrampoline.asyncWhile(AsyncTrampoline.java:215)\r\n15:16:07,969 INFO  [app] \tat org.hibernate.reactive.util.impl.CompletionStages.loop(CompletionStages.java:374)\r\n15:16:07,969 INFO  [app] \tat org.hibernate.reactive.util.impl.CompletionStages.loop(CompletionStages.java:345)\r\n15:16:07,969 INFO  [app] \tat org.hibernate.reactive.engine.ReactiveActionQueue.executeActions(ReactiveActionQueue.java:643)\r\n15:16:07,970 INFO  [app] \tat org.hibernate.reactive.engine.ReactiveActionQueue.lambda$executeActions$7(ReactiveActionQueue.java:543)\r\n15:16:07,970 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187)\r\n15:16:07,970 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309)\r\n15:16:07,970 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:144)\r\n15:16:07,970 INFO  [app] \tat org.hibernate.reactive.engine.ReactiveActionQueue.executeActions(ReactiveActionQueue.java:543)\r\n15:16:07,970 INFO  [app] \tat org.hibernate.reactive.event.impl.AbstractReactiveFlushingEventListener.lambda$performExecutions$0(AbstractReactiveFlushingEventListener.java:64)\r\n15:16:07,970 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187)\r\n15:16:07,970 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309)\r\n15:16:07,970 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:144)\r\n15:16:07,971 INFO  [app] \tat org.hibernate.reactive.event.impl.AbstractReactiveFlushingEventListener.performExecutions(AbstractReactiveFlushingEventListener.java:58)\r\n15:16:07,971 INFO  [app] \tat org.hibernate.reactive.event.impl.DefaultReactiveFlushEventListener.lambda$reactiveOnFlush$0(DefaultReactiveFlushEventListener.java:40)\r\n15:16:07,971 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187)\r\n15:16:07,971 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309)\r\n15:16:07,971 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:144)\r\n15:16:07,971 INFO  [app] \tat org.hibernate.reactive.event.impl.DefaultReactiveFlushEventListener.reactiveOnFlush(DefaultReactiveFlushEventListener.java:40)\r\n15:16:07,972 INFO  [app] \tat org.hibernate.event.service.internal.EventListenerGroupImpl.lambda$fireEventOnEachListener$0(EventListenerGroupImpl.java:153)\r\n15:16:07,972 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187)\r\n15:16:07,972 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309)\r\n15:16:07,972 INFO  [app] \tat java.base/java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:144)\r\n15:16:07,972 INFO  [app] \tat org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:153)\r\n15:16:07,972 INFO  [app] \tat org.hibernate.reactive.session.impl.ReactiveSessionImpl.doFlush(ReactiveSessionImpl.java:1104)\r\n15:16:07,972 INFO  [app] \t... 115 more\r\n```\r\n\r\n### How to Reproduce?\r\n\r\nI've got 2 reproducers. First one is for the exception described above:\r\n1. `git clone git@github.com:michalvavrik/quarkus-test-suite.git`\r\n2. `cd quarkus-test-suite`\r\n3. `git checkout enable-hibernate-reactive-modules`\r\n4. `cd sql-db/hibernate-reactive`\r\n5. `mvn clean verify -Dit.test=PostgresqlDatabaseHibernateReactiveIT#createBookWithGeneratedId`\r\n\r\nI also tried to compare my test with Quarkus integration tests and when I added `@GeneratedValue(strategy = GenerationType.IDENTITY)` as you can see here https://github.com/quarkusio/quarkus/compare/main...michalvavrik:quarkus:reproducer/hibernate-reactive-identity, I got exception `org.hibernate.HibernateException: java.util.concurrent.CompletionException: java.lang.ClassCastException: class org.hibernate.id.IdentityGenerator cannot be cast to class org.hibernate.id.IdentifierGenerator`. I don't understand why shouldn't I be able to use identity as I can see that Hibernate Reactive own tests are using it without extra configuration, f.e. https://github.com/hibernate/hibernate-reactive/blob/main/hibernate-reactive-core/src/test/java/org/hibernate/reactive/ReactiveStatelessProxyUpdateTest.java#L180\r\n\r\n### Output of `uname -a` or `ver`\r\n\r\nLinux\r\n\r\n### Output of `java -version`\r\n\r\nopenjdk 17.0.4 2022-07-19\r\n\r\n### GraalVM version (if different from Java)\r\n\r\nOpenJDK Runtime Environment GraalVM CE 23.2\r\n\r\n### Quarkus version or git rev\r\n\r\n999-SNAPSHOT\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\nApache Maven 3.8.6\r\n\r\n### Additional information\r\n\r\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/32040/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/32040/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
