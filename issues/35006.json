{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/35006",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35006/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35006/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35006/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/35006",
  "id": 1820557522,
  "node_id": "I_kwDOCFbutM5sg4DS",
  "number": 35006,
  "title": "quarkus-kubernetes Extension ignores multiple sidecars properties",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1654772125,
      "node_id": "MDU6TGFiZWwxNjU0NzcyMTI1",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/kubernetes",
      "name": "area/kubernetes",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/264",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/264",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/264/labels",
    "id": 9694439,
    "node_id": "MI_kwDOCFbutM4Ak-zn",
    "number": 264,
    "title": "3.2.3.Final",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 62,
    "state": "closed",
    "created_at": "2023-07-25T12:04:44Z",
    "updated_at": "2023-08-09T14:47:41Z",
    "due_on": null,
    "closed_at": "2023-08-02T12:57:21Z"
  },
  "comments": 3,
  "created_at": "2023-07-25T15:08:44Z",
  "updated_at": "2023-07-28T16:01:04Z",
  "closed_at": "2023-07-26T09:13:41Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nWhen using the quarkus-kubernetes extension and configuring it to add a side car container to the deployment spec, some of the configuration properties, that are documented under https://quarkus.io/guides/deploying-to-kubernetes, are ignored and take no effect on the generated kubernetes spec file.\r\n\r\nSpecifically, the properties\r\n\r\n- quarkus.kubernetes.sidecars.\"sidecars\".image-pull-policy\r\n- quarkus.kubernetes.sidecars.\"sidecars\".resources.limits.cpu\r\n- quarkus.kubernetes.sidecars.\"sidecars\".resources.limits.memory\r\n- quarkus.kubernetes.sidecars.\"sidecars\".resources.requests.cpu\r\n- quarkus.kubernetes.sidecars.\"sidecars\".resources.requests.memory\r\n\r\nDo not result in the desired kubernetes spec output.\r\n\r\nExample properties:\r\n```\r\nquarkus.kubernetes.sidecars.my-sidecar.image-pull-policy=always\r\nquarkus.kubernetes.sidecars.my-sidecar.resources.requests.memory=200Mi\r\nquarkus.kubernetes.sidecars.my-sidecar.resources.limits.memory=200Mi\r\nquarkus.kubernetes.sidecars.my-sidecar.resources.requests.cpu=100m\r\nquarkus.kubernetes.sidecars.my-sidecar.resources.limits.cpu=100m\r\n```\n\n### Expected behavior\n\nAn entry in the kubernetes spec file for the side car container is generated with the properties:\r\n\r\n```\r\n          name: my-sidecar\r\n          imagePullPolicy: Always\r\n          resources:\r\n            limits:\r\n              cpu: 100m\r\n              memory: 200Mi\r\n            requests:\r\n              cpu: 100m\r\n              memory: 200Mi\r\n```\n\n### Actual behavior\n\nA sidecar container entry in the kubernetes spec file is generated missing the configured properties (imagePullPolicy is set to the default of IfNotPresent and the resources field is completely missing):\r\n\r\n```\r\n          name: my-sidecar\r\n          imagePullPolicy: IfNotPresent\r\n```\n\n### How to Reproduce?\n\n1. Follow the example of https://quarkus.io/guides/deploying-to-kubernetes\r\n2. Add side car configurations from the above example\r\n3. Run mvn package\r\n4. Check target/kubernetes/kubernetes.yml\n\n### Output of `uname -a` or `ver`\n\n$ uname -a Linux NB-PF3ALRDL 5.10.102.1-microsoft-standard-WSL2 #1 SMP Wed Mar 2 00:30:59 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux\n\n### Output of `java -version`\n\n$ java -version openjdk version \"17.0.6\" 2023-01-17 OpenJDK Runtime Environment (build 17.0.6+10-Ubuntu-0ubuntu120.04.1) OpenJDK 64-Bit Server VM (build 17.0.6+10-Ubuntu-0ubuntu120.04.1, mixed mode, sharing)\n\n### GraalVM version (if different from Java)\n\n_No response_\n\n### Quarkus version or git rev\n\n2.16.8.Final\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\n$ ./mvnw --version Apache Maven 3.8.6 (84538c9988a25aec085021c365c560670ad80f63) Maven home: /home/user/.m2/wrapper/dists/apache-maven-3.8.6-bin/67568434/apache-maven-3.8.6 Java version: 17.0.6, vendor: Private Build, runtime: /usr/lib/jvm/java-17-openjdk-amd64 Default locale: en, platform encoding: UTF-8 OS name: \"linux\", version: \"5.10.102.1-microsoft-standard-wsl2\", arch: \"amd64\", family: \"unix\"\n\n### Additional information\n\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/35006/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35006/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
