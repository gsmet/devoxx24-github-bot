{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/26982",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/26982/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/26982/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/26982/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/26982",
  "id": 1320519225,
  "node_id": "I_kwDOCFbutM5OtYY5",
  "number": 26982,
  "title": "Native Build Failed While Use Camel-Pdf",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": null,
  "comments": 1,
  "created_at": "2022-07-28T07:34:36Z",
  "updated_at": "2022-07-28T07:41:09Z",
  "closed_at": "2022-07-28T07:41:07Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nWith `camel-quarkus-pdf`, i am able to generate image from the pdf file.\r\nMy reference code is [here](https://github.com/dilipdhankecha2530/quarkus-pdf-to-image).\r\nI am able to run the code but while creating the native image it will come up with below error message.\r\n\r\n```\r\n22.1-java11: Pulling from quarkus/ubi-quarkus-native-image\r\nDigest: sha256:04464863cd626543e58f3058e168985b3be0597f55fa3de29c4a48191e89fe1b\r\nStatus: Image is up to date for quay.io/quarkus/ubi-quarkus-native-image:22.1-java11\r\nquay.io/quarkus/ubi-quarkus-native-image:22.1-java11\r\n========================================================================================================================\r\nGraalVM Native Image: Generating 'code-with-quarkus-1.0.0-SNAPSHOT-runner' (executable)...\r\n========================================================================================================================\r\n[1/7] Initializing...                                                                                   (16.4s @ 0.30GB)\r\n Version info: 'GraalVM 22.1.0 Java 11 CE'\r\n C compiler: gcc (redhat, x86_64, 8.5.0)\r\n Garbage collector: Serial GC\r\n 4 user-provided feature(s)\r\n  - io.quarkus.awt.runtime.graal.AwtFeature\r\n  - io.quarkus.runner.AutoFeature\r\n  - io.quarkus.runtime.graal.DisableLoggingAutoFeature\r\n  - io.quarkus.runtime.graal.ResourcesFeature\r\n12:03:06,572 WARN  [org.apa.pdf.pdm.fon.FileSystemFontProvider] New fonts found, font cache will be re-built\r\n12:03:06,577 WARN  [org.apa.pdf.pdm.fon.FileSystemFontProvider] Building on-disk font cache, this may take a while\r\n12:03:06,706 WARN  [org.apa.pdf.pdm.fon.FileSystemFontProvider] Finished building on-disk font cache, found 9 fonts\r\n[2/7] Performing analysis...  [*]                                                                       (51.3s @ 4.23GB)\r\n  10,478 (81.87%) of 12,798 classes reachable\r\n  15,560 (68.03%) of 22,872 fields reachable\r\n  57,342 (59.63%) of 96,162 methods reachable\r\n     543 classes,    23 fields, and 3,608 methods registered for reflection\r\n\r\nError: java.util.concurrent.ExecutionException: com.oracle.graal.pointsto.constraints.UnsupportedFeatureException: No instances of java.awt.image.ColorConvertOp are allowed in the image heap as this class should be initialized at image runtime. To see how this object got instantiated use --trace-object-instantiation=java.awt.image.ColorConvertOp.\r\ncom.oracle.graal.pointsto.util.AnalysisError: java.util.concurrent.ExecutionException: com.oracle.graal.pointsto.constraints.UnsupportedFeatureException: No instances of java.awt.image.ColorConvertOp are allowed in the image heap as this class should be initialized at image runtime. To see how this object got instantiated use --trace-object-instantiation=java.awt.image.ColorConvertOp.\r\n        at com.oracle.graal.pointsto.util.AnalysisError.shouldNotReachHere(AnalysisError.java:172)\r\n        at com.oracle.graal.pointsto.util.AnalysisFuture.ensureDone(AnalysisFuture.java:66)\r\n        at com.oracle.graal.pointsto.heap.ImageHeapScanner.lambda$postTask$9(ImageHeapScanner.java:611)\r\n        at com.oracle.graal.pointsto.util.CompletionExecutor.executeCommand(CompletionExecutor.java:193)\r\n        at com.oracle.graal.pointsto.util.CompletionExecutor.lambda$executeService$0(CompletionExecutor.java:177)\r\n        at java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1426)\r\n        at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290)\r\n        at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1020)\r\n        at java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:1656)\r\n        at java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1594)\r\n        at java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:183)\r\nCaused by: java.util.concurrent.ExecutionException: com.oracle.graal.pointsto.constraints.UnsupportedFeatureException: No instances of java.awt.image.ColorConvertOp are allowed in the image heap as this class should be initialized at image runtime. To see how this object got instantiated use --trace-object-instantiation=java.awt.image.ColorConvertOp.\r\n        at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)\r\n        at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)\r\n        at com.oracle.graal.pointsto.util.AnalysisFuture.ensureDone(AnalysisFuture.java:64)\r\n        ... 9 more\r\nCaused by: com.oracle.graal.pointsto.constraints.UnsupportedFeatureException: No instances of java.awt.image.ColorConvertOp are allowed in the image heap as this class should be initialized at image runtime. To see how this object got instantiated use --trace-object-instantiation=java.awt.image.ColorConvertOp.\r\n        at com.oracle.svm.hosted.classinitialization.ClassInitializationFeature.checkImageHeapInstance(ClassInitializationFeature.java:135)\r\n        at com.oracle.graal.pointsto.meta.AnalysisUniverse.replaceObject(AnalysisUniverse.java:582)\r\n        at com.oracle.svm.hosted.ameta.AnalysisConstantReflectionProvider.replaceObject(AnalysisConstantReflectionProvider.java:257)\r\n------------------------------------------------------------------------------------------------------------------------\r\n        at com.oracle.svm.hosted.ameta.AnalysisConstantReflectionProvider.interceptValue(AnalysisConstantReflectionProvider.java:228)\r\n        at com.oracle.svm.hosted.heap.SVMImageHeapScanner.transformFieldValue(SVMImageHeapScanner.java:126)\r\n        at com.oracle.graal.pointsto.heap.ImageHeapScanner.onFieldValueReachable(ImageHeapScanner.java:331)\r\n        at com.oracle.graal.pointsto.heap.ImageHeapScanner.lambda$createImageHeapObject$3(ImageHeapScanner.java:272)\r\n        at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\r\n        at com.oracle.graal.pointsto.util.AnalysisFuture.ensureDone(AnalysisFuture.java:63)\r\n        ... 9 more\r\n                        2.7s (3.8% of total time) in 21 GCs | Peak RSS: 4.96GB | CPU load: 6.43\r\n========================================================================================================================\r\nFailed generating 'code-with-quarkus-1.0.0-SNAPSHOT-runner' after 1m 8s.\r\nError: Image build request failed with exit status 1\r\n> Task :quarkusBuild FAILED\r\n\r\nFAILURE: Build failed with an exception.\r\n\r\n* What went wrong:\r\nExecution failed for task ':quarkusBuild'.\r\n> io.quarkus.builder.BuildException: Build failure: Build failed due to errors\r\n        [error]: Build step io.quarkus.deployment.pkg.steps.NativeImageBuildStep#build threw an exception: io.quarkus.deployment.pkg.steps.NativeImageBuildStep$ImageGenerationFailureException: Image generation failed. Exit code: 1\r\n        at io.quarkus.deployment.pkg.steps.NativeImageBuildStep.imageGenerationFailed(NativeImageBuildStep.java:400)\r\n        at io.quarkus.deployment.pkg.steps.NativeImageBuildStep.build(NativeImageBuildStep.java:240)\r\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\r\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.base/java.lang.reflect.Method.invoke(Method.java:568)\r\n        at io.quarkus.deployment.ExtensionLoader$3.execute(ExtensionLoader.java:944)\r\n        at io.quarkus.builder.BuildContext.run(BuildContext.java:277)\r\n        at org.jboss.threads.ContextHandler$1.runWith(ContextHandler.java:18)\r\n        at org.jboss.threads.EnhancedQueueExecutor$Task.run(EnhancedQueueExecutor.java:2449)\r\n        at org.jboss.threads.EnhancedQueueExecutor$ThreadBody.run(EnhancedQueueExecutor.java:1478)\r\n        at java.base/java.lang.Thread.run(Thread.java:833)\r\n        at org.jboss.threads.JBossThread.run(JBossThread.java:501)\r\n\r\n\r\n* Try:\r\n> Run with --stacktrace option to get the stack trace.\r\n> Run with --info or --debug option to get more log output.\r\n> Run with --scan to get full insights.\r\n\r\n* Get more help at https://help.gradle.org\r\n\r\nBUILD FAILED in 1m 17s\r\n6 actionable tasks: 1 executed, 5 up-to-date\r\n```\r\nIs there any configuration i missed?\r\n\r\n### Expected behavior\r\n\r\nBuild must be successful and binary file works fine with lambda function or Rest API.\r\n\r\n",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/26982/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/26982/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
