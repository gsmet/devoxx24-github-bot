{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/25732",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/25732/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/25732/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/25732/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/25732",
  "id": 1245299769,
  "node_id": "I_kwDOCFbutM5KOcQ5",
  "number": 25732,
  "title": "Unable to change unauthenticated response with `quarkus-resteasy-reactive`",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1282139374,
      "node_id": "MDU6TGFiZWwxMjgyMTM5Mzc0",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/security",
      "name": "area/security",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/206",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/206",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/206/labels",
    "id": 8420367,
    "node_id": "MI_kwDOCFbutM4AgHwP",
    "number": 206,
    "title": "2.14.0.CR1",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 224,
    "state": "closed",
    "created_at": "2022-09-14T06:18:10Z",
    "updated_at": "2023-05-15T13:54:56Z",
    "due_on": null,
    "closed_at": "2022-10-26T12:52:36Z"
  },
  "comments": 22,
  "created_at": "2022-05-23T14:56:23Z",
  "updated_at": "2022-10-14T11:37:41Z",
  "closed_at": "2022-10-14T11:37:37Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nI tried to add a custom exception mapper for unauthenticated exceptions. Followed the instruction on https://quarkus.io/guides/security-built-in-authentication#how-to-customize-authentication-exception-responses. However, although the exception mapper is defined, it's never being invoked. Switching the proactive auth on and off does not have any impact.\r\n\r\nThe exception mapper is the same as in the documentation:\r\n\r\n```\r\nimport io.quarkus.security.AuthenticationFailedException;\r\n\r\nimport javax.annotation.Priority;\r\nimport javax.ws.rs.Priorities;\r\nimport javax.ws.rs.core.Context;\r\nimport javax.ws.rs.core.Response;\r\nimport javax.ws.rs.core.UriInfo;\r\nimport javax.ws.rs.ext.ExceptionMapper;\r\nimport javax.ws.rs.ext.Provider;\r\n\r\n\r\n@Provider\r\n@Priority(Priorities.AUTHENTICATION)\r\npublic class AuthenticationFailedExceptionMapper implements ExceptionMapper<AuthenticationFailedException> {\r\n\r\n    @Context\r\n    UriInfo uriInfo;\r\n\r\n    @Override\r\n    public Response toResponse(AuthenticationFailedException exception) {\r\n        // on purpose change to 5xx\r\n        return Response.status(500).entity(\"Custom body\").build();\r\n    }\r\n}\r\n```\r\n\r\n### Expected behavior\r\n\r\nResponse can be customized.\r\n\r\n### Actual behavior\r\n\r\nAlways returns the same response:\r\n\r\n```\r\n$ curl 'http://localhost:8080/hello' -u scott:wrong -v\r\n*   Trying 127.0.0.1:8080...\r\n* TCP_NODELAY set\r\n* Connected to localhost (127.0.0.1) port 8080 (#0)\r\n* Server auth using Basic with user 'scott'\r\n> GET /hello HTTP/1.1\r\n> Host: localhost:8080\r\n> Authorization: Basic c2NvdHQ6cmVhZGU=\r\n> User-Agent: curl/7.68.0\r\n> Accept: */*\r\n> \r\n* Mark bundle as not supporting multiuse\r\n< HTTP/1.1 401 Unauthorized\r\n* Authentication problem. Ignoring this.\r\n< www-authenticate: basic realm=\"Quarkus\"\r\n< content-length: 0\r\n< \r\n* Connection #0 to host localhost left intact\r\n```\r\n\r\n### How to Reproduce?\r\n\r\nHere is the reproducible example: https://github.com/ivansenic/quarkus-25732\r\n\r\n### Output of `uname -a` or `ver`\r\n\r\nLinux ise-Precision-5550 5.13.0-41-generic #46~20.04.1-Ubuntu SMP Wed Apr 20 13:16:21 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n### Output of `java -version`\r\n\r\nopenjdk version \"17.0.3\" 2022-04-19 OpenJDK Runtime Environment (build 17.0.3+7-Ubuntu-0ubuntu0.20.04.1) OpenJDK 64-Bit Server VM (build 17.0.3+7-Ubuntu-0ubuntu0.20.04.1, mixed mode, sharing)\r\n\r\n### GraalVM version (if different from Java)\r\n\r\n_No response_\r\n\r\n### Quarkus version or git rev\r\n\r\n2.9.1.Final\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\nMaven home: /home/ise/.m2/wrapper/dists/apache-maven-3.8.4-bin/52ccbt68d252mdldqsfsn03jlf/apache-maven-3.8.4 Java version: 17.0.3, vendor: Private Build, runtime: /usr/lib/jvm/java-17-openjdk-amd64 Default locale: en_US, platform encoding: UTF-8 OS name: \"linux\", version: \"5.13.0-41-generic\", arch: \"amd64\", family: \"unix\"\r\n\r\n### Additional information\r\n\r\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/25732/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/25732/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
