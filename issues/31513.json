{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/31513",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/31513/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/31513/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/31513/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/31513",
  "id": 1605077562,
  "node_id": "I_kwDOCFbutM5fq4o6",
  "number": 31513,
  "title": "Hot reloading in dev mode not working in 3.0.0.Alpha4",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": null,
  "comments": 16,
  "created_at": "2023-03-01T14:26:36Z",
  "updated_at": "2023-05-31T17:50:58Z",
  "closed_at": "2023-03-01T14:44:38Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nI have a maven multi module project with several quarkus modules. They communicate between each other with microservices. Quarkus module is using [ org.apache.myfaces.core.extensions.quarkus](https://github.com/apache/myfaces/tree/3.0.x) and [quarkus-omnifaces](https://github.com/quarkiverse/quarkus-omnifaces/tree/quarkus3).\r\n\r\nWhen I launched the quarkus module in dev mode I got the following NPE after the first hot reloading:\r\n\r\n```\r\n[INFO] --- quarkus-maven-plugin:3.0.0.Alpha4:dev (default-cli) @ quarkus-webapp ---\r\n[INFO] Invoking io.smallrye:jandex-maven-plugin:3.0.5:jandex @ quarkus-webapp\r\n[INFO] Saving Jandex index: /home/toto/workspaces/workspace_quarkus_poc/quarkus_poc/quarkus-webapp/target/classes/META-INF/jandex.idx\r\n[INFO] Invoking org.apache.maven.plugins:maven-resources-plugin:3.3.0:testResources @ quarkus-webapp\r\n[INFO] Copying 2 resources\r\n[INFO] Invoking org.apache.maven.plugins:maven-compiler-plugin:3.10.1:testCompile @ quarkus-webapp\r\n[INFO] Changes detected - recompiling the module!\r\n[INFO] Compiling 32 source files to /home/okyn/workspaces/workspace_quarkus_poc/quarkus_poc/quarkus-webapp/target/test-classes\r\n\r\nListening for transport dt_socket at address: 5006\r\n2023-03-01 10:54:10,114 INFO  [org.jberet] (build-57) JBERET000030: Resolved job file:/home/okyn/workspaces/workspace_quarkus_poc/quarkus_poc/quarkus-webapp/target/classes/META-INF/batch-jobs/priorityUpdate.xml\r\n2023-03-01 10:54:10,144 INFO  [org.jberet] (build-57) JBERET000030: Resolved job file:/home/okyn/workspaces/workspace_quarkus_poc/quarkus_poc/quarkus-webapp/target/classes/META-INF/batch-jobs/loadTask.xml\r\n2023-03-01 10:54:11,025 WARN  [io.qua.arc.pro.BeanArchives] (build-48) Failed to index javax.enterprise.util.AnnotationLiteral: Class does not exist in ClassLoader QuarkusClassLoader:Deployment Class Loader: DEV@6f36c2f0\r\n2023-03-01 10:54:11,027 INFO  [io.qua.arc.pro.IndexClassLookupUtils] (build-48) Class for name: javax.enterprise.util.AnnotationLiteral was not found in Jandex index. Please ensure the class is part of the index.\r\n2023-03-01 10:54:11,028 WARN  [io.qua.arc.pro.BeanArchives] (build-48) Failed to index org.jboss.resteasy.plugins.providers.jackson.ResteasyJackson2Provider: Class does not exist in ClassLoader QuarkusClassLoader:Deployment Class Loader: DEV@6f36c2f0\r\n2023-03-01 10:54:11,029 INFO  [io.qua.arc.pro.IndexClassLookupUtils] (build-48) Class for name: org.jboss.resteasy.plugins.providers.jackson.ResteasyJackson2Provider was not found in Jandex index. Please ensure the class is part of the index.\r\n\r\n2023-03-01 10:54:12,289 WARN  [io.qua.dep.ste.ClassTransformingBuildStep] (build-43) Could not remove configured resources from the following artifacts as they were not found in the model: [org.keycloak:keycloak-admin-client::jar]\r\n__  ____  __  _____   ___  __ ____  ______ \r\n --/ __ \\/ / / / _ | / _ \\/ //_/ / / / __/ \r\n -/ /_/ / /_/ / __ |/ , _/ ,< / /_/ /\\ \\   \r\n--\\___\\_\\____/_/ |_/_/|_/_/|_|\\____/___/   \r\n\r\n2023-03-01 10:54:14,277 INFO  [org.apa.myf.web.MyFacesContainerInitializer] (Quarkus Main Thread) Using org.apache.myfaces.webapp.MyFacesContainerInitializer\r\n2023-03-01 10:54:14,279 INFO  [org.omn.ApplicationInitializer] (Quarkus Main Thread) Using OmniFaces version 4.1-SNAPSHOT\r\n2023-03-01 10:54:14,599 INFO  [org.apa.myf.uti.ExternalSpecifications] (Quarkus Main Thread) MyFaces Core Bean Validation support disabled\r\n2023-03-01 10:54:14,613 INFO  [org.apa.myf.uti.ExternalSpecifications] (Quarkus Main Thread) MyFaces Core CDI support enabled\r\n2023-03-01 10:54:14,629 INFO  [org.pri.web.PostConstructApplicationEventListener] (Quarkus Main Thread) Running on PrimeFaces 12.0.0\r\n2023-03-01 10:54:14,650 INFO  [io.und.websockets] (Quarkus Main Thread) UT026005: Adding programmatic server endpoint class org.apache.myfaces.push.EndpointImpl for path /jakarta.faces.push/{channel}\r\n2023-03-01 10:54:14,653 INFO  [org.apa.myf.vie.fac.ViewPoolProcessor] (Quarkus Main Thread) jakarta.faces.FACELETS_REFRESH_PERIOD web config parameter is set to \"1\". To enable view pooling this param must be set to \"-1\". View Pooling disabled.\r\n2023-03-01 10:54:14,742 INFO  [org.apa.myf.web.FacesInitializerImpl] (Quarkus Main Thread) MyFaces Core has started, it took [425] ms.\r\n\r\n2023-03-01 10:54:15,826 INFO  [io.quarkus] (Quarkus Main Thread) quarkus-webapp 4.4-SNAPSHOT on JVM (powered by Quarkus 3.0.0.Alpha4) started in 6.324s. Listening on: http://localhost:8080\r\n2023-03-01 10:54:15,828 INFO  [io.quarkus] (Quarkus Main Thread) Profile devlocal activated. Live Coding activated.\r\n2023-03-01 10:54:15,828 INFO  [io.quarkus] (Quarkus Main Thread) Installed features: [agroal, cdi, config-jdbc, hibernate-orm, jberet, jdbc-postgresql, myfaces, narayana-jta, omnifaces, rest-client-reactive, rest-client-reactive-jackson, resteasy-reactive, resteasy-reactive-jackson, scheduler, servlet, smallrye-context-propagation, smallrye-openapi, swagger-ui, vertx, websockets, websockets-client]\r\n2023-03-01 10:54:29,720 INFO  [io.qua.dep.dev.RuntimeUpdatesProcessor] (vert.x-worker-thread-0) Restarting quarkus due to changes in HomePageBean.class, SensorSiteInformation.class.\r\n\r\n2023-03-01 10:54:29,800 INFO  [io.quarkus] (Quarkus Main Thread) quarkus-webapp stopped in 0.078s\r\n\r\n2023-03-01 10:54:29,906 INFO  [org.jberet] (build-4) JBERET000030: Resolved job file:/home/okyn/workspaces/workspace_quarkus_poc/quarkus_poc/quarkus-webapp/target/classes/META-INF/batch-jobs/priorityUpdate.xml\r\n2023-03-01 10:54:29,915 INFO  [org.jberet] (build-4) JBERET000030: Resolved job file:/home/okyn/workspaces/workspace_quarkus_poc/quarkus_poc/quarkus-webapp/target/classes/META-INF/batch-jobs/loadTask.xml\r\n\r\n2023-03-01 10:54:30,760 WARN  [io.qua.dep.ste.ClassTransformingBuildStep] (build-28) Could not remove configured resources from the following artifacts as they were not found in the model: [org.keycloak:keycloak-admin-client::jar]\r\njava.lang.reflect.InvocationTargetException\r\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n\tat java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)\r\n\tat org.apache.myfaces.core.extensions.quarkus.runtime.spi.QuarkusFactoryFinderProvider.getFactory(QuarkusFactoryFinderProvider.java:72)\r\n\tat jdk.internal.reflect.GeneratedMethodAccessor341.invoke(Unknown Source)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat jakarta.faces.FactoryFinder.getFactory(FactoryFinder.java:220)\r\n\tat org.apache.myfaces.context.FacesContextFactoryImpl.<init>(FacesContextFactoryImpl.java:119)\r\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n\tat java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)\r\n\tat org.apache.myfaces.core.extensions.quarkus.runtime.spi.QuarkusFactoryFinderProvider.getFactory(QuarkusFactoryFinderProvider.java:72)\r\n\tat jdk.internal.reflect.GeneratedMethodAccessor341.invoke(Unknown Source)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat jakarta.faces.FactoryFinder.getFactory(FactoryFinder.java:220)\r\n\tat jakarta.faces.webapp.FacesServlet.init(FacesServlet.java:140)\r\n\tat io.undertow.servlet.core.LifecyleInterceptorInvocation.proceed(LifecyleInterceptorInvocation.java:118)\r\n\tat io.undertow.servlet.core.ManagedServlet$DefaultInstanceStrategy.start(ManagedServlet.java:295)\r\n\tat io.undertow.servlet.core.ManagedServlet.createServlet(ManagedServlet.java:140)\r\n\tat io.undertow.servlet.core.DeploymentManagerImpl$2.call(DeploymentManagerImpl.java:585)\r\n\tat io.undertow.servlet.core.DeploymentManagerImpl$2.call(DeploymentManagerImpl.java:556)\r\n\tat io.undertow.servlet.core.ServletRequestContextThreadSetupAction$1.call(ServletRequestContextThreadSetupAction.java:42)\r\n\tat io.undertow.servlet.core.ContextClassLoaderSetupAction$1.call(ContextClassLoaderSetupAction.java:43)\r\n\tat io.quarkus.undertow.runtime.UndertowDeploymentRecorder$9$1.call(UndertowDeploymentRecorder.java:580)\r\n\tat io.undertow.servlet.core.DeploymentManagerImpl.start(DeploymentManagerImpl.java:598)\r\n\tat io.quarkus.undertow.runtime.UndertowDeploymentRecorder.bootServletContainer(UndertowDeploymentRecorder.java:522)\r\n\tat io.quarkus.deployment.steps.UndertowBuildStep$build767851419.deploy_2(Unknown Source)\r\n\tat io.quarkus.deployment.steps.UndertowBuildStep$build767851419.deploy(Unknown Source)\r\n\tat io.quarkus.runner.ApplicationImpl.<clinit>(Unknown Source)\r\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n\tat java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)\r\n\tat io.quarkus.runtime.Quarkus.run(Quarkus.java:70)\r\n\tat io.quarkus.runtime.Quarkus.run(Quarkus.java:44)\r\n\tat io.quarkus.runtime.Quarkus.run(Quarkus.java:124)\r\n\tat io.quarkus.runner.GeneratedMain.main(Unknown Source)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat io.quarkus.runner.bootstrap.StartupActionImpl$1.run(StartupActionImpl.java:104)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\nCaused by: java.lang.NullPointerException\r\n\tat org.apache.myfaces.config.RuntimeConfig.getCurrentInstance(RuntimeConfig.java:121)\r\n\tat org.apache.myfaces.application.ApplicationImpl.<init>(ApplicationImpl.java:239)\r\n\tat org.apache.myfaces.application.ApplicationFactoryImpl.createAndLogNewApplication(ApplicationFactoryImpl.java:55)\r\n\tat org.apache.myfaces.application.ApplicationFactoryImpl.<init>(ApplicationFactoryImpl.java:50)\r\n\t... 47 more\r\n__  ____  __  _____   ___  __ ____  ______ \r\n --/ __ \\/ / / / _ | / _ \\/ //_/ / / / __/ \r\n -/ /_/ / /_/ / __ |/ , _/ ,< / /_/ /\\ \\   \r\n--\\___\\_\\____/_/ |_/_/|_/_/|_|\\____/___/   \r\n\r\n2023-03-01 10:54:31,366 INFO  [org.apa.myf.web.MyFacesContainerInitializer] (Quarkus Main Thread) Using org.apache.myfaces.webapp.MyFacesContainerInitializer\r\n2023-03-01 10:54:31,366 INFO  [org.omn.ApplicationInitializer] (Quarkus Main Thread) Using OmniFaces version 4.1-SNAPSHOT\r\n2023-03-01 10:54:31,818 INFO  [io.quarkus] (Quarkus Main Thread) quarkus-webapp 4.4-SNAPSHOT on JVM (powered by Quarkus 3.0.0.Alpha4) started in 2.014s. Listening on: http://localhost:8080\r\n2023-03-01 10:54:31,818 INFO  [io.quarkus] (Quarkus Main Thread) Profile devlocal activated. Live Coding activated.\r\n2023-03-01 10:54:31,819 INFO  [io.quarkus] (Quarkus Main Thread) Installed features: [agroal, cdi, config-jdbc, hibernate-orm, jberet, jdbc-postgresql, myfaces, narayana-jta, omnifaces, rest-client-reactive, rest-client-reactive-jackson, resteasy-reactive, resteasy-reactive-jackson, scheduler, servlet, smallrye-context-propagation, smallrye-openapi, swagger-ui, vertx, websockets, websockets-client]\r\n2023-03-01 10:54:31,819 INFO  [io.qua.dep.dev.RuntimeUpdatesProcessor] (vert.x-worker-thread-0) Live reload total time: 2.749s \r\n2023-03-01 10:54:31,861 INFO  [org.apa.myf.uti.ExternalSpecifications] (executor-thread-0) MyFaces Core Servlet 6.0 support enabled\r\n2023-03-01 10:54:31,863 WARNING [org.apa.myf.ren.RenderKitFactoryImpl] (executor-thread-0) Unknown RenderKit 'HTML_BASIC'.\r\n2023-03-01 10:54:31,878 ERROR [io.und.req.io] (executor-thread-0) Exception handling request 8cba57a8-fb4a-40cf-8d12-24046f8034cf-1 to /home.xhtml: jakarta.servlet.ServletException\r\n\tat jakarta.faces.webapp.FacesServlet.service(FacesServlet.java:255)\r\n\tat io.undertow.servlet.handlers.ServletHandler.handleRequest(ServletHandler.java:74)\r\n\tat io.undertow.servlet.handlers.security.ServletSecurityRoleHandler.handleRequest(ServletSecurityRoleHandler.java:63)\r\n\tat io.undertow.servlet.handlers.ServletChain$1.handleRequest(ServletChain.java:68)\r\n\tat io.undertow.servlet.handlers.ServletDispatchingHandler.handleRequest(ServletDispatchingHandler.java:36)\r\n\tat io.undertow.servlet.handlers.RedirectDirHandler.handleRequest(RedirectDirHandler.java:67)\r\n\tat io.undertow.servlet.handlers.security.SSLInformationAssociationHandler.handleRequest(SSLInformationAssociationHandler.java:133)\r\n\tat io.undertow.servlet.handlers.security.ServletAuthenticationCallHandler.handleRequest(ServletAuthenticationCallHandler.java:57)\r\n\tat io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)\r\n\tat io.undertow.security.handlers.AbstractConfidentialityHandler.handleRequest(AbstractConfidentialityHandler.java:46)\r\n\tat io.undertow.servlet.handlers.security.ServletConfidentialityConstraintHandler.handleRequest(ServletConfidentialityConstraintHandler.java:65)\r\n\tat io.undertow.security.handlers.AuthenticationMechanismsHandler.handleRequest(AuthenticationMechanismsHandler.java:60)\r\n\tat io.undertow.servlet.handlers.security.CachedAuthenticatedSessionHandler.handleRequest(CachedAuthenticatedSessionHandler.java:77)\r\n\tat io.undertow.security.handlers.NotificationReceiverHandler.handleRequest(NotificationReceiverHandler.java:50)\r\n\tat io.undertow.security.handlers.AbstractSecurityContextAssociationHandler.handleRequest(AbstractSecurityContextAssociationHandler.java:43)\r\n\tat io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)\r\n\tat io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)\r\n\tat io.undertow.servlet.handlers.ServletInitialHandler.handleFirstRequest(ServletInitialHandler.java:247)\r\n\tat io.undertow.servlet.handlers.ServletInitialHandler.access$100(ServletInitialHandler.java:56)\r\n\tat io.undertow.servlet.handlers.ServletInitialHandler$2.call(ServletInitialHandler.java:111)\r\n\tat io.undertow.servlet.handlers.ServletInitialHandler$2.call(ServletInitialHandler.java:108)\r\n\tat io.undertow.servlet.core.ServletRequestContextThreadSetupAction$1.call(ServletRequestContextThreadSetupAction.java:48)\r\n\tat io.undertow.servlet.core.ContextClassLoaderSetupAction$1.call(ContextClassLoaderSetupAction.java:43)\r\n\tat io.quarkus.undertow.runtime.UndertowDeploymentRecorder$9$1.call(UndertowDeploymentRecorder.java:602)\r\n\tat io.undertow.servlet.handlers.ServletInitialHandler.dispatchRequest(ServletInitialHandler.java:227)\r\n\tat io.undertow.servlet.handlers.ServletInitialHandler.handleRequest(ServletInitialHandler.java:152)\r\n\tat io.quarkus.undertow.runtime.UndertowDeploymentRecorder$1.handleRequest(UndertowDeploymentRecorder.java:120)\r\n\tat io.undertow.server.Connectors.executeRootHandler(Connectors.java:284)\r\n\tat io.undertow.server.DefaultExchangeHandler.handle(DefaultExchangeHandler.java:18)\r\n\tat io.quarkus.undertow.runtime.UndertowDeploymentRecorder$5$1.run(UndertowDeploymentRecorder.java:417)\r\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)\r\n\tat java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\r\n\tat io.quarkus.vertx.core.runtime.VertxCoreRecorder$14.runWith(VertxCoreRecorder.java:576)\r\n\tat org.jboss.threads.EnhancedQueueExecutor$Task.run(EnhancedQueueExecutor.java:2449)\r\n\tat org.jboss.threads.EnhancedQueueExecutor$ThreadBody.run(EnhancedQueueExecutor.java:1478)\r\n\tat org.jboss.threads.DelegatingRunnable.run(DelegatingRunnable.java:29)\r\n\tat org.jboss.threads.ThreadLocalResettingRunnable.run(ThreadLocalResettingRunnable.java:29)\r\n\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\nCaused by: java.lang.NullPointerException\r\n\tat org.apache.myfaces.lifecycle.RestoreViewSupport.isPostback(RestoreViewSupport.java:81)\r\n\tat org.apache.myfaces.lifecycle.RestoreViewExecutor.execute(RestoreViewExecutor.java:133)\r\n\tat org.apache.myfaces.lifecycle.LifecycleImpl.executePhase(LifecycleImpl.java:172)\r\n\tat org.apache.myfaces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:125)\r\n\tat jakarta.faces.webapp.FacesServlet.service(FacesServlet.java:223)\r\n\t... 38 more\r\n```\r\n\r\n\r\n### Expected behavior\r\n\r\nBe able to have a hot reloading working\r\n\r\n### Actual behavior\r\n\r\nWhen I launch the application in dev mode it works. But, if I modify my code, the hot reloading failed with a NPE (see the stacktrace).\r\n\r\nIt seems to be something similar to https://github.com/quarkusio/quarkus/issues/8069\r\n\r\n\r\n### How to Reproduce?\r\n\r\n_No response_\r\n\r\n### Output of `uname -a` or `ver`\r\n\r\nubuntu 22\r\n\r\n### Output of `java -version`\r\n\r\n11.0.16\r\n\r\n### GraalVM version (if different from Java)\r\n\r\n_No response_\r\n\r\n### Quarkus version or git rev\r\n\r\n3.0.0.Alpha4\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\nmaven 3.8.5\r\n\r\n### Additional information\r\n\r\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/31513/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/31513/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
