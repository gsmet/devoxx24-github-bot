{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/35717",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35717/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35717/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35717/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/35717",
  "id": 1880256174,
  "node_id": "I_kwDOCFbutM5wEm6u",
  "number": 35717,
  "title": "[Reload/Hibernate] PropertyAccessException on enum properties after dev reload",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1273026509,
      "node_id": "MDU6TGFiZWwxMjczMDI2NTA5",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/persistence",
      "name": "area/persistence",
      "color": "FBCA04",
      "default": false,
      "description": "OBSOLETE, DO NOT USE"
    },
    {
      "id": 1273039603,
      "node_id": "MDU6TGFiZWwxMjczMDM5NjAz",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/devmode",
      "name": "area/devmode",
      "color": "0366d6",
      "default": false,
      "description": ""
    },
    {
      "id": 1425555736,
      "node_id": "MDU6TGFiZWwxNDI1NTU1NzM2",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/hibernate-orm",
      "name": "area/hibernate-orm",
      "color": "0366d6",
      "default": false,
      "description": "Hibernate ORM"
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": null,
  "comments": 5,
  "created_at": "2023-09-04T13:08:58Z",
  "updated_at": "2023-09-22T12:57:41Z",
  "closed_at": "2023-09-22T12:57:41Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nSince my upgrade to Quarkus 3.X.X and then to Hibernate 6, my application throw an PropertyAccessException on enum files objects only after a live reload triggered by a modification. If i start my application from fresh, it works as supposed.\r\n\r\nI'm using PostgreSQL as DB and i followed Hibernate recommandation to bind my enum.\r\n\r\nHere is my Entity definition : \r\n\r\n```java\r\n@Data\r\n@Builder\r\n@AllArgsConstructor\r\n@NoArgsConstructor\r\n@EqualsAndHashCode(callSuper = true)\r\n@Entity\r\n@Table(name = \"commercial_information\")\r\npublic class CommercialInformation extends EntityWithUUID {\r\n\r\n    @OneToOne\r\n    @JoinColumn(name = \"instance_id\", referencedColumnName = \"id\", foreignKey = @ForeignKey(name = \"fk_commercial_information_instance_id\"))\r\n    @ToString.Exclude\r\n    @EqualsAndHashCode.Exclude\r\n    private Instance instance;\r\n\r\n    @Column(name = \"client_id\")\r\n    private UUID clientId;\r\n\r\n    @Column(name = \"sponsor_id\")\r\n    private UUID sponsorId;\r\n\r\n    @Column(name = \"sales_manager_id\")\r\n    private UUID salesManagerId;\r\n\r\n    @Column(name = \"client_name\")\r\n    private String clientName;\r\n\r\n    @Column(name = \"client_sector\", columnDefinition = \"ORGANIZATION_SECTOR_ENUM\")\r\n    @Type(PostgreSQLEnumType.class)\r\n    @Enumerated(EnumType.STRING)\r\n    private OrganizationSectorEnum clientSector;\r\n\r\n    @Column(name = \"contact_name\")\r\n    private String contactName;\r\n\r\n    @Column(name = \"contact_mobile_number\")\r\n    private String contactMobileNumber;\r\n\r\n    @Column(name = \"contact_email\")\r\n    private String contactEmail;\r\n}\r\n```\r\n\r\n### Expected behavior\r\n\r\nIt's works without problem, as it was freshly started.\r\n\r\n### Actual behavior\r\n\r\nAt the entity instanciation, it throws an exception : \r\n\r\nINTERNAL_SERVER_ERROR : An unexpected internal error happened. Please, see application logs for more details. ; Quarkus error : org.hibernate.PropertyAccessException. ; Cause : Could not set value of type [com.xxx.instances.data.enums.OrganizationSectorEnum] : `com.goalmap.instances.data.domain.CommercialInformation.clientSector` (setter).\r\n\r\n```\r\n`org.hibernate.property.access.spi.SetterFieldImpl.set(SetterFieldImpl.java:86)\r\n org.hibernate.property.access.spi.EnhancedSetterImpl.set(EnhancedSetterImpl.java:40)\r\n org.hibernate.persister.entity.AbstractEntityPersister.setPropertyValues(AbstractEntityPersister.java:4197)\r\n org.hibernate.sql.results.graph.entity.AbstractEntityInitializer.initializeEntityInstance(AbstractEntityInitializer.java:836)\r\n org.hibernate.sql.results.graph.entity.AbstractEntityInitializer.initializeEntity(AbstractEntityInitializer.java:796)\r\n org.hibernate.sql.results.graph.entity.AbstractEntityInitializer.initializeInstance(AbstractEntityInitializer.java:782)\r\n org.hibernate.sql.results.internal.InitializersList.initializeInstance(InitializersList.java:71)\r\n org.hibernate.sql.results.internal.StandardRowReader.coordinateInitializers(StandardRowReader.java:111)\r\n org.hibernate.sql.results.internal.StandardRowReader.readRow(StandardRowReader.java:87)\r\n org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:179)\r\n org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:33)\r\n org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:361)\r\n org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:168)\r\n org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.list(JdbcSelectExecutorStandardImpl.java:93)\r\n org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:31)\r\n org.hibernate.loader.ast.internal.SingleUniqueKeyEntityLoaderStandard.load(SingleUniqueKeyEntityLoaderStandard.java:99)\r\n org.hibernate.persister.entity.AbstractEntityPersister.loadByUniqueKey(AbstractEntityPersister.java:2566)\r\n org.hibernate.persister.entity.AbstractEntityPersister.loadByUniqueKey(AbstractEntityPersister.java:2558)\r\n org.hibernate.sql.results.graph.entity.internal.EntitySelectFetchByUniqueKeyInitializer.initializeInstance(EntitySelectFetchByUniqueKeyInitializer.java:85)\r\n org.hibernate.sql.results.internal.InitializersList.initializeInstance(InitializersList.java:71)\r\n org.hibernate.sql.results.internal.StandardRowReader.coordinateInitializers(StandardRowReader.java:111)\r\n org.hibernate.sql.results.internal.StandardRowReader.readRow(StandardRowReader.java:87)\r\n org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:199)\r\n org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:33)\r\n org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:361)\r\n org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:168)\r\n org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.list(JdbcSelectExecutorStandardImpl.java:93)\r\n org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:31)\r\n org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.lambda$new$0(ConcreteSqmSelectQueryPlan.java:110)\r\n org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.withCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:303)\r\n org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.performList(ConcreteSqmSelectQueryPlan.java:244)\r\n org.hibernate.query.sqm.internal.QuerySqmImpl.doList(QuerySqmImpl.java:518)\r\n org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:367)\r\n org.hibernate.query.Query.getResultList(Query.java:119)\r\n com.xxx.instances.repository.InstanceRepository.findAll(InstanceRepository.java:35)\r\n com.xxx.instances.repository.InstanceRepository_Subclass.findAll$$superforward(Unknown Source)\r\n com.xxx.instances.repository.InstanceRepository_Subclass$$function$$121.apply(Unknown Source)\r\n io.quarkus.arc.impl.AroundInvokeInvocationContext.proceed(AroundInvokeInvocationContext.java:73)\r\n io.quarkus.arc.impl.AroundInvokeInvocationContext.proceed(AroundInvokeInvocationContext.java:62)\r\n io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorBase.invokeInCallerTx(TransactionalInterceptorBase.java:335)\r\n io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorRequired.doIntercept(TransactionalInterceptorRequired.java:40)\r\n io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorBase.intercept(TransactionalInterceptorBase.java:61)\r\n io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorRequired.intercept(TransactionalInterceptorRequired.java:32)\r\n io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorRequired_Bean.intercept(Unknown Source)\r\n io.quarkus.arc.impl.InterceptorInvocation.invoke(InterceptorInvocation.java:42)\r\n io.quarkus.arc.impl.AroundInvokeInvocationContext.perform(AroundInvokeInvocationContext.java:30)\r\n io.quarkus.arc.impl.InvocationContexts.performAroundInvoke(InvocationContexts.java:27)\r\n com.xxx.instances.repository.InstanceRepository_Subclass.findAll(Unknown Source)\r\n com.xxx.instances.repository.InstanceRepository_ClientProxy.findAll(Unknown Source)\r\n com.xxx.instances.service.resource.InstanceService.getInstances(InstanceService.java:258)\r\n com.xxx.instances.service.resource.InstanceService_Subclass.getInstances$$superforward(Unknown Source)\r\n com.xxx.instances.service.resource.InstanceService_Subclass$$function$$17.apply(Unknown Source)\r\n io.quarkus.arc.impl.AroundInvokeInvocationContext.proceed(AroundInvokeInvocationContext.java:73)\r\n io.quarkus.arc.impl.AroundInvokeInvocationContext.proceed(AroundInvokeInvocationContext.java:62)\r\n io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorBase.invokeInOurTx(TransactionalInterceptorBase.java:136)\r\n io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorBase.invokeInOurTx(TransactionalInterceptorBase.java:107)\r\n io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorRequired.doIntercept(TransactionalInterceptorRequired.java:38)\r\n io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorBase.intercept(TransactionalInterceptorBase.java:61)\r\n io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorRequired.intercept(TransactionalInterceptorRequired.java:32)\r\n io.quarkus.narayana.jta.runtime.interceptor.TransactionalInterceptorRequired_Bean.intercept(Unknown Source)\r\n io.quarkus.arc.impl.InterceptorInvocation.invoke(InterceptorInvocation.java:42)\r\n io.quarkus.arc.impl.AroundInvokeInvocationContext.perform(AroundInvokeInvocationContext.java:30)\r\n io.quarkus.arc.impl.InvocationContexts.performAroundInvoke(InvocationContexts.java:27)\r\n com.xxx.instances.service.resource.InstanceService_Subclass.getInstances(Unknown Source)\r\n com.xxx.instances.service.resource.InstanceService_ClientProxy.getInstances(Unknown Source)\r\n com.xxx.instances.resource.InstanceResource.getInstances(InstanceResource.java:78)\r\n com.xxx.instances.resource.InstanceResource_ClientProxy.getInstances(Unknown Source)\r\n java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\r\n java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n java.base/java.lang.reflect.Method.invoke(Method.java:568)\r\n org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:154)\r\n org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:118)\r\n org.jboss.resteasy.core.ResourceMethodInvoker.internalInvokeOnTarget(ResourceMethodInvoker.java:560)\r\n org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTargetAfterFilter(ResourceMethodInvoker.java:452)\r\n org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invokeOnTarget$2(ResourceMethodInvoker.java:413)\r\n org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:321)\r\n org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:415)\r\n org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:378)\r\n org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:356)\r\n org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:70)\r\n org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:429)\r\n org.jboss.resteasy.core.SynchronousDispatcher.lambda$invoke$4(SynchronousDispatcher.java:240)\r\n org.jboss.resteasy.core.SynchronousDispatcher.lambda$preprocess$0(SynchronousDispatcher.java:154)\r\n org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:321)\r\n org.jboss.resteasy.core.SynchronousDispatcher.preprocess(SynchronousDispatcher.java:157)\r\n org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:229)\r\n io.quarkus.resteasy.runtime.standalone.RequestDispatcher.service(RequestDispatcher.java:82)\r\n io.quarkus.resteasy.runtime.standalone.VertxRequestHandler.dispatch(VertxRequestHandler.java:147)\r\n io.quarkus.resteasy.runtime.standalone.VertxRequestHandler$1.run(VertxRequestHandler.java:93)\r\n io.quarkus.vertx.core.runtime.VertxCoreRecorder$14.runWith(VertxCoreRecorder.java:576)\r\n org.jboss.threads.EnhancedQueueExecutor$Task.run(EnhancedQueueExecutor.java:2513)\r\n org.jboss.threads.EnhancedQueueExecutor$ThreadBody.run(EnhancedQueueExecutor.java:1538)\r\n org.jboss.threads.DelegatingRunnable.run(DelegatingRunnable.java:29)\r\n org.jboss.threads.ThreadLocalResettingRunnable.run(ThreadLocalResettingRunnable.java:29)\r\n io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n java.base/java.lang.Thread.run(Thread.java:833)`\r\n```\r\n\r\n### How to Reproduce?\r\n\r\n_No response_\r\n\r\n### Output of `uname -a` or `ver`\r\n\r\n_No response_\r\n\r\n### Output of `java -version`\r\n\r\n17.0.7\r\n\r\n### GraalVM version (if different from Java)\r\n\r\n_No response_\r\n\r\n### Quarkus version or git rev\r\n\r\n3.2.4.Final\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\nMaven 3.9.4\r\n\r\n### Additional information\r\n\r\nI sue ",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/35717/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/35717/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
