{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/33380",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/33380/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/33380/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/33380/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/33380",
  "id": 1709988989,
  "node_id": "I_kwDOCFbutM5l7Fx9",
  "number": 33380,
  "title": "Hibernate Reactive can't be used when agroal extension is present",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1273026509,
      "node_id": "MDU6TGFiZWwxMjczMDI2NTA5",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/persistence",
      "name": "area/persistence",
      "color": "FBCA04",
      "default": false,
      "description": "OBSOLETE, DO NOT USE"
    },
    {
      "id": 2122256208,
      "node_id": "MDU6TGFiZWwyMTIyMjU2MjA4",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/hibernate-reactive",
      "name": "area/hibernate-reactive",
      "color": "0366d6",
      "default": false,
      "description": ""
    },
    {
      "id": 2955097332,
      "node_id": "MDU6TGFiZWwyOTU1MDk3MzMy",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/agroal",
      "name": "area/agroal",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/274",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/274",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/274/labels",
    "id": 9889574,
    "node_id": "MI_kwDOCFbutM4Alucm",
    "number": 274,
    "title": "3.5.0.CR1",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 229,
    "state": "closed",
    "created_at": "2023-09-06T06:54:19Z",
    "updated_at": "2023-11-01T08:32:25Z",
    "due_on": null,
    "closed_at": "2023-10-11T12:10:19Z"
  },
  "comments": 4,
  "created_at": "2023-05-15T12:21:51Z",
  "updated_at": "2023-09-11T10:19:25Z",
  "closed_at": "2023-09-11T10:19:21Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nWhen Agroal extension is added as a depedency along side a reactive sql client, hibernate reactive can't be used.\r\nAs described in other issues, this prevents using reactive datasource along side flyway, liquibase, quartz etc. as they require a blocking datasource.\r\nOnce the agroal extension is present it automatically adds a jdbcdatasource that gets detected by the hibernate orm extension which is preset as a transient dependency for hibernate reactive.\r\nThis seems to actually boil down to the defineTypeOfImpliedPU method in the HiberanateOrmProcessor. \r\nOther issues mentions that this can be fixed when Quarkus migrates to hibernate 6 and hibernate reactive 2.0, but it really seems like a \"naive\" assumption in the hibernate orm quarkus extension, which can be (hopefully) easy to fix by either allowing the user to disable blocking hibernate persistence unit, or by detecting the persistent unit associated datasource flavor (reactive or blocking).\r\n \r\nhttps://github.com/quarkusio/quarkus/issues/10716#issuecomment-658172312\r\n#13425\n\n### Expected behavior\n\nWhen using Hibernate reactive with a reactive datasource configured, adding the agroal extension and configuring a blocking datasource, without associating it to hibernate persistence unit won't affect hibernate blocking/reactive mode.\n\n### Actual behavior\n\nConfiguring Hibernate Reactive with a reactive datasource as the datasource, while also adding another blocking datasource using agroal, causes all sort of exceptions due to the generation of ImpliedBlockingPersistenceUnitTypeBuildItem.\n\n### How to Reproduce?\n\n_No response_\n\n### Output of `uname -a` or `ver`\n\n_No response_\n\n### Output of `java -version`\n\n17\n\n### GraalVM version (if different from Java)\n\n_No response_\n\n### Quarkus version or git rev\n\n3.0.3.Final\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\nGradle 8.0.2\n\n### Additional information\n\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/33380/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/33380/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
