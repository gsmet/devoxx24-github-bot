{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/28715",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/28715/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/28715/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/28715/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/28715",
  "id": 1416444000,
  "node_id": "I_kwDOCFbutM5UbThg",
  "number": 28715,
  "title": "Unexpected behaviour when HTTP Authorization configured using application.properties",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1282139374,
      "node_id": "MDU6TGFiZWwxMjgyMTM5Mzc0",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/security",
      "name": "area/security",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/212",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/212",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/212/labels",
    "id": 8574708,
    "node_id": "MI_kwDOCFbutM4Agtb0",
    "number": 212,
    "title": "2.13.4.Final",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 87,
    "state": "closed",
    "created_at": "2022-10-24T14:12:19Z",
    "updated_at": "2023-01-25T09:02:55Z",
    "due_on": null,
    "closed_at": "2022-11-07T12:39:34Z"
  },
  "comments": 3,
  "created_at": "2022-10-20T11:24:14Z",
  "updated_at": "2022-10-31T15:29:25Z",
  "closed_at": "2022-10-22T10:42:09Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nHi,\r\n\r\nPlease help me to understand if this is expected behaviour or a bug.\r\n\r\nWhen I configure `quarkus.http.auth.permission.*` and `quarkus.http.auth.proactive=false` in a reactive-routes application, Quarkus is not resolving resource methods returning non mutiny types. \r\n\r\ne.g.\r\n\r\nwith below config\r\n\r\n```\r\nquarkus.http.auth.proactive=false\r\n# PermitAll policy for metrics endpoint. Same as @PermitAll annotation\r\nquarkus.http.auth.permission.permit.paths=/q/*\r\nquarkus.http.auth.permission.permit.policy=permit\r\n# Authenticated policy for groups and logout endpoints. Same as @Authenticated or @RolesAllowed(\"**\") annotation\r\nquarkus.http.auth.permission.loggedin.paths=/api/*\r\nquarkus.http.auth.permission.loggedin.policy=authenticated\r\n```\r\nfollowing resources are not resolved and clients will eventually timeout.\r\n```\r\n@Route(path = \"greetings/:name\", methods = Route.HttpMethod.GET)\r\n@RolesAllowed(\"greet\")\r\npublic Greeting greetings(@Param(\"name\") String name) {\r\n    return new Greeting(String.format(\"Hello %s!\", name));\r\n}\r\n\r\n@Route(path = \"greetings/rc/:name\", methods = Route.HttpMethod.GET)\r\n@RolesAllowed(\"greet\")\r\npublic void greetingsRoutingExchange(@Param(\"name\") String name, RoutingExchange rc) {\r\n    rc.ok(Json.encode(new Greeting(String.format(\"Hello %s!\", name))));\r\n}\r\n```\r\n\r\nwhere as below resource works fine.\r\n\r\n```\r\n@Route(path = \"greetings/uni/:name\", methods = Route.HttpMethod.GET)\r\n@RolesAllowed(\"greet\")\r\npublic Uni<Greeting> greetingsUni(@Param(\"name\") String name) {\r\n    return Uni.createFrom().item(new Greeting(String.format(\"Hello %s!\", name)));\r\n}\r\n```\r\n\r\nIssue is only reproduced if proactive auth is disabled, http auth permissions are configured and @RolesAllowed is used for fine grain roles authorization. \r\n\r\nBelow combinations doesn't reproduce the problem and works fine for all types of resources.\r\n\r\n1. proactive auth is true, http auth permissions are configured and @RolesAllowed is used\r\n2. proactive auth is false, http auth permissions are configured but @RolesAllowed is not used\r\n3. http auth permissions are not configured and @RolesAllowed is used.\r\n\r\nIssue is only observed in Quarkus 2.11.0 and above. Works fine in 2.10.x\n\n### Expected behavior\n\nResources with non mutiny types should return a successful response\n\n### Actual behavior\n\nResources with non mutiny types are not resolved and requests timesout\n\n### How to Reproduce?\n\nReproducer: https://github.com/mvmandapati/reactive-routes\r\n\r\nRun `mvn clean verify` to see the test failures.\n\n### Output of `uname -a` or `ver`\n\nWindows 10 / Linux\n\n### Output of `java -version`\n\nOpenJDK Runtime Environment Temurin-17.0.4.1+1 (build 17.0.4.1+1)                   OpenJDK 64-Bit Server VM Temurin-17.0.4.1+1 (build 17.0.4.1+1, mixed mode, sharing)\n\n### GraalVM version (if different from Java)\n\n_No response_\n\n### Quarkus version or git rev\n\n2.11.x or above\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\nMaven 3\n\n### Additional information\n\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/28715/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/28715/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
