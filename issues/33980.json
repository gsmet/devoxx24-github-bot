{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/33980",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/33980/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/33980/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/33980/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/33980",
  "id": 1752567194,
  "node_id": "I_kwDOCFbutM5odg2a",
  "number": 33980,
  "title": "Http error handler logs ioexception as error if it is nested",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 985346627,
      "node_id": "MDU6TGFiZWw5ODUzNDY2Mjc=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/triage/wontfix",
      "name": "triage/wontfix",
      "color": "ffffff",
      "default": false,
      "description": "This will not be worked on"
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": null,
  "comments": 7,
  "created_at": "2023-06-12T11:45:12Z",
  "updated_at": "2023-06-13T09:10:58Z",
  "closed_at": "2023-06-13T09:03:07Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nhttps://github.com/quarkusio/quarkus/blob/197c9219df4ec331ccc5c39a6c6e4b3b1d09b5d4/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/QuarkusErrorHandler.java#L129 checks if the failure is a IOException and only logs at debug as it is most likely a client disconnect. However, some call chains end up with a different exception type at the top, for example if the client disconnects during json serialization.\r\n\r\n### Expected behavior\r\n\r\nQuarkus should not log at ERROR level if a client disconnect happens, even if the low-level IOException ends up wrapped in a different one.\r\n\r\n### Actual behavior\r\n\r\nThe error actually ends up being logged twice: once by QuarkusErrorHandler, once by `org.jboss.resteasy.reactive.common.core.AbstractResteasyReactiveContext`. I cannot find a log call in that class with the specific message. I'd be satisfied with a recursive check in the error handler for an IOException:\r\n``` posh\r\n2023-06-12 12:44:29,009 ERROR io.quarkus.vertx.http.runtime.QuarkusErrorHandler (executor-thread-1407) - HTTP Request to <some endpoint> failed, error id: fb41d136-bd79-49fc-a35b-56e5a17f0d8c-1\r\njavax.json.bind.JsonbException: Unable to serialize property 'onlyday' from <some class>\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.serializeInternal(ObjectSerializer.java:71) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serialize(AbstractContainerSerializer.java:107) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serializerCaptor(AbstractContainerSerializer.java:125) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serializeItem(AbstractContainerSerializer.java:194) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapToObjectSerializer.serializeContainer(MapToObjectSerializer.java:100) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapSerializer.serializeInternal(MapSerializer.java:167) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapSerializer.serializeInternal(MapSerializer.java:32) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serialize(AbstractContainerSerializer.java:107) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serializerCaptor(AbstractContainerSerializer.java:125) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serializeItem(AbstractContainerSerializer.java:194) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapToObjectSerializer.serializeContainer(MapToObjectSerializer.java:100) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapSerializer.serializeInternal(MapSerializer.java:167) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapSerializer.serializeInternal(MapSerializer.java:32) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serialize(AbstractContainerSerializer.java:107) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serializerCaptor(AbstractContainerSerializer.java:125) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serializeItem(AbstractContainerSerializer.java:194) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapToObjectSerializer.serializeContainer(MapToObjectSerializer.java:100) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapSerializer.serializeInternal(MapSerializer.java:167) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapSerializer.serializeInternal(MapSerializer.java:32) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serialize(AbstractContainerSerializer.java:107) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.Marshaller.serializeRoot(Marshaller.java:147) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.Marshaller.marshall(Marshaller.java:73) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.Marshaller.marshall(Marshaller.java:101) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.JsonBinding.toJson(JsonBinding.java:161) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.jboss.resteasy.reactive.server.jsonb.JsonbMessageBodyWriter.writeResponse(JsonbMessageBodyWriter.java:50) ~[io.quarkus.resteasy.reactive.resteasy-reactive-jsonb-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.core.ServerSerialisers.invokeWriter(ServerSerialisers.java:220) ~[io.quarkus.resteasy.reactive.resteasy-reactive-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.core.serialization.DynamicEntityWriter.write(DynamicEntityWriter.java:106) ~[io.quarkus.resteasy.reactive.resteasy-reactive-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.handlers.ResponseWriterHandler.handle(ResponseWriterHandler.java:32) ~[io.quarkus.resteasy.reactive.resteasy-reactive-2.16.4.Final.jar:2.16.4.Final]\r\n\tat io.quarkus.resteasy.reactive.server.runtime.QuarkusResteasyReactiveRequestContext.invokeHandler(QuarkusResteasyReactiveRequestContext.java:120) ~[io.quarkus.quarkus-resteasy-reactive-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.common.core.AbstractResteasyReactiveContext.run(AbstractResteasyReactiveContext.java:145) ~[io.quarkus.resteasy.reactive.resteasy-reactive-common-2.16.4.Final.jar:2.16.4.Final]\r\n\tat io.quarkus.vertx.core.runtime.VertxCoreRecorder$14.runWith(VertxCoreRecorder.java:576) ~[io.quarkus.quarkus-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.threads.EnhancedQueueExecutor$Task.run(EnhancedQueueExecutor.java:2449) ~[org.jboss.threads.jboss-threads-3.4.3.Final.jar:3.4.3.Final]\r\n\tat org.jboss.threads.EnhancedQueueExecutor$ThreadBody.run(EnhancedQueueExecutor.java:1478) ~[org.jboss.threads.jboss-threads-3.4.3.Final.jar:3.4.3.Final]\r\n\tat org.jboss.threads.DelegatingRunnable.run(DelegatingRunnable.java:29) ~[org.jboss.threads.jboss-threads-3.4.3.Final.jar:3.4.3.Final]\r\n\tat org.jboss.threads.ThreadLocalResettingRunnable.run(ThreadLocalResettingRunnable.java:29) ~[org.jboss.threads.jboss-threads-3.4.3.Final.jar:3.4.3.Final]\r\n\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty.netty-common-4.1.86.Final.jar:4.1.86.Final]\r\n\tat java.lang.Thread.run(Thread.java:833) ~[?:?]\r\nCaused by: javax.json.JsonException: I/O error while writing in JsonGenerator\r\n\tat org.glassfish.json.JsonGeneratorImpl.flushBuffer(JsonGeneratorImpl.java:635) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeString(JsonGeneratorImpl.java:588) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeEscapedString(JsonGeneratorImpl.java:547) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeName(JsonGeneratorImpl.java:148) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeKey(JsonGeneratorImpl.java:465) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.marshallProperty(ObjectSerializer.java:105) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.serializeInternal(ObjectSerializer.java:69) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\t... 36 more\r\nCaused by: java.io.IOException: java.io.IOException: Failed to write\r\n\tat org.jboss.resteasy.reactive.server.vertx.ResteasyReactiveOutputStream.write(ResteasyReactiveOutputStream.java:225) ~[io.quarkus.resteasy.reactive.resteasy-reactive-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.NoopCloseAndFlushOutputStream.write(NoopCloseAndFlushOutputStream.java:39) ~[io.quarkus.resteasy.reactive.resteasy-reactive-2.16.4.Final.jar:2.16.4.Final]\r\n\tat sun.nio.cs.StreamEncoder.writeBytes(StreamEncoder.java:234) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.implWrite(StreamEncoder.java:304) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.implWrite(StreamEncoder.java:282) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.write(StreamEncoder.java:132) ~[?:?]\r\n\tat java.io.OutputStreamWriter.write(OutputStreamWriter.java:205) ~[?:?]\r\n\tat org.glassfish.json.JsonGeneratorImpl.flushBuffer(JsonGeneratorImpl.java:631) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeString(JsonGeneratorImpl.java:588) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeEscapedString(JsonGeneratorImpl.java:547) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeName(JsonGeneratorImpl.java:148) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeKey(JsonGeneratorImpl.java:465) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.marshallProperty(ObjectSerializer.java:105) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.serializeInternal(ObjectSerializer.java:69) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\t... 36 more\r\nCaused by: java.io.IOException: Failed to write\r\n\tat org.jboss.resteasy.reactive.server.vertx.ResteasyReactiveOutputStream.write(ResteasyReactiveOutputStream.java:116) ~[io.quarkus.resteasy.reactive.resteasy-reactive-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.vertx.ResteasyReactiveOutputStream.writeBlocking(ResteasyReactiveOutputStream.java:231) ~[io.quarkus.resteasy.reactive.resteasy-reactive-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.vertx.ResteasyReactiveOutputStream.write(ResteasyReactiveOutputStream.java:218) ~[io.quarkus.resteasy.reactive.resteasy-reactive-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.NoopCloseAndFlushOutputStream.write(NoopCloseAndFlushOutputStream.java:39) ~[io.quarkus.resteasy.reactive.resteasy-reactive-2.16.4.Final.jar:2.16.4.Final]\r\n\tat sun.nio.cs.StreamEncoder.writeBytes(StreamEncoder.java:234) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.implWrite(StreamEncoder.java:304) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.implWrite(StreamEncoder.java:282) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.write(StreamEncoder.java:132) ~[?:?]\r\n\tat java.io.OutputStreamWriter.write(OutputStreamWriter.java:205) ~[?:?]\r\n\tat org.glassfish.json.JsonGeneratorImpl.flushBuffer(JsonGeneratorImpl.java:631) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeString(JsonGeneratorImpl.java:588) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeEscapedString(JsonGeneratorImpl.java:547) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeName(JsonGeneratorImpl.java:148) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeKey(JsonGeneratorImpl.java:465) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.marshallProperty(ObjectSerializer.java:105) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.serializeInternal(ObjectSerializer.java:69) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\t... 36 more\r\nCaused by: java.io.IOException: Connection has been closed\r\n\tat org.jboss.resteasy.reactive.server.vertx.ResteasyReactiveOutputStream.awaitWriteable(ResteasyReactiveOutputStream.java:135) ~[io.quarkus.resteasy.reactive.resteasy-reactive-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.vertx.ResteasyReactiveOutputStream.write(ResteasyReactiveOutputStream.java:89) ~[io.quarkus.resteasy.reactive.resteasy-reactive-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.vertx.ResteasyReactiveOutputStream.writeBlocking(ResteasyReactiveOutputStream.java:231) ~[io.quarkus.resteasy.reactive.resteasy-reactive-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.vertx.ResteasyReactiveOutputStream.write(ResteasyReactiveOutputStream.java:218) ~[io.quarkus.resteasy.reactive.resteasy-reactive-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.NoopCloseAndFlushOutputStream.write(NoopCloseAndFlushOutputStream.java:39) ~[io.quarkus.resteasy.reactive.resteasy-reactive-2.16.4.Final.jar:2.16.4.Final]\r\n\tat sun.nio.cs.StreamEncoder.writeBytes(StreamEncoder.java:234) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.implWrite(StreamEncoder.java:304) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.implWrite(StreamEncoder.java:282) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.write(StreamEncoder.java:132) ~[?:?]\r\n\tat java.io.OutputStreamWriter.write(OutputStreamWriter.java:205) ~[?:?]\r\n\tat org.glassfish.json.JsonGeneratorImpl.flushBuffer(JsonGeneratorImpl.java:631) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeString(JsonGeneratorImpl.java:588) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeEscapedString(JsonGeneratorImpl.java:547) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeName(JsonGeneratorImpl.java:148) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeKey(JsonGeneratorImpl.java:465) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.marshallProperty(ObjectSerializer.java:105) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.serializeInternal(ObjectSerializer.java:69) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\t... 36 more\r\n2023-06-12 12:44:29,012 ERROR org.jboss.resteasy.reactive.common.core.AbstractResteasyReactiveContext (executor-thread-1407) - Request failed\r\njavax.json.bind.JsonbException: Unable to serialize property 'onlyday' from<some class>\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.serializeInternal(ObjectSerializer.java:71) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serialize(AbstractContainerSerializer.java:107) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serializerCaptor(AbstractContainerSerializer.java:125) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serializeItem(AbstractContainerSerializer.java:194) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapToObjectSerializer.serializeContainer(MapToObjectSerializer.java:100) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapSerializer.serializeInternal(MapSerializer.java:167) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapSerializer.serializeInternal(MapSerializer.java:32) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serialize(AbstractContainerSerializer.java:107) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serializerCaptor(AbstractContainerSerializer.java:125) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serializeItem(AbstractContainerSerializer.java:194) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapToObjectSerializer.serializeContainer(MapToObjectSerializer.java:100) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapSerializer.serializeInternal(MapSerializer.java:167) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapSerializer.serializeInternal(MapSerializer.java:32) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serialize(AbstractContainerSerializer.java:107) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serializerCaptor(AbstractContainerSerializer.java:125) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serializeItem(AbstractContainerSerializer.java:194) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapToObjectSerializer.serializeContainer(MapToObjectSerializer.java:100) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapSerializer.serializeInternal(MapSerializer.java:167) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.MapSerializer.serializeInternal(MapSerializer.java:32) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.AbstractContainerSerializer.serialize(AbstractContainerSerializer.java:107) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.Marshaller.serializeRoot(Marshaller.java:147) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.Marshaller.marshall(Marshaller.java:73) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.Marshaller.marshall(Marshaller.java:101) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.JsonBinding.toJson(JsonBinding.java:161) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.jboss.resteasy.reactive.server.jsonb.JsonbMessageBodyWriter.writeResponse(JsonbMessageBodyWriter.java:50) ~[io.quarkus.resteasy.reactive.resteasy-reactive-jsonb-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.core.ServerSerialisers.invokeWriter(ServerSerialisers.java:220) ~[io.quarkus.resteasy.reactive.resteasy-reactive-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.core.serialization.DynamicEntityWriter.write(DynamicEntityWriter.java:106) ~[io.quarkus.resteasy.reactive.resteasy-reactive-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.handlers.ResponseWriterHandler.handle(ResponseWriterHandler.java:32) ~[io.quarkus.resteasy.reactive.resteasy-reactive-2.16.4.Final.jar:2.16.4.Final]\r\n\tat io.quarkus.resteasy.reactive.server.runtime.QuarkusResteasyReactiveRequestContext.invokeHandler(QuarkusResteasyReactiveRequestContext.java:120) ~[io.quarkus.quarkus-resteasy-reactive-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.common.core.AbstractResteasyReactiveContext.run(AbstractResteasyReactiveContext.java:145) ~[io.quarkus.resteasy.reactive.resteasy-reactive-common-2.16.4.Final.jar:2.16.4.Final]\r\n\tat io.quarkus.vertx.core.runtime.VertxCoreRecorder$14.runWith(VertxCoreRecorder.java:576) ~[io.quarkus.quarkus-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.threads.EnhancedQueueExecutor$Task.run(EnhancedQueueExecutor.java:2449) ~[org.jboss.threads.jboss-threads-3.4.3.Final.jar:3.4.3.Final]\r\n\tat org.jboss.threads.EnhancedQueueExecutor$ThreadBody.run(EnhancedQueueExecutor.java:1478) ~[org.jboss.threads.jboss-threads-3.4.3.Final.jar:3.4.3.Final]\r\n\tat org.jboss.threads.DelegatingRunnable.run(DelegatingRunnable.java:29) ~[org.jboss.threads.jboss-threads-3.4.3.Final.jar:3.4.3.Final]\r\n\tat org.jboss.threads.ThreadLocalResettingRunnable.run(ThreadLocalResettingRunnable.java:29) ~[org.jboss.threads.jboss-threads-3.4.3.Final.jar:3.4.3.Final]\r\n\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty.netty-common-4.1.86.Final.jar:4.1.86.Final]\r\n\tat java.lang.Thread.run(Thread.java:833) ~[?:?]\r\nCaused by: javax.json.JsonException: I/O error while writing in JsonGenerator\r\n\tat org.glassfish.json.JsonGeneratorImpl.flushBuffer(JsonGeneratorImpl.java:635) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeString(JsonGeneratorImpl.java:588) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeEscapedString(JsonGeneratorImpl.java:547) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeName(JsonGeneratorImpl.java:148) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeKey(JsonGeneratorImpl.java:465) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.marshallProperty(ObjectSerializer.java:105) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.serializeInternal(ObjectSerializer.java:69) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\t... 36 more\r\nCaused by: java.io.IOException: java.io.IOException: Failed to write\r\n\tat org.jboss.resteasy.reactive.server.vertx.ResteasyReactiveOutputStream.write(ResteasyReactiveOutputStream.java:225) ~[io.quarkus.resteasy.reactive.resteasy-reactive-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.NoopCloseAndFlushOutputStream.write(NoopCloseAndFlushOutputStream.java:39) ~[io.quarkus.resteasy.reactive.resteasy-reactive-2.16.4.Final.jar:2.16.4.Final]\r\n\tat sun.nio.cs.StreamEncoder.writeBytes(StreamEncoder.java:234) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.implWrite(StreamEncoder.java:304) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.implWrite(StreamEncoder.java:282) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.write(StreamEncoder.java:132) ~[?:?]\r\n\tat java.io.OutputStreamWriter.write(OutputStreamWriter.java:205) ~[?:?]\r\n\tat org.glassfish.json.JsonGeneratorImpl.flushBuffer(JsonGeneratorImpl.java:631) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeString(JsonGeneratorImpl.java:588) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeEscapedString(JsonGeneratorImpl.java:547) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeName(JsonGeneratorImpl.java:148) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeKey(JsonGeneratorImpl.java:465) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.marshallProperty(ObjectSerializer.java:105) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.serializeInternal(ObjectSerializer.java:69) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\t... 36 more\r\nCaused by: java.io.IOException: Failed to write\r\n\tat org.jboss.resteasy.reactive.server.vertx.ResteasyReactiveOutputStream.write(ResteasyReactiveOutputStream.java:116) ~[io.quarkus.resteasy.reactive.resteasy-reactive-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.vertx.ResteasyReactiveOutputStream.writeBlocking(ResteasyReactiveOutputStream.java:231) ~[io.quarkus.resteasy.reactive.resteasy-reactive-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.vertx.ResteasyReactiveOutputStream.write(ResteasyReactiveOutputStream.java:218) ~[io.quarkus.resteasy.reactive.resteasy-reactive-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.NoopCloseAndFlushOutputStream.write(NoopCloseAndFlushOutputStream.java:39) ~[io.quarkus.resteasy.reactive.resteasy-reactive-2.16.4.Final.jar:2.16.4.Final]\r\n\tat sun.nio.cs.StreamEncoder.writeBytes(StreamEncoder.java:234) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.implWrite(StreamEncoder.java:304) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.implWrite(StreamEncoder.java:282) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.write(StreamEncoder.java:132) ~[?:?]\r\n\tat java.io.OutputStreamWriter.write(OutputStreamWriter.java:205) ~[?:?]\r\n\tat org.glassfish.json.JsonGeneratorImpl.flushBuffer(JsonGeneratorImpl.java:631) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeString(JsonGeneratorImpl.java:588) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeEscapedString(JsonGeneratorImpl.java:547) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeName(JsonGeneratorImpl.java:148) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeKey(JsonGeneratorImpl.java:465) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.marshallProperty(ObjectSerializer.java:105) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.serializeInternal(ObjectSerializer.java:69) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\t... 36 more\r\nCaused by: java.io.IOException: Connection has been closed\r\n\tat org.jboss.resteasy.reactive.server.vertx.ResteasyReactiveOutputStream.awaitWriteable(ResteasyReactiveOutputStream.java:135) ~[io.quarkus.resteasy.reactive.resteasy-reactive-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.vertx.ResteasyReactiveOutputStream.write(ResteasyReactiveOutputStream.java:89) ~[io.quarkus.resteasy.reactive.resteasy-reactive-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.vertx.ResteasyReactiveOutputStream.writeBlocking(ResteasyReactiveOutputStream.java:231) ~[io.quarkus.resteasy.reactive.resteasy-reactive-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.vertx.ResteasyReactiveOutputStream.write(ResteasyReactiveOutputStream.java:218) ~[io.quarkus.resteasy.reactive.resteasy-reactive-vertx-2.16.4.Final.jar:2.16.4.Final]\r\n\tat org.jboss.resteasy.reactive.server.NoopCloseAndFlushOutputStream.write(NoopCloseAndFlushOutputStream.java:39) ~[io.quarkus.resteasy.reactive.resteasy-reactive-2.16.4.Final.jar:2.16.4.Final]\r\n\tat sun.nio.cs.StreamEncoder.writeBytes(StreamEncoder.java:234) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.implWrite(StreamEncoder.java:304) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.implWrite(StreamEncoder.java:282) ~[?:?]\r\n\tat sun.nio.cs.StreamEncoder.write(StreamEncoder.java:132) ~[?:?]\r\n\tat java.io.OutputStreamWriter.write(OutputStreamWriter.java:205) ~[?:?]\r\n\tat org.glassfish.json.JsonGeneratorImpl.flushBuffer(JsonGeneratorImpl.java:631) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeString(JsonGeneratorImpl.java:588) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeEscapedString(JsonGeneratorImpl.java:547) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeName(JsonGeneratorImpl.java:148) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.glassfish.json.JsonGeneratorImpl.writeKey(JsonGeneratorImpl.java:465) ~[org.glassfish.jakarta.json-1.1.6.jar:1.1.6]\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.marshallProperty(ObjectSerializer.java:105) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\tat org.eclipse.yasson.internal.serializer.ObjectSerializer.serializeInternal(ObjectSerializer.java:69) ~[org.eclipse.yasson-1.0.11.jar:?]\r\n\t... 36 more\r\n```\r\n\r\n### How to Reproduce?\r\n\r\nDisconnect a client while writing a large json response.\r\n\r\n### Output of `uname -a` or `ver`\r\n\r\nLinux pod_name 5.10.0-23-amd64 #1 SMP Debian 5.10.179-1 (2023-05-12) x86_64 GNU/Linux\r\n\r\n### Output of `java -version`\r\n\r\nopenjdk version \"17.0.7\" 2023-04-18 LTS OpenJDK Runtime Environment Zulu17.42+19-CA (build 17.0.7+7-LTS) OpenJDK 64-Bit Server VM Zulu17.42+19-CA (build 17.0.7+7-LTS, mixed mode, sharing)\r\n\r\n### GraalVM version (if different from Java)\r\n\r\n-\r\n\r\n### Quarkus version or git rev\r\n\r\n2.16.4.Final\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\ngradle 8.0.2\r\n\r\n### Additional information\r\n\r\nThe class in question has many more checks for specific exception types, there might be more cases where a recursive check for the exception type is useful.",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/33980/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/33980/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
