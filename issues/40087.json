{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/40087",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/40087/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/40087/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/40087/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/40087",
  "id": 2244304336,
  "node_id": "I_kwDOCFbutM6FxV3Q",
  "number": 40087,
  "title": "Adapt new behavior of System.console() since JDK22",
  "labels": [
    {
      "id": 985346622,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjI=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/enhancement",
      "name": "kind/enhancement",
      "color": "a2eeef",
      "default": false,
      "description": "New feature or request"
    },
    {
      "id": 1273027849,
      "node_id": "MDU6TGFiZWwxMjczMDI3ODQ5",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/core",
      "name": "area/core",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/326",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/326",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/326/labels",
    "id": 10976482,
    "node_id": "MI_kwDOCFbutM4Ap3zi",
    "number": 326,
    "title": "3.9.5",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 8,
    "state": "closed",
    "created_at": "2024-04-26T07:55:50Z",
    "updated_at": "2024-05-22T13:15:40Z",
    "due_on": null,
    "closed_at": "2024-04-26T18:15:22Z"
  },
  "comments": 6,
  "created_at": "2024-04-15T18:04:56Z",
  "updated_at": "2024-04-26T08:02:59Z",
  "closed_at": "2024-04-22T08:31:40Z",
  "active_lock_reason": null,
  "body": "### Description\r\n\r\nSince [JDK22](https://inside.java/2023/07/31/quality-heads-up/):\r\n\r\n> In JDK 22, System.console() has been changed to return a Console with enhanced editing features that improve the experience of programs that use the Console API. In addition, System.console() now returns a Console object when the standard streams are redirected or connected to a virtual terminal. Prior to JDK 22, System.console() instead returned null for these cases. This change may impact code that checks the return from System.console() to test if the JVM is connected to a terminal. If required, the -Djdk.console=java.base flag will restore the old behavior where the console is only returned when it is connected to a terminal. Starting JDK 22, one could also use the new Console.isTerminal() method to test if the console is connected to a terminal.\r\n\r\nI looked into Quarkus codebase and I found the following snippets that might need to be changed:\r\n\r\nhttps://github.com/quarkusio/quarkus/blob/3b97e89d0f8b024050a3071798e42579e0577716/core/devmode-spi/src/main/java/io/quarkus/dev/console/QuarkusConsole.java#L121-L123\r\n\r\nhttps://github.com/quarkusio/quarkus/blob/3b97e89d0f8b024050a3071798e42579e0577716/core/devmode-spi/src/main/java/io/quarkus/dev/console/BasicConsole.java#L32-L37\r\n\r\nhttps://github.com/quarkusio/quarkus/blob/3b97e89d0f8b024050a3071798e42579e0577716/independent-projects/tools/devtools-common/src/main/java/io/quarkus/devtools/utils/Prompt.java#L27-L33\r\n\r\n### Implementation ideas\r\n\r\nChange `System.console() != null` to `System.console() != null && System.console().isTerminal()`.\r\n\r\nSince [`isTerminal()`](https://docs.oracle.com/en%2Fjava%2Fjavase%2F22%2Fdocs%2Fapi%2F%2F/java.base/java/io/Console.html#isTerminal()) is a new method introduced in JDK22, we can either:\r\n\r\n- Call it via reflection.\r\n- Use \"multi-release jar\" feature ([JEP238](https://openjdk.org/jeps/238)).",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/40087/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/40087/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
