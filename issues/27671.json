{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/27671",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/27671/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/27671/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/27671/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/27671",
  "id": 1359206419,
  "node_id": "I_kwDOCFbutM5RA9gT",
  "number": 27671,
  "title": "Classes with @Funq methods fail in constructor injection for normal scoped bean",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1282102389,
      "node_id": "MDU6TGFiZWwxMjgyMTAyMzg5",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/arc",
      "name": "area/arc",
      "color": "0366d6",
      "default": false,
      "description": "Issue related to ARC (dependency injection)"
    },
    {
      "id": 1654772125,
      "node_id": "MDU6TGFiZWwxNjU0NzcyMTI1",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/kubernetes",
      "name": "area/kubernetes",
      "color": "0366d6",
      "default": false,
      "description": ""
    },
    {
      "id": 1958884827,
      "node_id": "MDU6TGFiZWwxOTU4ODg0ODI3",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/funqy",
      "name": "area/funqy",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/204",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/204",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/204/labels",
    "id": 8384152,
    "node_id": "MI_kwDOCFbutM4Af-6Y",
    "number": 204,
    "title": "2.12.1.Final",
    "description": "",
    "creator": {
      "login": "gsmet",
      "id": 1279749,
      "node_id": "MDQ6VXNlcjEyNzk3NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1279749?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gsmet",
      "html_url": "https://github.com/gsmet",
      "followers_url": "https://api.github.com/users/gsmet/followers",
      "following_url": "https://api.github.com/users/gsmet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsmet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gsmet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsmet/subscriptions",
      "organizations_url": "https://api.github.com/users/gsmet/orgs",
      "repos_url": "https://api.github.com/users/gsmet/repos",
      "events_url": "https://api.github.com/users/gsmet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gsmet/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 77,
    "state": "closed",
    "created_at": "2022-09-05T19:04:15Z",
    "updated_at": "2022-09-13T05:31:24Z",
    "due_on": null,
    "closed_at": "2022-09-07T11:32:02Z"
  },
  "comments": 2,
  "created_at": "2022-09-01T17:52:40Z",
  "updated_at": "2022-09-05T19:07:50Z",
  "closed_at": "2022-09-02T05:39:06Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nWhen class that is normal scoped bean has method annotated with `@Funq` and uses constructor injection, an exception is thrown. I looked into this and the reason is that when (and only when!) class does extend SomeClass and there is no default constructor without args, Funqy generates it for us here https://github.com/quarkusio/quarkus/blob/b9d7536effc07f08f119eea292673da6e0826057/extensions/funqy/funqy-server-common/deployment/src/main/java/io/quarkus/funqy/deployment/FunctionScannerBuildStep.java#L176\r\n\r\nbut Quarkus Arc does too for normal scoped beans unless a bean class extends a class that does not declare a no-args constructor.\r\n\r\n### Expected behavior\r\n\r\nConstructor injection for normal scoped beans works just fine.\r\n\r\n### Actual behavior\r\n\r\nAn exception is thrown: `Exception in thread \"main\" java.lang.reflect.InvocationTargetException`\r\n`Caused by: java.lang.ClassFormatError: Duplicate method name \"<init>\" with signature \"()V\" in class file io/quarkus/funqy/deployment/DependencyInjectionTest$HiFunction`\r\n\r\n### How to Reproduce?\r\n\r\n1. `git clone https://github.com/michalvavrik/funqy-knative-events-constructor-injection-reproducer.git`\r\n2. `mvn clean verify`\r\n\r\n\r\n### Output of `uname -a` or `ver`\r\n\r\nLinux fedora 5.19.4-200.fc36.x86_64 #1 SMP PREEMPT_DYNAMIC Thu Aug 25 17:42:04 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n### Output of `java -version`\r\n\r\nopenjdk version \"17.0.3\" 2022-04-19\r\n\r\n### GraalVM version (if different from Java)\r\n\r\nGraalVM CE 22.1.0\r\n\r\n### Quarkus version or git rev\r\n\r\n999-SNAPSHOT\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\nApache Maven 3.8.6\r\n\r\n### Additional information\r\n\r\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/27671/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/27671/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
