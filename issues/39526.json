{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/39526",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/39526/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/39526/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/39526/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/39526",
  "id": 2192388187,
  "node_id": "I_kwDOCFbutM6CrTBb",
  "number": 39526,
  "title": "[JDK 23+14] Running quarkus with latest early access build fails setting the context class loader",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1282129298,
      "node_id": "MDU6TGFiZWwxMjgyMTI5Mjk4",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/triage/out-of-date",
      "name": "triage/out-of-date",
      "color": "FFFFFF",
      "default": false,
      "description": "This issue/PR is no longer valid or relevant"
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": null,
  "comments": 7,
  "created_at": "2024-03-18T14:32:17Z",
  "updated_at": "2024-05-17T12:03:36Z",
  "closed_at": "2024-05-17T12:03:30Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nRunning a quarkus-quickstart, e.g. `rest-client-quickstart` with JDK 23+14 fails with:\r\n\r\n```\r\n2024-03-18 15:23:03,455 WARN  [io.qua.res.mut.dep.ResteasyMutinyProcessor] (build-6) The quarkus-resteasy-mutiny extension is deprecated. Switch to RESTEasy Reactive instead.\r\nThis extension adds support for Uni and Multi to RESTEasy Classic, without using the reactive execution model, as RESTEasy Classic does not use it. To properly integrate Mutiny and RESTEasy, use RESTEasy Reactive. See https://quarkus.io/guides/getting-started-reactive for detailed instructions\r\nException in thread \"ForkJoinPool.commonPool-worker-6\" Exception in thread \"ForkJoinPool.commonPool-worker-5\" Exception in thread \"ForkJoinPool.commonPool-worker-1\" Exception in thread \"ForkJoinPool.commonPool-worker-8\" Exception in thread \"ForkJoinPool.commonPool-worker-7\"                   Exception in thread \"ForkJoinPool.commonPool-worker-4\" Exception in thread \"ForkJoinPool.commonPool-worker-2\" Exception in thread \"ForkJoinPool.commonPool-worker-3\" Exception in thread \"ForkJoinPool.commonPool-worker-10\"                   java.lang.SecurityException: setContextClassLoader\r\n\r\nException in thread \"ForkJoinPool.commonPool-worker-11\" Exception in thread \"ForkJoinPool.commonPool-worker-9\" \tat java.base/java.util.concurrent.ForkJoinWorkerThread$InnocuousForkJoinWorkerThread.setContextClassLoader(ForkJoinWorkerThread.java:232)\r\n\tat io.quarkus.runner.bootstrap.ForkJoinClassLoading$1.run(ForkJoinClassLoading.java:29)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1726)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1717)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$InterruptibleTask.exec(ForkJoinTask.java:1641)\r\n\tat java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:507)\r\n\tat java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1494)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:2076)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:2038)\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:189)\r\njava.lang.SecurityException: setContextClassLoader\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread$InnocuousForkJoinWorkerThread.setContextClassLoader(ForkJoinWorkerThread.java:232)\r\n\tat io.quarkus.runner.bootstrap.ForkJoinClassLoading$1.run(ForkJoinClassLoading.java:29)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1726)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1717)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$InterruptibleTask.exec(ForkJoinTask.java:1641)\r\n\tat java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:507)\r\n\tat java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1494)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:2076)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:2038)\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:189)\r\njava.lang.SecurityException: setContextClassLoader\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread$InnocuousForkJoinWorkerThread.setContextClassLoader(ForkJoinWorkerThread.java:232)\r\n\tat io.quarkus.runner.bootstrap.ForkJoinClassLoading$1.run(ForkJoinClassLoading.java:29)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1726)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1717)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$InterruptibleTask.exec(ForkJoinTask.java:1641)\r\n\tat java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:507)\r\n\tat java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1494)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:2076)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:2038)\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:189)\r\njava.lang.SecurityException: setContextClassLoader\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread$InnocuousForkJoinWorkerThread.setContextClassLoader(ForkJoinWorkerThread.java:232)\r\n\tat io.quarkus.runner.bootstrap.ForkJoinClassLoading$1.run(ForkJoinClassLoading.java:29)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1726)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1717)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$InterruptibleTask.exec(ForkJoinTask.java:1641)\r\n\tat java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:507)\r\n\tat java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1494)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:2076)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:2038)\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:189)\r\njava.lang.SecurityException: setContextClassLoader\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread$InnocuousForkJoinWorkerThread.setContextClassLoader(ForkJoinWorkerThread.java:232)\r\n\tat io.quarkus.runner.bootstrap.ForkJoinClassLoading$1.run(ForkJoinClassLoading.java:29)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1726)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1717)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$InterruptibleTask.exec(ForkJoinTask.java:1641)\r\n\tat java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:507)\r\n\tat java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1494)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:2076)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:2038)\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:189)\r\njava.lang.SecurityException: setContextClassLoader\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread$InnocuousForkJoinWorkerThread.setContextClassLoader(ForkJoinWorkerThread.java:232)\r\n\tat io.quarkus.runner.bootstrap.ForkJoinClassLoading$1.run(ForkJoinClassLoading.java:29)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1726)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1717)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$InterruptibleTask.exec(ForkJoinTask.java:1641)\r\n\tat java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:507)\r\n\tat java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1494)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:2076)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:2038)\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:189)\r\njava.lang.SecurityException: setContextClassLoader\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread$InnocuousForkJoinWorkerThread.setContextClassLoader(ForkJoinWorkerThread.java:232)\r\n\tat io.quarkus.runner.bootstrap.ForkJoinClassLoading$1.run(ForkJoinClassLoading.java:29)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1726)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1717)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$InterruptibleTask.exec(ForkJoinTask.java:1641)\r\n\tat java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:507)\r\n\tat java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1494)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:2076)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:2038)\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:189)\r\njava.lang.SecurityException: setContextClassLoader\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread$InnocuousForkJoinWorkerThread.setContextClassLoader(ForkJoinWorkerThread.java:232)\r\n\tat io.quarkus.runner.bootstrap.ForkJoinClassLoading$1.run(ForkJoinClassLoading.java:29)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1726)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1717)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$InterruptibleTask.exec(ForkJoinTask.java:1641)\r\n\tat java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:507)\r\n\tat java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1494)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:2076)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:2038)\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:189)\r\njava.lang.SecurityException: setContextClassLoader\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread$InnocuousForkJoinWorkerThread.setContextClassLoader(ForkJoinWorkerThread.java:232)\r\n\tat io.quarkus.runner.bootstrap.ForkJoinClassLoading$1.run(ForkJoinClassLoading.java:29)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1726)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1717)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$InterruptibleTask.exec(ForkJoinTask.java:1641)\r\n\tat java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:507)\r\n\tat java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1494)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:2076)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:2038)\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:189)\r\njava.lang.SecurityException: setContextClassLoader\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread$InnocuousForkJoinWorkerThread.setContextClassLoader(ForkJoinWorkerThread.java:232)\r\n\tat io.quarkus.runner.bootstrap.ForkJoinClassLoading$1.run(ForkJoinClassLoading.java:29)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1726)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1717)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$InterruptibleTask.exec(ForkJoinTask.java:1641)\r\n\tat java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:507)\r\n\tat java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1494)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:2076)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:2038)\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:189)\r\njava.lang.SecurityException: setContextClassLoader\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread$InnocuousForkJoinWorkerThread.setContextClassLoader(ForkJoinWorkerThread.java:232)\r\n\tat io.quarkus.runner.bootstrap.ForkJoinClassLoading$1.run(ForkJoinClassLoading.java:29)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1726)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1717)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$InterruptibleTask.exec(ForkJoinTask.java:1641)\r\n\tat java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:507)\r\n\tat java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1494)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:2076)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:2038)\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:189)\r\n__  ____  __  _____   ___  __ ____  ______ \r\n --/ __ \\/ / / / _ | / _ \\/ //_/ / / / __/ \r\n -/ /_/ / /_/ / __ |/ , _/ ,< / /_/ /\\ \\   \r\n--\\___\\_\\____/_/ |_/_/|_/_/|_|\\____/___/   \r\n2024-03-18 15:23:05,196 ERROR [io.qua.run.boo.ForkJoinClassLoading] (main) Timed out trying to set fork join ClassLoader, this should never happen unless something has tied up a fork join thread before the app launched\r\n\r\n2024-03-18 15:23:05,745 INFO  [io.quarkus] (Quarkus Main Thread) rest-client-quickstart 1.0.0-SNAPSHOT on JVM (powered by Quarkus 3.8.2) started in 2.822s. Listening on: http://localhost:8080\r\n2024-03-18 15:23:05,747 INFO  [io.quarkus] (Quarkus Main Thread) Profile dev activated. Live Coding activated.\r\n2024-03-18 15:23:05,747 INFO  [io.quarkus] (Quarkus Main Thread) Installed features: [cdi, resteasy, resteasy-client, resteasy-client-jackson, resteasy-jackson, resteasy-mutiny, smallrye-context-propagation, vertx]\r\n```\r\n\r\n### Expected behavior\r\n\r\nNo exceptions.\r\n\r\n### Actual behavior\r\n\r\nException thrown:\r\n\r\n```\r\njava.util.concurrent.ForkJoinWorkerThread$InnocuousForkJoinWorkerThread.setContextClassLoader(ForkJoinWorkerThread.java:232)\r\n\tat io.quarkus.runner.bootstrap.ForkJoinClassLoading$1.run(ForkJoinClassLoading.java:29)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1726)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.compute(ForkJoinTask.java:1717)\r\n\tat java.base/java.util.concurrent.ForkJoinTask$InterruptibleTask.exec(ForkJoinTask.java:1641)\r\n\tat java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:507)\r\n\tat java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1494)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:2076)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:2038)\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:189)\r\n```\r\n\r\n### How to Reproduce?\r\n\r\nReproducer:\r\n\r\nGet and extract a JDK 23+14 build. E.g. for `Linux` on `x86_64` using:\r\n```\r\n$ wget -O jdk.tar.gz https://api.adoptium.net/v3/binary/version/jdk-23+14-ea-beta/linux/x64/jdk/hotspot/normal/adoptium\r\n$ tar -xf jdk.tar.gz\r\n$ ./jdk-23+14/bin/java --version\r\nopenjdk 23-beta 2024-09-17\r\nOpenJDK Runtime Environment Temurin-23+14-202403142003 (build 23-beta+14-ea)\r\nOpenJDK 64-Bit Server VM Temurin-23+14-202403142003 (build 23-beta+14-ea, mixed mode, sharing)\r\n```\r\n\r\n```\r\n$ git clone https://github.com/quarkusio/quarkus-quickstarts.git\r\n$ cd quarkus-quickstarts/rest-client-quickstart\r\n$ JAVA_HOME=/path/to/jdk-23+14 ./mvnw quarkus:dev\r\n```\r\n\r\n### Additional information\r\n\r\nThis is caused by https://bugs.openjdk.org/browse/JDK-8327501 which is new in JDK 23+14.",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/39526/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/39526/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
