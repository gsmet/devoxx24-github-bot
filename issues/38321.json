{
  "url": "https://api.github.com/repos/quarkusio/quarkus/issues/38321",
  "repository_url": "https://api.github.com/repos/quarkusio/quarkus",
  "labels_url": "https://api.github.com/repos/quarkusio/quarkus/issues/38321/labels{/name}",
  "comments_url": "https://api.github.com/repos/quarkusio/quarkus/issues/38321/comments",
  "events_url": "https://api.github.com/repos/quarkusio/quarkus/issues/38321/events",
  "html_url": "https://github.com/quarkusio/quarkus/issues/38321",
  "id": 2093371902,
  "node_id": "I_kwDOCFbutM58xlH-",
  "number": 38321,
  "title": "Configuration ignored when using config maps and the prefix conflicts with a \"static\" config group",
  "labels": [
    {
      "id": 985346620,
      "node_id": "MDU6TGFiZWw5ODUzNDY2MjA=",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug",
      "name": "kind/bug",
      "color": "d73a4a",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1273030910,
      "node_id": "MDU6TGFiZWwxMjczMDMwOTEw",
      "url": "https://api.github.com/repos/quarkusio/quarkus/labels/area/config",
      "name": "area/config",
      "color": "0366d6",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "milestone": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/milestones/299",
    "html_url": "https://github.com/quarkusio/quarkus/milestone/299",
    "labels_url": "https://api.github.com/repos/quarkusio/quarkus/milestones/299/labels",
    "id": 10429739,
    "node_id": "MI_kwDOCFbutM4AnyUr",
    "number": 299,
    "title": "3.9.0.CR1",
    "description": "",
    "creator": {
      "login": "quarkusbot",
      "id": 61254497,
      "node_id": "MDQ6VXNlcjYxMjU0NDk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/61254497?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/quarkusbot",
      "html_url": "https://github.com/quarkusbot",
      "followers_url": "https://api.github.com/users/quarkusbot/followers",
      "following_url": "https://api.github.com/users/quarkusbot/following{/other_user}",
      "gists_url": "https://api.github.com/users/quarkusbot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/quarkusbot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/quarkusbot/subscriptions",
      "organizations_url": "https://api.github.com/users/quarkusbot/orgs",
      "repos_url": "https://api.github.com/users/quarkusbot/repos",
      "events_url": "https://api.github.com/users/quarkusbot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/quarkusbot/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 298,
    "state": "closed",
    "created_at": "2024-01-17T09:57:21Z",
    "updated_at": "2024-07-18T12:19:14Z",
    "due_on": null,
    "closed_at": "2024-03-13T12:25:09Z"
  },
  "comments": 2,
  "created_at": "2024-01-22T08:39:35Z",
  "updated_at": "2024-02-14T17:31:44Z",
  "closed_at": "2024-02-14T17:31:42Z",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nSee https://stackoverflow.com/questions/77842431/quarkus-unable-to-name-a-datasource-query\r\n\r\nEssentially:\r\n\r\n* `quarkus.hibernate-orm.query.*` properties exist in the Hibernate ORM extension; there is a config group called `query`.\r\n* `quarkus.hibernate-orm` is also a configuration map, so `quarkus.hibernate.orm.\"persistence-uni-name\".*` exists to, and `quarkus.hibernate-orm.query.*` could be interpreted as \"configuration for the persistence unit named `query`\".\r\n* There is, however, little to no overlap between those two possible meanings: the `*` in the patterns above will rarely, if ever, be the same.\r\n* Nevertheless, our config seems to always assume that a property starting with `quarkus.hibernate-orm.query.*` has the first meaning, regardless of what's in `*`, leading to that configuration property being ignored, because it doesn't matched any config mapping.\r\n\r\n### Expected behavior\r\n\r\nI'd expect `quarkus.hibernate-orm.query.datasource` to be interpreted as \"the datasource for the persistence unit named `query`\" rather than \"the `datasource` config property for the `query` config group, since only the former actually makes sense and has a matching config mapping.\r\n\r\n### Actual behavior\r\n\r\n`quarkus.hibernate-orm.query.datasource` is interpreted as \"the `datasource` config property for the `query` config group, which doesn't make sense.\r\n\r\n### How to Reproduce?\r\n\r\nCopied from https://stackoverflow.com/questions/77842431/quarkus-unable-to-name-a-datasource-query\r\n\r\nChecking out the quickstart from here https://github.com/quarkusio/quarkus-quickstarts.git\r\n\r\nOn hibernate-orm-panache-quickstart: Edit the application.properties with this content:\r\n\r\n```\r\nquarkus.datasource.query.db-kind=postgresql\r\n\r\nquarkus.hibernate-orm.query.datasource=query\r\nquarkus.hibernate-orm.query.packages=org.acme.hibernate.orm.panache.entity,org.acme.hibernate.orm.panache.repository\r\nquarkus.hibernate-orm.query.database.generation=drop-and-create\r\nquarkus.hibernate-orm.query.log.sql=true\r\nquarkus.hibernate-orm.query.sql-load-script=import.sql\r\n```\r\n\r\nRun the test: FAILED\r\n\r\n```\r\njava.lang.RuntimeException: java.lang.RuntimeException: io.quarkus.builder.BuildException: Build failure: Build failed due to errors\r\n    [error]: Build step io.quarkus.hibernate.orm.deployment.HibernateOrmProcessor#configurationDescriptorBuilding threw an exception: io.quarkus.runtime.configuration.ConfigurationException: Model classes are defined for the default persistence unit, but no default datasource was found. The default EntityManagerFactory will not be created. To solve this, configure the default datasource. Refer to https://quarkus.io/guides/datasource for guidance.\r\n```\r\n\r\nEdit the application.properties with this content:\r\n\r\n```\r\nquarkus.datasource.query-service.db-kind=postgresql\r\n\r\nquarkus.hibernate-orm.query-service.datasource=query-service\r\nquarkus.hibernate-orm.query-service.packages=org.acme.hibernate.orm.panache.entity,org.acme.hibernate.orm.panache.repository\r\nquarkus.hibernate-orm.query-service.database.generation=drop-and-create\r\nquarkus.hibernate-orm.query-service.log.sql=true\r\nquarkus.hibernate-orm.query-service.sql-load-script=import.sql\r\n```\r\n\r\nRun the test: PASS\r\n\r\n### Output of `uname -a` or `ver`\r\n\r\n_No response_\r\n\r\n### Output of `java -version`\r\n\r\n_No response_\r\n\r\n### Quarkus version or git rev\r\n\r\n3.6.6\r\n\r\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\r\n\r\n_No response_\r\n\r\n### Additional information\r\n\r\n_No response_",
  "reactions": {
    "url": "https://api.github.com/repos/quarkusio/quarkus/issues/38321/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/quarkusio/quarkus/issues/38321/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
